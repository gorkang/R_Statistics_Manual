<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>10 Estadistica inferencial | R - Statistics Manual</title>
  <meta name="description" content="Statistics manual from CSCN." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="10 Estadistica inferencial | R - Statistics Manual" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Statistics manual from CSCN." />
  <meta name="github-repo" content="gorkang/R_Statistics_Manual" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="10 Estadistica inferencial | R - Statistics Manual" />
  
  <meta name="twitter:description" content="Statistics manual from CSCN." />
  

<meta name="author" content="Center for Social and Cognitive Neuroscience - cscn.uai.cl" />


<meta name="date" content="2021-03-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Estadistica-descriptiva.html"/>
<link rel="next" href="Funciones.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/str_view-0.1.0/str_view.css" rel="stylesheet" />
<script src="libs/str_view-binding-1.4.0/str_view.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.17/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<script src="libs/d3-4.5.0/d3.min.js"></script>
<script src="libs/sankey-1/sankey.js"></script>
<script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#for-users"><i class="fa fa-check"></i><b>1.1</b> For USERS</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#for-developers-and-statisticians"><i class="fa fa-check"></i><b>1.2</b> For Developers and Statisticians</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#contributors"><i class="fa fa-check"></i><b>1.3</b> Contributors</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#todo"><i class="fa fa-check"></i><b>1.4</b> TODO</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#inferential-analysis"><i class="fa fa-check"></i><b>1.4.1</b> Inferential analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Empezando.html"><a href="Empezando.html"><i class="fa fa-check"></i><b>2</b> Empezando en A-B-C</a>
<ul>
<li class="chapter" data-level="2.1" data-path="Empezando.html"><a href="Empezando.html#a-instalar-r."><i class="fa fa-check"></i><b>2.1</b> <strong>(A)</strong> Instalar R.</a></li>
<li class="chapter" data-level="2.2" data-path="Empezando.html"><a href="Empezando.html#b-instalar-rstudio."><i class="fa fa-check"></i><b>2.2</b> <strong>(B)</strong> Instalar RStudio.</a></li>
<li class="chapter" data-level="2.3" data-path="Empezando.html"><a href="Empezando.html#instalar-packages"><i class="fa fa-check"></i><b>2.3</b> Instalar Packages</a></li>
<li class="chapter" data-level="2.4" data-path="Empezando.html"><a href="Empezando.html#cargar-packages"><i class="fa fa-check"></i><b>2.4</b> Cargar Packages</a></li>
<li class="chapter" data-level="2.5" data-path="Empezando.html"><a href="Empezando.html#todo-en-uno"><i class="fa fa-check"></i><b>2.5</b> Todo en uno</a></li>
<li class="chapter" data-level="2.6" data-path="Empezando.html"><a href="Empezando.html#c-librerias-para-el-workshop"><i class="fa fa-check"></i><b>2.6</b> <strong>(C)</strong> Librerias para el workshop</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="Mi-primer-script.html"><a href="Mi-primer-script.html"><i class="fa fa-check"></i><b>3</b> Mi primer script</a>
<ul>
<li class="chapter" data-level="3.1" data-path="Mi-primer-script.html"><a href="Mi-primer-script.html#paso-a-paso"><i class="fa fa-check"></i><b>3.1</b> Paso a paso</a></li>
<li class="chapter" data-level="3.2" data-path="Mi-primer-script.html"><a href="Mi-primer-script.html#establecer-nuestro-directorio-de-trabajo"><i class="fa fa-check"></i><b>3.2</b> Establecer nuestro directorio de trabajo</a></li>
<li class="chapter" data-level="3.3" data-path="Mi-primer-script.html"><a href="Mi-primer-script.html#nuestro-primer-script"><i class="fa fa-check"></i><b>3.3</b> Nuestro primer script</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="Conseguir-ayuda.html"><a href="Conseguir-ayuda.html"><i class="fa fa-check"></i><b>4</b> Conseguir ayuda y aprender más</a>
<ul>
<li class="chapter" data-level="4.1" data-path="Conseguir-ayuda.html"><a href="Conseguir-ayuda.html#cuando-sabemos-que-función-usar-pero-dudamos-de-la-sintaxis"><i class="fa fa-check"></i><b>4.1</b> Cuando sabemos que función usar, pero dudamos de la sintaxis:</a></li>
<li class="chapter" data-level="4.2" data-path="Conseguir-ayuda.html"><a href="Conseguir-ayuda.html#cuando-sabemos-lo-que-queremos-hacer-pero-no-la-función-que-debemos-usar"><i class="fa fa-check"></i><b>4.2</b> Cuando sabemos lo que queremos hacer pero no la función que debemos usar:</a></li>
<li class="chapter" data-level="4.3" data-path="Conseguir-ayuda.html"><a href="Conseguir-ayuda.html#libros-y-web-recomendados"><i class="fa fa-check"></i><b>4.3</b> Libros y Web recomendados</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="Conseguir-ayuda.html"><a href="Conseguir-ayuda.html#hadley-wickhams-books"><i class="fa fa-check"></i><b>4.3.1</b> Hadley Wickham’s books</a></li>
<li class="chapter" data-level="4.3.2" data-path="Conseguir-ayuda.html"><a href="Conseguir-ayuda.html#learning-statistics-with-r"><i class="fa fa-check"></i><b>4.3.2</b> Learning statistics with R</a></li>
<li class="chapter" data-level="4.3.3" data-path="Conseguir-ayuda.html"><a href="Conseguir-ayuda.html#pirate-guide-to-r"><i class="fa fa-check"></i><b>4.3.3</b> Pirate guide to R</a></li>
<li class="chapter" data-level="4.3.4" data-path="Conseguir-ayuda.html"><a href="Conseguir-ayuda.html#plots"><i class="fa fa-check"></i><b>4.3.4</b> Plots</a></li>
<li class="chapter" data-level="4.3.5" data-path="Conseguir-ayuda.html"><a href="Conseguir-ayuda.html#other-references"><i class="fa fa-check"></i><b>4.3.5</b> Other references</a></li>
<li class="chapter" data-level="4.3.6" data-path="Conseguir-ayuda.html"><a href="Conseguir-ayuda.html#twitter"><i class="fa fa-check"></i><b>4.3.6</b> Twitter</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="basics-data-types-import-and-export-data.html"><a href="basics-data-types-import-and-export-data.html"><i class="fa fa-check"></i><b>5</b> Basics - Data types, import and export data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="basics-data-types-import-and-export-data.html"><a href="basics-data-types-import-and-export-data.html#data-types"><i class="fa fa-check"></i><b>5.1</b> Data types</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="basics-data-types-import-and-export-data.html"><a href="basics-data-types-import-and-export-data.html#data-frames"><i class="fa fa-check"></i><b>5.1.1</b> Data Frames</a></li>
<li class="chapter" data-level="5.1.2" data-path="basics-data-types-import-and-export-data.html"><a href="basics-data-types-import-and-export-data.html#matrices"><i class="fa fa-check"></i><b>5.1.2</b> Matrices</a></li>
<li class="chapter" data-level="5.1.3" data-path="basics-data-types-import-and-export-data.html"><a href="basics-data-types-import-and-export-data.html#listas"><i class="fa fa-check"></i><b>5.1.3</b> Listas</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="basics-data-types-import-and-export-data.html"><a href="basics-data-types-import-and-export-data.html#import-data"><i class="fa fa-check"></i><b>5.2</b> Import data</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="basics-data-types-import-and-export-data.html"><a href="basics-data-types-import-and-export-data.html#from-csv-file"><i class="fa fa-check"></i><b>5.2.1</b> From CSV file</a></li>
<li class="chapter" data-level="5.2.2" data-path="basics-data-types-import-and-export-data.html"><a href="basics-data-types-import-and-export-data.html#from-xls-file-excel"><i class="fa fa-check"></i><b>5.2.2</b> From XLS’ file (Excel)</a></li>
<li class="chapter" data-level="5.2.3" data-path="basics-data-types-import-and-export-data.html"><a href="basics-data-types-import-and-export-data.html#from-sav-file-spss"><i class="fa fa-check"></i><b>5.2.3</b> From SAV file (SPSS)</a></li>
<li class="chapter" data-level="5.2.4" data-path="basics-data-types-import-and-export-data.html"><a href="basics-data-types-import-and-export-data.html#import-all-files-from-a-folder"><i class="fa fa-check"></i><b>5.2.4</b> Import all files from a folder</a></li>
<li class="chapter" data-level="5.2.5" data-path="basics-data-types-import-and-export-data.html"><a href="basics-data-types-import-and-export-data.html#import-files-using-rstudio"><i class="fa fa-check"></i><b>5.2.5</b> Import files using RStudio</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="basics-data-types-import-and-export-data.html"><a href="basics-data-types-import-and-export-data.html#export-data"><i class="fa fa-check"></i><b>5.3</b> Export data</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="basics-data-types-import-and-export-data.html"><a href="basics-data-types-import-and-export-data.html#export-data-to-csv-file"><i class="fa fa-check"></i><b>5.3.1</b> Export data to CSV file</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="Manipular-datos.html"><a href="Manipular-datos.html"><i class="fa fa-check"></i><b>6</b> Manipular datos</a>
<ul>
<li class="chapter" data-level="6.1" data-path="Manipular-datos.html"><a href="Manipular-datos.html#leer-y-guardar-datos"><i class="fa fa-check"></i><b>6.1</b> Leer y guardar datos</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="Manipular-datos.html"><a href="Manipular-datos.html#leer-datos"><i class="fa fa-check"></i><b>6.1.1</b> Leer datos</a></li>
<li class="chapter" data-level="6.1.2" data-path="Manipular-datos.html"><a href="Manipular-datos.html#guardar-db-a-archivo"><i class="fa fa-check"></i><b>6.1.2</b> Guardar DB a archivo</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="Manipular-datos.html"><a href="Manipular-datos.html#ver-output-vs-asignar-output"><i class="fa fa-check"></i><b>6.2</b> Ver output vs asignar output</a></li>
<li class="chapter" data-level="6.3" data-path="Manipular-datos.html"><a href="Manipular-datos.html#verbos-de-dplyr"><i class="fa fa-check"></i><b>6.3</b> Verbos de dplyr</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="Manipular-datos.html"><a href="Manipular-datos.html#filtrar-datos"><i class="fa fa-check"></i><b>6.3.1</b> Filtrar datos</a></li>
<li class="chapter" data-level="6.3.2" data-path="Manipular-datos.html"><a href="Manipular-datos.html#ordenar-db"><i class="fa fa-check"></i><b>6.3.2</b> Ordenar DB</a></li>
<li class="chapter" data-level="6.3.3" data-path="Manipular-datos.html"><a href="Manipular-datos.html#seleccionar-variables"><i class="fa fa-check"></i><b>6.3.3</b> Seleccionar variables</a></li>
<li class="chapter" data-level="6.3.4" data-path="Manipular-datos.html"><a href="Manipular-datos.html#renombrar-variables"><i class="fa fa-check"></i><b>6.3.4</b> Renombrar variables</a></li>
<li class="chapter" data-level="6.3.5" data-path="Manipular-datos.html"><a href="Manipular-datos.html#separate-contents-of-a-single-variable"><i class="fa fa-check"></i><b>6.3.5</b> Separate contents of a single variable</a></li>
<li class="chapter" data-level="6.3.6" data-path="Manipular-datos.html"><a href="Manipular-datos.html#wide-to-long-format"><i class="fa fa-check"></i><b>6.3.6</b> Wide to Long format</a></li>
<li class="chapter" data-level="6.3.7" data-path="Manipular-datos.html"><a href="Manipular-datos.html#long-to-wide"><i class="fa fa-check"></i><b>6.3.7</b> Long to wide</a></li>
<li class="chapter" data-level="6.3.8" data-path="Manipular-datos.html"><a href="Manipular-datos.html#omitir-nas"><i class="fa fa-check"></i><b>6.3.8</b> Omitir NAs</a></li>
<li class="chapter" data-level="6.3.9" data-path="Manipular-datos.html"><a href="Manipular-datos.html#eliminar-variables"><i class="fa fa-check"></i><b>6.3.9</b> Eliminar variables</a></li>
<li class="chapter" data-level="6.3.10" data-path="Manipular-datos.html"><a href="Manipular-datos.html#crear-nuevas-variables"><i class="fa fa-check"></i><b>6.3.10</b> Crear nuevas variables:</a></li>
<li class="chapter" data-level="6.3.11" data-path="Manipular-datos.html"><a href="Manipular-datos.html#recodificamos-datos"><i class="fa fa-check"></i><b>6.3.11</b> Recodificamos datos</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="Manipular-datos.html"><a href="Manipular-datos.html#combinar-bases-de-datos"><i class="fa fa-check"></i><b>6.4</b> Combinar bases de datos</a></li>
<li class="chapter" data-level="6.5" data-path="Manipular-datos.html"><a href="Manipular-datos.html#verbos-avanzados"><i class="fa fa-check"></i><b>6.5</b> Verbos avanzados</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="Manipular-datos.html"><a href="Manipular-datos.html#cambiar-multiples-columnas-de-un-tipo-a-otro"><i class="fa fa-check"></i><b>6.5.1</b> Cambiar multiples columnas de un tipo a otro</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="Manipular-datos.html"><a href="Manipular-datos.html#regular-expressions"><i class="fa fa-check"></i><b>6.6</b> Regular expressions</a></li>
<li class="chapter" data-level="6.7" data-path="Manipular-datos.html"><a href="Manipular-datos.html#trabajando-con-fechas"><i class="fa fa-check"></i><b>6.7</b> Trabajando con fechas</a></li>
<li class="chapter" data-level="6.8" data-path="Manipular-datos.html"><a href="Manipular-datos.html#pegando-portapapeles-a-vector-con-datapasta"><i class="fa fa-check"></i><b>6.8</b> Pegando portapapeles a vector con datapasta</a></li>
<li class="chapter" data-level="6.9" data-path="Manipular-datos.html"><a href="Manipular-datos.html#tutoriales-externos"><i class="fa fa-check"></i><b>6.9</b> Tutoriales externos</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html"><i class="fa fa-check"></i><b>7</b> Visualizar datos</a>
<ul>
<li class="chapter" data-level="7.1" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html#other-resources"><i class="fa fa-check"></i><b>7.1</b> Other resources</a></li>
<li class="chapter" data-level="7.2" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html#que-gráfica-puedo-usar-wip"><i class="fa fa-check"></i><b>7.2</b> Que gráfica puedo usar (WIP)</a></li>
<li class="chapter" data-level="7.3" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html#tipos-de-gráficas"><i class="fa fa-check"></i><b>7.3</b> Tipos de gráficas</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html#histogramas"><i class="fa fa-check"></i><b>7.3.1</b> Histogramas</a></li>
<li class="chapter" data-level="7.3.2" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html#Pirate-Plot"><i class="fa fa-check"></i><b>7.3.2</b> Pirate plot</a></li>
<li class="chapter" data-level="7.3.3" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html#barplots-with-individual-responses"><i class="fa fa-check"></i><b>7.3.3</b> Barplots with individual responses</a></li>
<li class="chapter" data-level="7.3.4" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html#diagrama-de-caja-y-bigotes"><i class="fa fa-check"></i><b>7.3.4</b> Diagrama de caja y bigotes</a></li>
<li class="chapter" data-level="7.3.5" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html#correlation-plot"><i class="fa fa-check"></i><b>7.3.5</b> Correlation plot</a></li>
<li class="chapter" data-level="7.3.6" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html#beanplot"><i class="fa fa-check"></i><b>7.3.6</b> Beanplot</a></li>
<li class="chapter" data-level="7.3.7" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html#scatterplot"><i class="fa fa-check"></i><b>7.3.7</b> Scatterplot</a></li>
<li class="chapter" data-level="7.3.8" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html#scatterplot-con-3-variables"><i class="fa fa-check"></i><b>7.3.8</b> Scatterplot con 3 variables</a></li>
<li class="chapter" data-level="7.3.9" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html#density-plots"><i class="fa fa-check"></i><b>7.3.9</b> Density plots</a></li>
<li class="chapter" data-level="7.3.10" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html#density-ridges-plots-ggjoy"><i class="fa fa-check"></i><b>7.3.10</b> Density Ridges Plots (ggjoy)</a></li>
<li class="chapter" data-level="7.3.11" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html#pp-plots"><i class="fa fa-check"></i><b>7.3.11</b> PP plots</a></li>
<li class="chapter" data-level="7.3.12" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html#shaded-geom-area"><i class="fa fa-check"></i><b>7.3.12</b> Shaded geom area</a></li>
<li class="chapter" data-level="7.3.13" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html#multiple-scatterplots"><i class="fa fa-check"></i><b>7.3.13</b> Multiple Scatterplots</a></li>
<li class="chapter" data-level="7.3.14" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html#background-data"><i class="fa fa-check"></i><b>7.3.14</b> Background data</a></li>
<li class="chapter" data-level="7.3.15" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html#flip-plots"><i class="fa fa-check"></i><b>7.3.15</b> Flip plots</a></li>
<li class="chapter" data-level="7.3.16" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html#waffle-plots"><i class="fa fa-check"></i><b>7.3.16</b> Waffle plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="Visualizar-riesgo.html"><a href="Visualizar-riesgo.html"><i class="fa fa-check"></i><b>8</b> Visualizar riesgo</a>
<ul>
<li class="chapter" data-level="8.1" data-path="Visualizar-riesgo.html"><a href="Visualizar-riesgo.html#riskr"><i class="fa fa-check"></i><b>8.1</b> Riskr</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="Estadistica-descriptiva.html"><a href="Estadistica-descriptiva.html"><i class="fa fa-check"></i><b>9</b> Estadistica descriptiva</a>
<ul>
<li class="chapter" data-level="9.1" data-path="Estadistica-descriptiva.html"><a href="Estadistica-descriptiva.html#gtsummaries"><i class="fa fa-check"></i><b>9.1</b> Gtsummaries</a></li>
<li class="chapter" data-level="9.2" data-path="Estadistica-descriptiva.html"><a href="Estadistica-descriptiva.html#summary-de-datos"><i class="fa fa-check"></i><b>9.2</b> Summary de datos</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="Estadistica-descriptiva.html"><a href="Estadistica-descriptiva.html#agrupamos-por-sujeto"><i class="fa fa-check"></i><b>9.2.1</b> Agrupamos por sujeto</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="Estadistica-descriptiva.html"><a href="Estadistica-descriptiva.html#descriptive-tables-latex"><i class="fa fa-check"></i><b>9.3</b> Descriptive tables latex</a></li>
<li class="chapter" data-level="9.4" data-path="Estadistica-descriptiva.html"><a href="Estadistica-descriptiva.html#visualize-missing-values"><i class="fa fa-check"></i><b>9.4</b> Visualize missing values</a></li>
<li class="chapter" data-level="9.5" data-path="Estadistica-descriptiva.html"><a href="Estadistica-descriptiva.html#tutorial-externo"><i class="fa fa-check"></i><b>9.5</b> Tutorial externo</a></li>
<li class="chapter" data-level="9.6" data-path="Estadistica-descriptiva.html"><a href="Estadistica-descriptiva.html#findviews"><i class="fa fa-check"></i><b>9.6</b> Findviews</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="Estadistica-inferencial.html"><a href="Estadistica-inferencial.html"><i class="fa fa-check"></i><b>10</b> Estadistica inferencial</a>
<ul>
<li class="chapter" data-level="10.1" data-path="Estadistica-inferencial.html"><a href="Estadistica-inferencial.html#referencias-y-fuentes"><i class="fa fa-check"></i><b>10.1</b> Referencias y Fuentes</a></li>
<li class="chapter" data-level="10.2" data-path="Estadistica-inferencial.html"><a href="Estadistica-inferencial.html#association-test"><i class="fa fa-check"></i><b>10.2</b> Association test</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="Estadistica-inferencial.html"><a href="Estadistica-inferencial.html#frequentist-1"><i class="fa fa-check"></i><b>10.2.1</b> Frequentist</a></li>
<li class="chapter" data-level="10.2.2" data-path="Estadistica-inferencial.html"><a href="Estadistica-inferencial.html#bayesian-2"><i class="fa fa-check"></i><b>10.2.2</b> Bayesian</a></li>
<li class="chapter" data-level="10.2.3" data-path="Estadistica-inferencial.html"><a href="Estadistica-inferencial.html#results-report---wip"><i class="fa fa-check"></i><b>10.2.3</b> Results report - WIP</a></li>
<li class="chapter" data-level="10.2.4" data-path="Estadistica-inferencial.html"><a href="Estadistica-inferencial.html#references"><i class="fa fa-check"></i><b>10.2.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="Estadistica-inferencial.html"><a href="Estadistica-inferencial.html#anova-repeated-measures"><i class="fa fa-check"></i><b>10.3</b> ANOVA repeated measures</a></li>
<li class="chapter" data-level="10.4" data-path="Estadistica-inferencial.html"><a href="Estadistica-inferencial.html#mixed-models"><i class="fa fa-check"></i><b>10.4</b> Mixed Models</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="Estadistica-inferencial.html"><a href="Estadistica-inferencial.html#reading-list"><i class="fa fa-check"></i><b>10.4.1</b> Reading list</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="Estadistica-inferencial.html"><a href="Estadistica-inferencial.html#meta-analysis"><i class="fa fa-check"></i><b>10.5</b> Meta analysis</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="Estadistica-inferencial.html"><a href="Estadistica-inferencial.html#natural-frequencies-effect"><i class="fa fa-check"></i><b>10.5.1</b> Natural Frequencies Effect</a></li>
<li class="chapter" data-level="10.5.2" data-path="Estadistica-inferencial.html"><a href="Estadistica-inferencial.html#pictures-effect"><i class="fa fa-check"></i><b>10.5.2</b> Pictures Effect</a></li>
<li class="chapter" data-level="10.5.3" data-path="Estadistica-inferencial.html"><a href="Estadistica-inferencial.html#notes-on-meta-analysis"><i class="fa fa-check"></i><b>10.5.3</b> Notes on Meta-analysis</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="Estadistica-inferencial.html"><a href="Estadistica-inferencial.html#roc-curves"><i class="fa fa-check"></i><b>10.6</b> ROC Curves</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="Funciones.html"><a href="Funciones.html"><i class="fa fa-check"></i><b>11</b> Funciones</a>
<ul>
<li class="chapter" data-level="11.1" data-path="Funciones.html"><a href="Funciones.html#creando-mi-primera-función"><i class="fa fa-check"></i><b>11.1</b> Creando mi primera función</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="Funciones.html"><a href="Funciones.html#pirate-plot-original"><i class="fa fa-check"></i><b>11.1.1</b> Pirate plot original</a></li>
<li class="chapter" data-level="11.1.2" data-path="Funciones.html"><a href="Funciones.html#nuestra-función"><i class="fa fa-check"></i><b>11.1.2</b> Nuestra función</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="pre-processing.html"><a href="pre-processing.html"><i class="fa fa-check"></i><b>12</b> Pre-processing</a>
<ul>
<li class="chapter" data-level="12.1" data-path="pre-processing.html"><a href="pre-processing.html#rt-filtering"><i class="fa fa-check"></i><b>12.1</b> RT filtering</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="pre-processing.html"><a href="pre-processing.html#function-to-filter-by-rt"><i class="fa fa-check"></i><b>12.1.1</b> Function to filter by RT</a></li>
<li class="chapter" data-level="12.1.2" data-path="pre-processing.html"><a href="pre-processing.html#n-sd-from-the-median-mad-1"><i class="fa fa-check"></i><b>12.1.2</b> n SD from the median (MAD)</a></li>
<li class="chapter" data-level="12.1.3" data-path="pre-processing.html"><a href="pre-processing.html#gamma-law-regression-analyses-2"><i class="fa fa-check"></i><b>12.1.3</b> Gamma law regression analyses</a></li>
<li class="chapter" data-level="12.1.4" data-path="pre-processing.html"><a href="pre-processing.html#logarithms"><i class="fa fa-check"></i><b>12.1.4</b> Logarithms</a></li>
<li class="chapter" data-level="12.1.5" data-path="pre-processing.html"><a href="pre-processing.html#references-1"><i class="fa fa-check"></i><b>12.1.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="pre-processing.html"><a href="pre-processing.html#reliability"><i class="fa fa-check"></i><b>12.2</b> Reliability</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="pre-processing.html"><a href="pre-processing.html#cronbachs-alpha"><i class="fa fa-check"></i><b>12.2.1</b> Cronbach’s Alpha</a></li>
<li class="chapter" data-level="12.2.2" data-path="pre-processing.html"><a href="pre-processing.html#omega"><i class="fa fa-check"></i><b>12.2.2</b> Omega</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="pre-processing.html"><a href="pre-processing.html#inter-rater-reliability"><i class="fa fa-check"></i><b>12.3</b> Inter rater reliability</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="pre-processing.html"><a href="pre-processing.html#references-2"><i class="fa fa-check"></i><b>12.3.1</b> References</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="pre-processing.html"><a href="pre-processing.html#impute-missing-data"><i class="fa fa-check"></i><b>12.4</b> Impute missing data</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="pre-processing.html"><a href="pre-processing.html#impute-with-mice"><i class="fa fa-check"></i><b>12.4.1</b> Impute with mice</a></li>
<li class="chapter" data-level="12.4.2" data-path="pre-processing.html"><a href="pre-processing.html#impute-with-recipes"><i class="fa fa-check"></i><b>12.4.2</b> Impute with recipes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="experimental-design.html"><a href="experimental-design.html"><i class="fa fa-check"></i><b>13</b> Experimental design</a>
<ul>
<li class="chapter" data-level="13.1" data-path="experimental-design.html"><a href="experimental-design.html#tamaño-de-muestra-y-efecto-detectado"><i class="fa fa-check"></i><b>13.1</b> Tamaño de muestra y efecto detectado</a></li>
<li class="chapter" data-level="13.2" data-path="experimental-design.html"><a href="experimental-design.html#power-analysis"><i class="fa fa-check"></i><b>13.2</b> Power analysis</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="experimental-design.html"><a href="experimental-design.html#longitudinal-designs"><i class="fa fa-check"></i><b>13.2.1</b> Longitudinal designs</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="experimental-design.html"><a href="experimental-design.html#anonimizar-participantes---encriptar-ids"><i class="fa fa-check"></i><b>13.3</b> Anonimizar participantes - Encriptar IDs</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="experimental-design.html"><a href="experimental-design.html#encriptando-y-desencriptando-un-elemento"><i class="fa fa-check"></i><b>13.3.1</b> Encriptando y desencriptando un elemento</a></li>
<li class="chapter" data-level="13.3.2" data-path="experimental-design.html"><a href="experimental-design.html#encriptando-y-desencriptando-la-columna-rut-de-una-db-completa."><i class="fa fa-check"></i><b>13.3.2</b> Encriptando y desencriptando la columna RUT de una DB completa.</a></li>
<li class="chapter" data-level="13.3.3" data-path="experimental-design.html"><a href="experimental-design.html#encriptando-algo-que-no-sean-numeros"><i class="fa fa-check"></i><b>13.3.3</b> Encriptando algo que no sean numeros</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="experimental-design.html"><a href="experimental-design.html#match-participants"><i class="fa fa-check"></i><b>13.4</b> Match participants</a></li>
<li class="chapter" data-level="13.5" data-path="experimental-design.html"><a href="experimental-design.html#determine-distribution"><i class="fa fa-check"></i><b>13.5</b> Determine distribution</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="classification.html"><a href="classification.html"><i class="fa fa-check"></i><b>14</b> Classification</a>
<ul>
<li class="chapter" data-level="14.1" data-path="classification.html"><a href="classification.html#fast-and-frugal-trees"><i class="fa fa-check"></i><b>14.1</b> Fast and frugal trees</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="other-stuff.html"><a href="other-stuff.html"><i class="fa fa-check"></i><b>15</b> Other stuff</a>
<ul>
<li class="chapter" data-level="15.1" data-path="other-stuff.html"><a href="other-stuff.html#maps---generate-and-locate-cities-in-a-world-map"><i class="fa fa-check"></i><b>15.1</b> Maps - Generate and locate cities in a world map</a></li>
<li class="chapter" data-level="15.2" data-path="other-stuff.html"><a href="other-stuff.html#extract-tables-from-the-internet"><i class="fa fa-check"></i><b>15.2</b> Extract tables from the internet</a></li>
<li class="chapter" data-level="15.3" data-path="other-stuff.html"><a href="other-stuff.html#extract-tables-from-the-internet-1"><i class="fa fa-check"></i><b>15.3</b> Extract tables from the internet</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="ejercicios-y-soluciones.html"><a href="ejercicios-y-soluciones.html"><i class="fa fa-check"></i><b>16</b> Ejercicios y soluciones</a>
<ul>
<li class="chapter" data-level="16.1" data-path="ejercicios-y-soluciones.html"><a href="ejercicios-y-soluciones.html#Ejercicios1"><i class="fa fa-check"></i><b>16.1</b> Ejercicios 1</a></li>
<li class="chapter" data-level="16.2" data-path="ejercicios-y-soluciones.html"><a href="ejercicios-y-soluciones.html#Ejercicios2"><i class="fa fa-check"></i><b>16.2</b> Ejercicios 2</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="bibliography-and-interesting-resources.html"><a href="bibliography-and-interesting-resources.html"><i class="fa fa-check"></i><b>17</b> Bibliography and interesting resources</a>
<ul>
<li class="chapter" data-level="17.1" data-path="bibliography-and-interesting-resources.html"><a href="bibliography-and-interesting-resources.html#bibliography"><i class="fa fa-check"></i><b>17.1</b> Bibliography</a></li>
<li class="chapter" data-level="17.2" data-path="bibliography-and-interesting-resources.html"><a href="bibliography-and-interesting-resources.html#interesting-resources---potentially"><i class="fa fa-check"></i><b>17.2</b> Interesting resources - potentially</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="todo-curso-basico-r-2016.html"><a href="todo-curso-basico-r-2016.html"><i class="fa fa-check"></i><b>18</b> TODO - Curso Basico R - 2016</a>
<ul>
<li class="chapter" data-level="18.1" data-path="todo-curso-basico-r-2016.html"><a href="todo-curso-basico-r-2016.html#en-ejercicios"><i class="fa fa-check"></i><b>18.1</b> EN EJERCICIOS:</a></li>
<li class="chapter" data-level="18.2" data-path="todo-curso-basico-r-2016.html"><a href="todo-curso-basico-r-2016.html#todo---limpieza-general"><i class="fa fa-check"></i><b>18.2</b> TODO - Limpieza general</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="todo-1.html"><a href="todo-1.html"><i class="fa fa-check"></i><b>19</b> TODO</a>
<ul>
<li class="chapter" data-level="19.1" data-path="todo-1.html"><a href="todo-1.html#urgent-stuff"><i class="fa fa-check"></i><b>19.1</b> Urgent stuff</a></li>
<li class="chapter" data-level="19.2" data-path="todo-1.html"><a href="todo-1.html#important"><i class="fa fa-check"></i><b>19.2</b> Important</a></li>
<li class="chapter" data-level="19.3" data-path="todo-1.html"><a href="todo-1.html#various"><i class="fa fa-check"></i><b>19.3</b> Various</a></li>
<li class="chapter" data-level="19.4" data-path="todo-1.html"><a href="todo-1.html#index-proposal"><i class="fa fa-check"></i><b>19.4</b> <strong>INDEX PROPOSAL</strong></a></li>
<li class="chapter" data-level="19.5" data-path="todo-1.html"><a href="todo-1.html#style-guide"><i class="fa fa-check"></i><b>19.5</b> Style guide</a>
<ul>
<li class="chapter" data-level="19.5.1" data-path="todo-1.html"><a href="todo-1.html#sections"><i class="fa fa-check"></i><b>19.5.1</b> Sections</a></li>
<li class="chapter" data-level="19.5.2" data-path="todo-1.html"><a href="todo-1.html#general"><i class="fa fa-check"></i><b>19.5.2</b> General</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="todo-1.html"><a href="todo-1.html#notas---remember"><i class="fa fa-check"></i><b>19.6</b> NOTAS - REMEMBER</a>
<ul>
<li class="chapter" data-level="19.6.1" data-path="todo-1.html"><a href="todo-1.html#refs"><i class="fa fa-check"></i><b>19.6.1</b> REFS</a></li>
<li class="chapter" data-level="19.6.2" data-path="todo-1.html"><a href="todo-1.html#notas"><i class="fa fa-check"></i><b>19.6.2</b> NOTAS</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R - Statistics Manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Estadistica_inferencial" class="section level1" number="10">
<h1><span class="header-section-number">10</span> Estadistica inferencial</h1>
<!-- # REVISAR -->
<!-- http://www.cookbook-r.com/Statistical_analysis/ANOVA/ -->
<!-- # REVISAR -->
<!-- # Para generar tablas APA de descriptivos y ANOVAS -->
<!-- https://cran.rstudio.com/web/packages/apaTables/vignettes/apaTables.html -->
<hr />
<p><strong>WIP: REVISAR PAQUETE AFEX</strong></p>
<ul>
<li>Permite definir variables intra y entre… y sacar posthocs!<br />
<a href="https://cran.r-project.org/web/packages/afex/afex.pdf" class="uri">https://cran.r-project.org/web/packages/afex/afex.pdf</a></li>
</ul>
<p>a = aov_ez(“ID,” “VD,” datos_long, within = c(“VI1,” “VI2,” “VI3”))</p>
<p>lsmip(a, VI1 ~ VI2 * VI3)</p>
<p>lsmeans(a, “VI1,” contr = “pairwise”) lsmeans(a, “VI2,” contr = “pairwise”) lsmeans(a, “VI3,” contr = “pairwise”)</p>
<p>lsmeans(a, c(“VI1,” “VI2,” “VI3”), contr = “pairwise”)</p>
<p>Why Psychologists Should Always Report the W-test Instead of the F-Test ANOVA
<a href="https://psyarxiv.com/wnezg" class="uri">https://psyarxiv.com/wnezg</a></p>
<p><strong>WIP: REVISAR</strong></p>
<ul>
<li><p><a href="http://www.quantide.com/raccoon-ch-2-4-3-way-anova/" class="uri">http://www.quantide.com/raccoon-ch-2-4-3-way-anova/</a></p></li>
<li><p>Don’t do balance tests: <a href="http://janhove.github.io/reporting/2014/09/26/balance-tests" class="uri">http://janhove.github.io/reporting/2014/09/26/balance-tests</a></p></li>
</ul>
<hr />
<p>Luego de tener algo parecido a una base de datos ordenada, y haber examinado y vizualizado nuestros datos, es posible que quieras analizarlos.</p>
<p>Para esto aprenderemos algo sobre la lógica de contrucción de modelos y formulas con los cuales podremos armar varias de las pruebas estadísticas clásicas y facilitara la comprensión de otras funciones más complejas como las relacionadas a Modelos re regresión más complejos y Modelos de Ecuaciones Estructurales.</p>
<p>##Algo sobre Modelos y Fórmulas
En terminos sencillos, un modelo es una conjetura sobre que tipo de relación tienen las variables en juego.</p>
<p>Por ejemplo yo podria suponer que a medida que aumenta el consumo de alcohol, nuestra percepción de belleza decae.</p>
<p>R tiene sencillas fórmulas para representar este tipo de relaciones.</p>
<p>Si nosotros pensamos que el consumo <code>Alcohol</code> predice el <code>Atractivo</code> de la persona con la que filteamos, podemos formularlo como un modelo de la forma:</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="Estadistica-inferencial.html#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co">#fórmula básica</span></span>
<span id="cb192-2"><a href="Estadistica-inferencial.html#cb192-2" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">=</span> <span class="st">&quot;Atractivo ~ Alcohol&quot;</span></span></code></pre></div>
<p>Si además pensamos que el <code>Sexo</code> tambien puede ser un predictor, modificamos el modelo inicial:</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="Estadistica-inferencial.html#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co">#añadir variables predictoras</span></span>
<span id="cb193-2"><a href="Estadistica-inferencial.html#cb193-2" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">=</span> <span class="st">&quot;Atractivo ~ Alcohol + Sexo&quot;</span></span></code></pre></div>
<p>En el caso de que 2 variables, <code>Alcohol</code> y <code>Sexo</code> sean predictores, es posible pensar que estas pueden interaccionas. Podemos agregar la interación de varias formas:</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="Estadistica-inferencial.html#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co">#versión extendida</span></span>
<span id="cb194-2"><a href="Estadistica-inferencial.html#cb194-2" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">=</span> <span class="st">&quot;Atractivo ~ Alcohol + Sexo + Alcohol*Sexo&quot;</span></span>
<span id="cb194-3"><a href="Estadistica-inferencial.html#cb194-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4"><a href="Estadistica-inferencial.html#cb194-4" aria-hidden="true" tabindex="-1"></a><span class="co">#versión corta</span></span>
<span id="cb194-5"><a href="Estadistica-inferencial.html#cb194-5" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">=</span> <span class="st">&quot;Atractivo ~ Alcohol*Sexo&quot;</span></span></code></pre></div>
<p>En resumen, todo lo que esta a la derecha del simbolo <code>~</code> es considerado un predictor o variable independiente, y todo lo que esta a la izquierda es una variable de resultado o una variable dependiente. No utilizamos el simbolo <code>=</code>, <code>&lt;-</code> o <code>==</code> ya que no estamos ni asignando ni haciendo una equivalencia lógica, y podriamos confundir a R.</p>
<p>Existen casos (por ejemplo, correlación o chi-cuadrado) en donde no hay una predicción propiamente tal. En estos casos se elimina del modelo la variable de resultado:</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="Estadistica-inferencial.html#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="co">#fórmula para modelo sin predictor o asociativo</span></span>
<span id="cb195-2"><a href="Estadistica-inferencial.html#cb195-2" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">=</span> <span class="st">&quot;~ Atractivo + Alcohol&quot;</span></span></code></pre></div>
<p>##Preparación de datos y packages</p>
<p>Para muchos de los análisis que vienen a continuación hemos creado una base de datos, la cual puedes descargar <a href="Data/08-Data_analysis/ANOVA_1.csv">Aquí</a>.</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="Estadistica-inferencial.html#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Packages</span></span>
<span id="cb196-2"><a href="Estadistica-inferencial.html#cb196-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&#39;readr&#39;</span>)) <span class="fu">install.packages</span>(<span class="st">&#39;readr&#39;</span>); <span class="fu">library</span>(<span class="st">&#39;readr&#39;</span>)</span>
<span id="cb196-3"><a href="Estadistica-inferencial.html#cb196-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&#39;dplyr&#39;</span>)) <span class="fu">install.packages</span>(<span class="st">&#39;dplyr&#39;</span>); <span class="fu">library</span>(<span class="st">&#39;dplyr&#39;</span>)</span>
<span id="cb196-4"><a href="Estadistica-inferencial.html#cb196-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&#39;yarrr&#39;</span>)) <span class="fu">install.packages</span>(<span class="st">&#39;yarrr&#39;</span>); <span class="fu">library</span>(<span class="st">&#39;yarrr&#39;</span>)</span>
<span id="cb196-5"><a href="Estadistica-inferencial.html#cb196-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&#39;car&#39;</span>)) <span class="fu">install.packages</span>(<span class="st">&#39;car&#39;</span>); <span class="fu">library</span>(<span class="st">&#39;car&#39;</span>)</span>
<span id="cb196-6"><a href="Estadistica-inferencial.html#cb196-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-7"><a href="Estadistica-inferencial.html#cb196-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-8"><a href="Estadistica-inferencial.html#cb196-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Importar dataframe</span></span>
<span id="cb196-9"><a href="Estadistica-inferencial.html#cb196-9" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">&quot;Data/08-Data_analysis/ANOVA_1.csv&quot;</span>)</span></code></pre></div>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
## cols(
##   Id = col_double(),
##   AccuracyIz = col_double(),
##   Moral = col_double(),
##   Tom = col_double(),
##   Empatia = col_double(),
##   Sexo = col_double(),
##   Edad = col_double(),
##   AccuracyDer = col_double(),
##   AdapSoc = col_double(),
##   FunEjec = col_double()
## )</code></pre>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="Estadistica-inferencial.html#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Muestra las primeras 10 observaciones</span></span>
<span id="cb198-2"><a href="Estadistica-inferencial.html#cb198-2" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>## # A tibble: 237 x 10
##       Id AccuracyIz Moral   Tom Empatia  Sexo  Edad AccuracyDer AdapSoc FunEjec
##    &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1     1         34     1    29      63     0    62          13      40      25
##  2     2         13    NA    23      55     0    53           8      43     175
##  3     3         20     1    26      27     0    18          14      38      18
##  4     4         24     1    21      33     0    40          14      48      16
##  5     5         20     1    18      35     1    65          15      48     175
##  6     6          2     0    23      38    NA    NA          12      35     205
##  7     7         13     1    19      38     0    56           5      16       8
##  8     8         27     1    15      42     1    70           8      41      21
##  9     9         37     1    23      36     0    43          23      38      26
## 10    10         27     0    20      51     1    52           9      24       8
## # … with 227 more rows</code></pre>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="Estadistica-inferencial.html#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Recodificar variable sexo de numérico a factor con etiquetas</span></span>
<span id="cb200-2"><a href="Estadistica-inferencial.html#cb200-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Sexo =</span> <span class="fu">ifelse</span>(Sexo <span class="sc">==</span> <span class="dv">0</span>, <span class="st">&quot;mujer&quot;</span>, <span class="st">&quot;hombre&quot;</span>)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Sexo =</span> <span class="fu">as.factor</span>(Sexo))</span></code></pre></div>
<p>##Prueba t para muestras independientes</p>
<p>###Contando la historia…
Evaluación de diferencias por <code>Sexo</code> en una prueba de Teoría de la mente <code>Tom</code></p>
<p>###Test</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="Estadistica-inferencial.html#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="co">#En primer lugar comprobamos el supuesto de homogeneidad de varianzas</span></span>
<span id="cb201-2"><a href="Estadistica-inferencial.html#cb201-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-3"><a href="Estadistica-inferencial.html#cb201-3" aria-hidden="true" tabindex="-1"></a><span class="co">#levene test {car} para homogeneidad de las varianzas</span></span>
<span id="cb201-4"><a href="Estadistica-inferencial.html#cb201-4" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(df<span class="sc">$</span>Tom <span class="sc">~</span> df<span class="sc">$</span>Sexo)</span></code></pre></div>
<pre><code>## Levene&#39;s Test for Homogeneity of Variance (center = median)
##        Df F value Pr(&gt;F)
## group   1  0.7558 0.3856
##       228</code></pre>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="Estadistica-inferencial.html#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Ingresamos nuestro modelo en la función t.test()</span></span>
<span id="cb203-2"><a href="Estadistica-inferencial.html#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(Tom <span class="sc">~</span> Sexo, df,  <span class="at">var.equal =</span> T, <span class="at">paired =</span> F)</span></code></pre></div>
<pre><code>## 
##  Two Sample t-test
## 
## data:  Tom by Sexo
## t = -2.4618, df = 228, p-value = 0.01456
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -2.6763463 -0.2967329
## sample estimates:
## mean in group hombre  mean in group mujer 
##             21.28070             22.76724</code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="Estadistica-inferencial.html#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Reporte descriptivo y Vizualización</span></span>
<span id="cb205-2"><a href="Estadistica-inferencial.html#cb205-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb205-3"><a href="Estadistica-inferencial.html#cb205-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>(Tom) <span class="sc">%&gt;%</span> </span>
<span id="cb205-4"><a href="Estadistica-inferencial.html#cb205-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Sexo) <span class="sc">%&gt;%</span> </span>
<span id="cb205-5"><a href="Estadistica-inferencial.html#cb205-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(Tom), <span class="at">sd =</span> <span class="fu">sd</span>(Tom))</span></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##   Sexo    mean    sd
##   &lt;fct&gt;  &lt;dbl&gt; &lt;dbl&gt;
## 1 hombre  21.4  4.74
## 2 mujer   22.8  4.14</code></pre>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="Estadistica-inferencial.html#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pirateplot</span>(Tom <span class="sc">~</span> Sexo, </span>
<span id="cb207-2"><a href="Estadistica-inferencial.html#cb207-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> df, </span>
<span id="cb207-3"><a href="Estadistica-inferencial.html#cb207-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">40</span>), </span>
<span id="cb207-4"><a href="Estadistica-inferencial.html#cb207-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab =</span> <span class="st">&quot;Metodo&quot;</span>, </span>
<span id="cb207-5"><a href="Estadistica-inferencial.html#cb207-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">ylab =</span> <span class="st">&quot;Nota&quot;</span>, </span>
<span id="cb207-6"><a href="Estadistica-inferencial.html#cb207-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">main =</span> <span class="st">&quot;t test Pirateplot&quot;</span>, </span>
<span id="cb207-7"><a href="Estadistica-inferencial.html#cb207-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.pch =</span> <span class="dv">16</span>, </span>
<span id="cb207-8"><a href="Estadistica-inferencial.html#cb207-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">pal =</span> <span class="st">&quot;basel&quot;</span>)</span></code></pre></div>
<p><img src="_main_images/data-analysis-t-test-1.png" width="672" /></p>
<p>##Prueba t para muestras dependientes</p>
<p>###Contando la historia…
En una tarea de disparo a objetivos, queremos evaluar si existen diferencias en la precisión de los sujetos a objetivos que aparecen a la Izquierda (<code>AccuracyIz</code>) o a la Derecha (<code>AccuracyDer</code>) del monitor.</p>
<p>###Test</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="Estadistica-inferencial.html#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Ingresamos nuestro modelo en la función t.test()</span></span>
<span id="cb208-2"><a href="Estadistica-inferencial.html#cb208-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(df<span class="sc">$</span>AccuracyIz, df<span class="sc">$</span>AccuracyDer, <span class="at">paired =</span> T)</span></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  df$AccuracyIz and df$AccuracyDer
## t = 22.904, df = 233, p-value &lt; 2.2e-16
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  10.05377 11.94623
## sample estimates:
## mean of the differences 
##                      11</code></pre>
<p>##Correlación de Pearson</p>
<p>###Contando la historia…
Se desea evaluar si existe alguna relación entre Teoria de la Mente (<code>Tom</code>) y el grado de Empatía de los sujetos (<code>Empatia</code>).</p>
<p>###Test</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="Estadistica-inferencial.html#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Correlación de Pearson</span></span>
<span id="cb210-2"><a href="Estadistica-inferencial.html#cb210-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(<span class="sc">~</span> Tom <span class="sc">+</span> Empatia, <span class="at">data =</span> df)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  Tom and Empatia
## t = 1.9789, df = 229, p-value = 0.04903
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.0005956093 0.2544818239
## sample estimates:
##       cor 
## 0.1296633</code></pre>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="Estadistica-inferencial.html#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Visualizar Diagrama de Dispersión</span></span>
<span id="cb212-2"><a href="Estadistica-inferencial.html#cb212-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(Tom, Empatia)) <span class="sc">+</span></span>
<span id="cb212-3"><a href="Estadistica-inferencial.html#cb212-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb212-4"><a href="Estadistica-inferencial.html#cb212-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="fu">transparent</span>(<span class="st">&quot;red&quot;</span>, .<span class="dv">4</span>))</span></code></pre></div>
<pre><code>## Warning: Removed 6 rows containing missing values (geom_point).</code></pre>
<p><img src="_main_images/data-analysis-correlation-1.png" width="672" /></p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="Estadistica-inferencial.html#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Selecione un subconjunto de variables para la correlación multiple</span></span>
<span id="cb214-2"><a href="Estadistica-inferencial.html#cb214-2" aria-hidden="true" tabindex="-1"></a>cordata <span class="ot">=</span> df <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>Id,<span class="sc">-</span>Moral,<span class="sc">-</span>Sexo,<span class="sc">-</span>AccuracyIz,<span class="sc">-</span>AccuracyDer,<span class="sc">-</span>Edad)</span>
<span id="cb214-3"><a href="Estadistica-inferencial.html#cb214-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-4"><a href="Estadistica-inferencial.html#cb214-4" aria-hidden="true" tabindex="-1"></a><span class="co">#carga libreria Hmisc</span></span>
<span id="cb214-5"><a href="Estadistica-inferencial.html#cb214-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&#39;Hmisc&#39;</span>)) <span class="fu">install.packages</span>(<span class="st">&#39;Hmisc&#39;</span>); <span class="fu">library</span>(<span class="st">&#39;Hmisc&#39;</span>)</span>
<span id="cb214-6"><a href="Estadistica-inferencial.html#cb214-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-7"><a href="Estadistica-inferencial.html#cb214-7" aria-hidden="true" tabindex="-1"></a><span class="co">#correlación multiple</span></span>
<span id="cb214-8"><a href="Estadistica-inferencial.html#cb214-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rcorr</span>(<span class="fu">as.matrix</span>(cordata), <span class="at">type =</span> <span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<pre><code>##          Tom Empatia AdapSoc FunEjec
## Tom     1.00    0.13    0.16    0.10
## Empatia 0.13    1.00    0.25    0.06
## AdapSoc 0.16    0.25    1.00    0.15
## FunEjec 0.10    0.06    0.15    1.00
## 
## n
##         Tom Empatia AdapSoc FunEjec
## Tom     232     231     226     231
## Empatia 231     235     229     234
## AdapSoc 226     229     231     230
## FunEjec 231     234     230     236
## 
## P
##         Tom    Empatia AdapSoc FunEjec
## Tom            0.0490  0.0130  0.1331 
## Empatia 0.0490         0.0001  0.3760 
## AdapSoc 0.0130 0.0001          0.0204 
## FunEjec 0.1331 0.3760  0.0204</code></pre>
<p>##Regresión Simple</p>
<p>###Contando la historia…</p>
<p>Evaluaremos como las Funciones ejecutivas (<code>FunEjec</code>) pueden predecir la Precisión a objetivos en una tarea atencional (<code>Accuracy</code>).</p>
<p>Para esto primero añadiremos una nueva variable <code>Accuracy</code> la cual será el promedio de precisión para los objetivos Derechos (<code>AccuracyDer</code>) e Izquierdos (<code>AccuracyIz</code>). Lo realizaremos con la función <code>mutate</code> antes revisada en el apartado de manipulación de datos.</p>
<p>Además filtraremos a los sujetos con puntajes bajos (menos de 50 puntos).</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="Estadistica-inferencial.html#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Creamos nueva variable &quot;Accuracy&quot; con la función mutate() {dplyr}</span></span>
<span id="cb216-2"><a href="Estadistica-inferencial.html#cb216-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Accuracy =</span> (AccuracyIz <span class="sc">+</span> AccuracyDer)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb216-3"><a href="Estadistica-inferencial.html#cb216-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-4"><a href="Estadistica-inferencial.html#cb216-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Utilizar observaciones con puntajes de Funcion ejecutiva sobre 50 puntos.</span></span>
<span id="cb216-5"><a href="Estadistica-inferencial.html#cb216-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(FunEjec <span class="sc">&gt;</span> <span class="dv">50</span>)</span></code></pre></div>
<p>###Test</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="Estadistica-inferencial.html#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Insertamos nuestra fórmula al Modelo de Regresión Simple</span></span>
<span id="cb217-2"><a href="Estadistica-inferencial.html#cb217-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">lm</span>(Accuracy <span class="sc">~</span> FunEjec, df)</span>
<span id="cb217-3"><a href="Estadistica-inferencial.html#cb217-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-4"><a href="Estadistica-inferencial.html#cb217-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Resumen de Coeficientes y Parametros del modelo</span></span>
<span id="cb217-5"><a href="Estadistica-inferencial.html#cb217-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Accuracy ~ FunEjec, data = df)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -11.587  -3.087   0.413   2.163  10.038 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  5.76939    2.83753   2.033   0.0457 *  
## FunEjec      0.06252    0.01457   4.292 5.36e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.729 on 73 degrees of freedom
##   (2 observations deleted due to missingness)
## Multiple R-squared:  0.2015, Adjusted R-squared:  0.1905 
## F-statistic: 18.42 on 1 and 73 DF,  p-value: 5.363e-05</code></pre>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="Estadistica-inferencial.html#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Intevalos de Confianza de los parámetros del modelo</span></span>
<span id="cb219-2"><a href="Estadistica-inferencial.html#cb219-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(fit, <span class="at">level =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>##                  2.5 %      97.5 %
## (Intercept) 0.11419463 11.42458615
## FunEjec     0.03349037  0.09155961</code></pre>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="Estadistica-inferencial.html#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Visualizar Diagrama de Dispersión para Regresión</span></span>
<span id="cb221-2"><a href="Estadistica-inferencial.html#cb221-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(FunEjec, Accuracy)) <span class="sc">+</span></span>
<span id="cb221-3"><a href="Estadistica-inferencial.html#cb221-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb221-4"><a href="Estadistica-inferencial.html#cb221-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="fu">transparent</span>(<span class="st">&quot;black&quot;</span>, .<span class="dv">4</span>)) <span class="sc">+</span> </span>
<span id="cb221-5"><a href="Estadistica-inferencial.html#cb221-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm , <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">se =</span> T)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 2 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
<p><img src="_main_images/data-analysis-regression2-1.png" width="672" /></p>
<p>##Análsis de la Varianza (1 Factor)
Esta vez trabajaremos con otra base de datos, la cual puedes descargar <a href="Data/08-Data_analysis/ANOVA_2.csv">Aquí</a>.
Se recomienda en esta oportunidad limpiar nuestro espacio de trabajo. Para esto podemos presionar <code>Ctrl + Shift + F10</code> o utilizar la función:</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="Estadistica-inferencial.html#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
<p>###Preparación de datos y packages</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="Estadistica-inferencial.html#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Packages</span></span>
<span id="cb226-2"><a href="Estadistica-inferencial.html#cb226-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&#39;readr&#39;</span>)) <span class="fu">install.packages</span>(<span class="st">&#39;readr&#39;</span>); <span class="fu">library</span>(<span class="st">&#39;readr&#39;</span>)</span>
<span id="cb226-3"><a href="Estadistica-inferencial.html#cb226-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&#39;dplyr&#39;</span>)) <span class="fu">install.packages</span>(<span class="st">&#39;dplyr&#39;</span>); <span class="fu">library</span>(<span class="st">&#39;dplyr&#39;</span>)</span>
<span id="cb226-4"><a href="Estadistica-inferencial.html#cb226-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&#39;stats&#39;</span>)) <span class="fu">install.packages</span>(<span class="st">&#39;stats&#39;</span>); <span class="fu">library</span>(<span class="st">&#39;stats&#39;</span>)</span>
<span id="cb226-5"><a href="Estadistica-inferencial.html#cb226-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&#39;car&#39;</span>)) <span class="fu">install.packages</span>(<span class="st">&#39;car&#39;</span>); <span class="fu">library</span>(<span class="st">&#39;car&#39;</span>)</span>
<span id="cb226-6"><a href="Estadistica-inferencial.html#cb226-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&#39;apaTables&#39;</span>)) <span class="fu">install.packages</span>(<span class="st">&#39;apaTables&#39;</span>); <span class="fu">library</span>(<span class="st">&#39;apaTables&#39;</span>)</span>
<span id="cb226-7"><a href="Estadistica-inferencial.html#cb226-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-8"><a href="Estadistica-inferencial.html#cb226-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-9"><a href="Estadistica-inferencial.html#cb226-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Importar dataframe</span></span>
<span id="cb226-10"><a href="Estadistica-inferencial.html#cb226-10" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">&quot;Data/08-Data_analysis/ANOVA_2.csv&quot;</span>)</span></code></pre></div>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
## cols(
##   Metodo = col_double(),
##   Nota = col_double()
## )</code></pre>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="Estadistica-inferencial.html#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Muestra las primeras 10 observaciones</span></span>
<span id="cb228-2"><a href="Estadistica-inferencial.html#cb228-2" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>## # A tibble: 30 x 2
##    Metodo  Nota
##     &lt;dbl&gt; &lt;dbl&gt;
##  1      1    50
##  2      1    45
##  3      1    48
##  4      1    47
##  5      1    45
##  6      1    49
##  7      1    50
##  8      1    54
##  9      1    57
## 10      1    55
## # … with 20 more rows</code></pre>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="Estadistica-inferencial.html#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Recodificar variable Metodo de numérico a factor con etiquetas</span></span>
<span id="cb230-2"><a href="Estadistica-inferencial.html#cb230-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Metodo =</span> <span class="fu">ifelse</span>(Metodo <span class="sc">==</span> <span class="dv">1</span>, <span class="st">&quot;Electroshock&quot;</span>, <span class="fu">ifelse</span>(Metodo <span class="sc">==</span> <span class="dv">2</span>, <span class="st">&quot;Indiferencia&quot;</span>, <span class="st">&quot;Buen trabajo&quot;</span>))) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Metodo =</span> <span class="fu">as.factor</span>(Metodo))</span></code></pre></div>
<p>###Contando la historia…
Se desea evaluar que métodos pueden contribuir (o no) al aprendizaje de estadísticas en R. Para esto tenemos las variables <code>Metodo</code> (si se uso Electroshock, la fria Indiferencia o un “Buen trabajo!”) y la <code>Nota</code> nota que se obtuvo en el curso.</p>
<p>###Test</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="Estadistica-inferencial.html#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Introducimos la formula al Modelo con la función de ANOVA aov()</span></span>
<span id="cb231-2"><a href="Estadistica-inferencial.html#cb231-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">aov</span>(Nota <span class="sc">~</span> Metodo, df)</span>
<span id="cb231-3"><a href="Estadistica-inferencial.html#cb231-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-4"><a href="Estadistica-inferencial.html#cb231-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Summario de Parámetros y Coeficientes</span></span>
<span id="cb231-5"><a href="Estadistica-inferencial.html#cb231-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## Metodo       2 1205.1   602.5   21.01 3.15e-06 ***
## Residuals   27  774.4    28.7                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="Estadistica-inferencial.html#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="co">#levene test {car} para homogeneidad de las varianzas</span></span>
<span id="cb233-2"><a href="Estadistica-inferencial.html#cb233-2" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(df<span class="sc">$</span>Nota <span class="sc">~</span> df<span class="sc">$</span>Metodo)</span></code></pre></div>
<pre><code>## Levene&#39;s Test for Homogeneity of Variance (center = median)
##       Df F value Pr(&gt;F)
## group  2  1.7343 0.1956
##       27</code></pre>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="Estadistica-inferencial.html#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Comparaciones Multiples mediante función TukeyHSD() {stats}</span></span>
<span id="cb235-2"><a href="Estadistica-inferencial.html#cb235-2" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(fit)</span></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = Nota ~ Metodo, data = df)
## 
## $Metodo
##                            diff          lwr       upr     p adj
## Electroshock-Buen trabajo -15.4 -21.33834579 -9.461654 0.0000020
## Indiferencia-Buen trabajo  -9.4 -15.33834579 -3.461654 0.0015175
## Indiferencia-Electroshock   6.0   0.06165421 11.938346 0.0472996</code></pre>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="Estadistica-inferencial.html#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Reporte descriptivo y Vizualización</span></span>
<span id="cb237-2"><a href="Estadistica-inferencial.html#cb237-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb237-3"><a href="Estadistica-inferencial.html#cb237-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Metodo) <span class="sc">%&gt;%</span> </span>
<span id="cb237-4"><a href="Estadistica-inferencial.html#cb237-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(Nota), <span class="at">sd =</span> <span class="fu">sd</span>(Nota))</span></code></pre></div>
<pre><code>## # A tibble: 3 x 3
##   Metodo        mean    sd
##   &lt;fct&gt;        &lt;dbl&gt; &lt;dbl&gt;
## 1 Buen trabajo  65.4  4.30
## 2 Electroshock  50    4.14
## 3 Indiferencia  56    7.10</code></pre>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="Estadistica-inferencial.html#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pirateplot</span>(Nota <span class="sc">~</span> Metodo, </span>
<span id="cb239-2"><a href="Estadistica-inferencial.html#cb239-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> df, </span>
<span id="cb239-3"><a href="Estadistica-inferencial.html#cb239-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), </span>
<span id="cb239-4"><a href="Estadistica-inferencial.html#cb239-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab =</span> <span class="st">&quot;Metodo&quot;</span>, </span>
<span id="cb239-5"><a href="Estadistica-inferencial.html#cb239-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">ylab =</span> <span class="st">&quot;Nota&quot;</span>, </span>
<span id="cb239-6"><a href="Estadistica-inferencial.html#cb239-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">main =</span> <span class="st">&quot;ANOVA Pirateplot&quot;</span>, </span>
<span id="cb239-7"><a href="Estadistica-inferencial.html#cb239-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.pch =</span> <span class="dv">16</span>, </span>
<span id="cb239-8"><a href="Estadistica-inferencial.html#cb239-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">pal =</span> <span class="st">&quot;basel&quot;</span>)</span></code></pre></div>
<p><img src="_main_images/data-analysis-aov3-1.png" width="672" /></p>
<p>###Tablas</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="Estadistica-inferencial.html#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apa.1way.table</span>(<span class="at">iv =</span> Metodo, <span class="at">dv =</span> Nota, <span class="at">data =</span> df, <span class="at">filename =</span> <span class="st">&quot;Resultados/Figure1_APA.doc&quot;</span>, <span class="at">table.number =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## 
## 
## Table 1 
## 
## Descriptive statistics for Nota as a function of Metodo.  
## 
##        Metodo     M   SD
##  Buen trabajo 65.40 4.30
##  Electroshock 50.00 4.14
##  Indiferencia 56.00 7.10
## 
## Note. M and SD represent mean and standard deviation, respectively.
## </code></pre>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="Estadistica-inferencial.html#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apa.aov.table</span>(fit, <span class="at">filename =</span> <span class="st">&quot;Resultados/Figure2_APA.doc&quot;</span>,<span class="at">table.number =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## 
## 
## Table 2 
## 
## ANOVA results using Nota as the dependent variable
##  
## 
##    Predictor       SS df       MS       F    p partial_eta2 CI_90_partial_eta2
##  (Intercept) 42771.60  1 42771.60 1491.26 .000                                
##       Metodo  1205.07  2   602.53   21.01 .000          .61         [.36, .71]
##        Error   774.40 27    28.68                                             
## 
## Note: Values in square brackets indicate the bounds of the 90% confidence interval for partial eta-squared</code></pre>
<p>##Análsis de la Varianza (2 Factores)</p>
<p>###Descarga</p>
<p>Esta vez nuevamente trabajaremos con otra base de datos, la cual puedes descargar <a href="Data/08-Data_analysis/ANOVA_3.csv">Aquí</a>.
Se recomienda nuevamente limpiar nuestro espacio de trabajo. Para esto podemos presionar <code>Ctrl + Shift + F10</code> o utilizar la función:</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="Estadistica-inferencial.html#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<p>###Preparación de datos y packages</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="Estadistica-inferencial.html#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Packages</span></span>
<span id="cb245-2"><a href="Estadistica-inferencial.html#cb245-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&#39;readr&#39;</span>)) <span class="fu">install.packages</span>(<span class="st">&#39;readr&#39;</span>); <span class="fu">library</span>(<span class="st">&#39;readr&#39;</span>)</span>
<span id="cb245-3"><a href="Estadistica-inferencial.html#cb245-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&#39;dplyr&#39;</span>)) <span class="fu">install.packages</span>(<span class="st">&#39;dplyr&#39;</span>); <span class="fu">library</span>(<span class="st">&#39;dplyr&#39;</span>)</span>
<span id="cb245-4"><a href="Estadistica-inferencial.html#cb245-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&#39;stats&#39;</span>)) <span class="fu">install.packages</span>(<span class="st">&#39;stats&#39;</span>); <span class="fu">library</span>(<span class="st">&#39;stats&#39;</span>)</span>
<span id="cb245-5"><a href="Estadistica-inferencial.html#cb245-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&#39;car&#39;</span>)) <span class="fu">install.packages</span>(<span class="st">&#39;car&#39;</span>); <span class="fu">library</span>(<span class="st">&#39;car&#39;</span>)</span>
<span id="cb245-6"><a href="Estadistica-inferencial.html#cb245-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-7"><a href="Estadistica-inferencial.html#cb245-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-8"><a href="Estadistica-inferencial.html#cb245-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-9"><a href="Estadistica-inferencial.html#cb245-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Importar dataframe</span></span>
<span id="cb245-10"><a href="Estadistica-inferencial.html#cb245-10" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">&quot;Data/08-Data_analysis/ANOVA_3.csv&quot;</span>)</span></code></pre></div>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
## cols(
##   Sexo = col_double(),
##   Alcohol = col_double(),
##   Atractivo = col_double()
## )</code></pre>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="Estadistica-inferencial.html#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Muestra las primeras 10 observaciones</span></span>
<span id="cb247-2"><a href="Estadistica-inferencial.html#cb247-2" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>## # A tibble: 32 x 3
##     Sexo Alcohol Atractivo
##    &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;
##  1     1       0        65
##  2     1       0        70
##  3     1       0        60
##  4     1       0        60
##  5     1       0        60
##  6     1       0        55
##  7     1       0        60
##  8     1       0        55
##  9     1       1        55
## 10     1       1        65
## # … with 22 more rows</code></pre>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="Estadistica-inferencial.html#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Recodificar variable Sexo y Alcohol de numérico a factor con etiquetas</span></span>
<span id="cb249-2"><a href="Estadistica-inferencial.html#cb249-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Sexo =</span> <span class="fu">ifelse</span>(Sexo <span class="sc">==</span> <span class="dv">0</span>, <span class="st">&quot;mujer&quot;</span>, <span class="st">&quot;hombre&quot;</span>)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Sexo =</span> <span class="fu">as.factor</span>(Sexo))</span>
<span id="cb249-3"><a href="Estadistica-inferencial.html#cb249-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Alcohol =</span> <span class="fu">ifelse</span>(Alcohol <span class="sc">==</span> <span class="dv">0</span>, <span class="st">&quot;No consume&quot;</span>, <span class="st">&quot;Tres Shop&quot;</span>)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Alcohol =</span> <span class="fu">as.factor</span>(Alcohol))</span></code></pre></div>
<p>###Contando la historia…
A veces cuando bebemos bebidas espirituosas, podemos sobreestimar el atractivo de otras personas. Esto en psicología lo conocemos como “Beer Glass Effect.”
Deseamos ver este efecto, pero además ver si el Sexo influye también.</p>
<p>Para esto tenemos las variables <code>Alcohol</code> (Si ha bebido o no), el <code>Sexo</code> del bebedor y la puntuación de <code>Atractivo</code> de la persona con la que flirtea aquella noche.</p>
<p>###Test</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="Estadistica-inferencial.html#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Ajustamos el modelo con la funcion de ANOVA aov()</span></span>
<span id="cb250-2"><a href="Estadistica-inferencial.html#cb250-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">aov</span>(Atractivo <span class="sc">~</span> Sexo <span class="sc">*</span> Alcohol, df)</span>
<span id="cb250-3"><a href="Estadistica-inferencial.html#cb250-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-4"><a href="Estadistica-inferencial.html#cb250-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Summario de Parámetros y Coeficientes</span></span>
<span id="cb250-5"><a href="Estadistica-inferencial.html#cb250-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>##              Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## Sexo          1  488.3   488.3    6.54   0.0163 *  
## Alcohol       1 2363.3  2363.3   31.65 5.03e-06 ***
## Sexo:Alcohol  1 1582.0  1582.0   21.19 8.20e-05 ***
## Residuals    28 2090.6    74.7                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="Estadistica-inferencial.html#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Comparaciones Multiples mediante función TukeyHSD() {stats}</span></span>
<span id="cb252-2"><a href="Estadistica-inferencial.html#cb252-2" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(fit)</span></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = Atractivo ~ Sexo * Alcohol, data = df)
## 
## $Sexo
##                 diff       lwr       upr     p adj
## mujer-hombre -7.8125 -14.07042 -1.554575 0.0162548
## 
## $Alcohol
##                          diff       lwr       upr p adj
## Tres Shop-No consume -17.1875 -23.44542 -10.92958 5e-06
## 
## $`Sexo:Alcohol`
##                                       diff        lwr        upr     p adj
## mujer:No consume-hombre:No consume   6.250  -5.546177  18.046177 0.4820693
## hombre:Tres Shop-hombre:No consume  -3.125 -14.921177   8.671177 0.8869596
## mujer:Tres Shop-hombre:No consume  -25.000 -36.796177 -13.203823 0.0000186
## hombre:Tres Shop-mujer:No consume   -9.375 -21.171177   2.421177 0.1564908
## mujer:Tres Shop-mujer:No consume   -31.250 -43.046177 -19.453823 0.0000004
## mujer:Tres Shop-hombre:Tres Shop   -21.875 -33.671177 -10.078823 0.0001309</code></pre>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="Estadistica-inferencial.html#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Reporte descriptivo y Vizualización</span></span>
<span id="cb254-2"><a href="Estadistica-inferencial.html#cb254-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb254-3"><a href="Estadistica-inferencial.html#cb254-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Alcohol,Sexo) <span class="sc">%&gt;%</span> </span>
<span id="cb254-4"><a href="Estadistica-inferencial.html#cb254-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(Atractivo), <span class="at">sd =</span> <span class="fu">sd</span>(Atractivo))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;Alcohol&#39;. You can override using the `.groups` argument.</code></pre>
<pre><code>## # A tibble: 4 x 4
## # Groups:   Alcohol [2]
##   Alcohol    Sexo    mean    sd
##   &lt;fct&gt;      &lt;fct&gt;  &lt;dbl&gt; &lt;dbl&gt;
## 1 No consume hombre  60.6  4.96
## 2 No consume mujer   66.9 10.3 
## 3 Tres Shop  hombre  57.5  7.07
## 4 Tres Shop  mujer   35.6 10.8</code></pre>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="Estadistica-inferencial.html#cb257-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb257-2"><a href="Estadistica-inferencial.html#cb257-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Alcohol) <span class="sc">%&gt;%</span> </span>
<span id="cb257-3"><a href="Estadistica-inferencial.html#cb257-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(Atractivo), <span class="at">sd =</span> <span class="fu">sd</span>(Atractivo))</span></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##   Alcohol     mean    sd
##   &lt;fct&gt;      &lt;dbl&gt; &lt;dbl&gt;
## 1 No consume  63.8  8.47
## 2 Tres Shop   46.6 14.3</code></pre>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="Estadistica-inferencial.html#cb259-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb259-2"><a href="Estadistica-inferencial.html#cb259-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Sexo) <span class="sc">%&gt;%</span> </span>
<span id="cb259-3"><a href="Estadistica-inferencial.html#cb259-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(Atractivo), <span class="at">sd =</span> <span class="fu">sd</span>(Atractivo))</span></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##   Sexo    mean    sd
##   &lt;fct&gt;  &lt;dbl&gt; &lt;dbl&gt;
## 1 hombre  59.1  6.12
## 2 mujer   51.2 19.1</code></pre>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="Estadistica-inferencial.html#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pirateplot</span>(Atractivo <span class="sc">~</span> Sexo <span class="sc">+</span> Alcohol, </span>
<span id="cb261-2"><a href="Estadistica-inferencial.html#cb261-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> df, </span>
<span id="cb261-3"><a href="Estadistica-inferencial.html#cb261-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), </span>
<span id="cb261-4"><a href="Estadistica-inferencial.html#cb261-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab =</span> <span class="st">&quot;Sex*Alcohol&quot;</span>, </span>
<span id="cb261-5"><a href="Estadistica-inferencial.html#cb261-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">ylab =</span> <span class="st">&quot;Attractiveness Score&quot;</span>, </span>
<span id="cb261-6"><a href="Estadistica-inferencial.html#cb261-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">main =</span> <span class="st">&quot;ANOVA Pirateplot&quot;</span>, </span>
<span id="cb261-7"><a href="Estadistica-inferencial.html#cb261-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">point.pch =</span> <span class="dv">16</span>, </span>
<span id="cb261-8"><a href="Estadistica-inferencial.html#cb261-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">pal =</span> <span class="st">&quot;basel&quot;</span>)</span></code></pre></div>
<p><img src="_main_images/data-analysis-aov-2-fact3-1.png" width="672" /></p>
<p>###Tablas</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="Estadistica-inferencial.html#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apa.2way.table</span>(<span class="at">iv1 =</span> Sexo, <span class="at">iv2 =</span> Alcohol, <span class="at">dv =</span> Atractivo, <span class="at">data =</span> df, <span class="at">filename =</span> <span class="st">&quot;Resultados/Figure3_APA.doc&quot;</span>, <span class="at">table.number =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## 
## 
## Table 3 
## 
## Means and standard deviations for Atractivo as a function of a 2(Sexo) X 2(Alcohol) design 
## 
##            Alcohol                      
##         No consume       Tres Shop      
##    Sexo          M    SD         M    SD
##  hombre      60.62  4.96     57.50  7.07
##   mujer      66.88 10.33     35.62 10.84
## 
## Note. M and SD represent mean and standard deviation, respectively.</code></pre>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="Estadistica-inferencial.html#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apa.aov.table</span>(fit, <span class="at">filename =</span> <span class="st">&quot;Resultados/Figure4_APA.doc&quot;</span>,<span class="at">table.number =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## 
## 
## Table 4 
## 
## ANOVA results using Atractivo as the dependent variable
##  
## 
##       Predictor       SS df       MS      F    p partial_eta2 CI_90_partial_eta2
##     (Intercept) 29403.12  1 29403.12 393.80 .000                                
##            Sexo   156.25  1   156.25   2.09 .159          .07         [.00, .24]
##         Alcohol    39.06  1    39.06   0.52 .475          .02         [.00, .16]
##  Sexo x Alcohol  1582.03  1  1582.03  21.19 .000          .43         [.19, .58]
##           Error  2090.62 28    74.66                                            
## 
## Note: Values in square brackets indicate the bounds of the 90% confidence interval for partial eta-squared</code></pre>
<div id="referencias-y-fuentes" class="section level2" number="10.1">
<h2><span class="header-section-number">10.1</span> Referencias y Fuentes</h2>
<ul>
<li><p><a href="https://uk.sagepub.com/en-gb/eur/discovering-statistics-using-r/book236067">Field, A. (2012). Discovering statistics using R.</a></p></li>
<li><p><a href="https://www.manning.com/books/r-in-action">Kabacoff, R. (2015). R in action: data analysis and graphics with R.</a></p></li>
</ul>

</div>
<div id="association-test" class="section level2" number="10.2">
<h2><span class="header-section-number">10.2</span> Association test</h2>
<p>A.K.A. X square test of independence</p>
<p><strong>WIP - Alternatives</strong></p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="Estadistica-inferencial.html#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Con datos de estudio Merlin</span></span>
<span id="cb266-2"><a href="Estadistica-inferencial.html#cb266-2" aria-hidden="true" tabindex="-1"></a><span class="co"># prop.test(table(DB_all$Ahorro_Dico, DB_all$Futuro_d))</span></span>
<span id="cb266-3"><a href="Estadistica-inferencial.html#cb266-3" aria-hidden="true" tabindex="-1"></a><span class="co"># chisq.test(table(DB_all$Ahorro_Dico, DB_all$Futuro_d))</span></span>
<span id="cb266-4"><a href="Estadistica-inferencial.html#cb266-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-5"><a href="Estadistica-inferencial.html#cb266-5" aria-hidden="true" tabindex="-1"></a><span class="co"># # More powerful</span></span>
<span id="cb266-6"><a href="Estadistica-inferencial.html#cb266-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Exact::exact.test(table(DB_all$Ahorro_Dico, DB_all$Futuro_d))</span></span>
<span id="cb266-7"><a href="Estadistica-inferencial.html#cb266-7" aria-hidden="true" tabindex="-1"></a><span class="co"># BayesFactor::contingencyTableBF(table(DB_all$Ahorro_Dico, DB_all$Futuro_d), sampleType = &quot;indepMulti&quot;, fixedMargin = &quot;rows&quot;)</span></span></code></pre></div>
<p><strong>Libraries</strong></p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="Estadistica-inferencial.html#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&#39;BayesFactor&#39;</span>)) <span class="fu">install.packages</span>(<span class="st">&#39;BayesFactor&#39;</span>); <span class="fu">library</span>(<span class="st">&#39;BayesFactor&#39;</span>)</span>
<span id="cb267-2"><a href="Estadistica-inferencial.html#cb267-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&#39;lsr&#39;</span>)) <span class="fu">install.packages</span>(<span class="st">&#39;lsr&#39;</span>); <span class="fu">library</span>(<span class="st">&#39;lsr&#39;</span>)</span></code></pre></div>
<p><strong>Import data - WIP</strong>
We use the following <a href="Data/08-Data_analysis/Association_test.csv">dataset</a>.</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="Estadistica-inferencial.html#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Import to variable &quot;dataset&quot;</span></span>
<span id="cb268-2"><a href="Estadistica-inferencial.html#cb268-2" aria-hidden="true" tabindex="-1"></a>dataset <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">&quot;Data/08-Data_analysis/Association_test.csv&quot;</span>)</span>
<span id="cb268-3"><a href="Estadistica-inferencial.html#cb268-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-4"><a href="Estadistica-inferencial.html#cb268-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Show first 5 rows</span></span>
<span id="cb268-5"><a href="Estadistica-inferencial.html#cb268-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dataset)</span></code></pre></div>
<pre><code>##    X    ID Dem_Gender Dem_Age Dem_Education       SET    answer   Time Formato Problema Accuracy      Error Accuracy_factor Formato_factor Problema_factor Time_set1
## 1  4 71827          2      34             4 Resp_SET1 0.3333333 12.905      FN   DECIMA        1  0.0000000               1             FN          DECIMA    12.905
## 2  5  1946          1      29             6 Resp_SET1 0.3333333 38.895      FN   DECIMA        1  0.0000000               1             FN          DECIMA    38.895
## 3  6 83294          2      25             6 Resp_SET1 0.3333333 42.473      FN   UNIDAD        1  0.0000000               1             FN          UNIDAD    42.473
## 4  8 34065          1      29             6 Resp_SET1 0.6666667 16.438      PR   UNIDAD        0 -0.3333333               0             PR          UNIDAD    16.438
## 5  9 39707          1      30             5 Resp_SET1 0.3333333 60.794      PR   DECIMA        1  0.0000000               1             PR          DECIMA    60.794
## 6 10 69772          2      28             2 Resp_SET1 0.5000000 26.169      PR   UNIDAD        0 -0.1666667               0             PR          UNIDAD    26.169</code></pre>
<p><strong>Prepare data</strong></p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="Estadistica-inferencial.html#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to factors</span></span>
<span id="cb270-2"><a href="Estadistica-inferencial.html#cb270-2" aria-hidden="true" tabindex="-1"></a>dataset<span class="sc">$</span>Accuracy_factor <span class="ot">=</span> <span class="fu">as.factor</span>(dataset<span class="sc">$</span>Accuracy)</span>
<span id="cb270-3"><a href="Estadistica-inferencial.html#cb270-3" aria-hidden="true" tabindex="-1"></a>dataset<span class="sc">$</span>Formato_factor <span class="ot">=</span> <span class="fu">as.factor</span>(dataset<span class="sc">$</span>Formato)</span>
<span id="cb270-4"><a href="Estadistica-inferencial.html#cb270-4" aria-hidden="true" tabindex="-1"></a>dataset<span class="sc">$</span>Problema_factor <span class="ot">=</span> <span class="fu">as.factor</span>(dataset<span class="sc">$</span>Problema)</span></code></pre></div>
<div id="frequentist-1" class="section level3" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> Frequentist<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></h3>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="Estadistica-inferencial.html#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Accuracy_factor + Formato_factor</span></span>
<span id="cb271-2"><a href="Estadistica-inferencial.html#cb271-2" aria-hidden="true" tabindex="-1"></a>crosstab_Formato <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(<span class="sc">~</span> Accuracy_factor <span class="sc">+</span> Formato_factor, dataset); crosstab_Formato</span></code></pre></div>
<pre><code>##                Formato_factor
## Accuracy_factor FN PR
##               0 18 24
##               1 66 57</code></pre>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="Estadistica-inferencial.html#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="fu">associationTest</span>(<span class="at">formula =</span> <span class="sc">~</span> Accuracy_factor <span class="sc">+</span> Formato_factor, <span class="at">data =</span> dataset )</span></code></pre></div>
<pre><code>## 
##      Chi-square test of categorical association
## 
## Variables:   Accuracy_factor, Formato_factor 
## 
## Hypotheses: 
##    null:        variables are independent of one another
##    alternative: some contingency exists between variables
## 
## Observed contingency table:
##                Formato_factor
## Accuracy_factor FN PR
##               0 18 24
##               1 66 57
## 
## Expected contingency table under the null hypothesis:
##                Formato_factor
## Accuracy_factor   FN   PR
##               0 21.4 20.6
##               1 62.6 60.4
## 
## Test results: 
##    X-squared statistic:  1.061 
##    degrees of freedom:  1 
##    p-value:  0.303 
## 
## Other information: 
##    estimated effect size (Cramer&#39;s v):  0.08 
##    Yates&#39; continuity correction has been applied</code></pre>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="Estadistica-inferencial.html#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Accuracy_factor + Problema_factor</span></span>
<span id="cb275-2"><a href="Estadistica-inferencial.html#cb275-2" aria-hidden="true" tabindex="-1"></a>crosstab_Problema <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(<span class="sc">~</span> Accuracy_factor <span class="sc">+</span> Problema_factor, dataset); crosstab_Problema</span></code></pre></div>
<pre><code>##                Problema_factor
## Accuracy_factor DECIMA UNIDAD
##               0     19     23
##               1     61     62</code></pre>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="Estadistica-inferencial.html#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="fu">associationTest</span>(<span class="at">formula =</span> <span class="sc">~</span> Accuracy_factor <span class="sc">+</span> Problema_factor, <span class="at">data =</span> dataset )</span></code></pre></div>
<pre><code>## 
##      Chi-square test of categorical association
## 
## Variables:   Accuracy_factor, Problema_factor 
## 
## Hypotheses: 
##    null:        variables are independent of one another
##    alternative: some contingency exists between variables
## 
## Observed contingency table:
##                Problema_factor
## Accuracy_factor DECIMA UNIDAD
##               0     19     23
##               1     61     62
## 
## Expected contingency table under the null hypothesis:
##                Problema_factor
## Accuracy_factor DECIMA UNIDAD
##               0   20.4   21.6
##               1   59.6   63.4
## 
## Test results: 
##    X-squared statistic:  0.095 
##    degrees of freedom:  1 
##    p-value:  0.757 
## 
## Other information: 
##    estimated effect size (Cramer&#39;s v):  0.024 
##    Yates&#39; continuity correction has been applied</code></pre>
</div>
<div id="bayesian-2" class="section level3" number="10.2.2">
<h3><span class="header-section-number">10.2.2</span> Bayesian<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></h3>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="Estadistica-inferencial.html#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Accuracy_factor + Formato_factor</span></span>
<span id="cb279-2"><a href="Estadistica-inferencial.html#cb279-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contingencyTableBF</span>( crosstab_Formato, <span class="at">sampleType =</span> <span class="st">&quot;jointMulti&quot;</span> ) </span></code></pre></div>
<pre><code>## Bayes factor analysis
## --------------
## [1] Non-indep. (a=1) : 0.5146257 ±0%
## 
## Against denominator:
##   Null, independence, a = 1 
## ---
## Bayes factor type: BFcontingencyTable, joint multinomial</code></pre>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="Estadistica-inferencial.html#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Accuracy_factor + Problema_factor</span></span>
<span id="cb281-2"><a href="Estadistica-inferencial.html#cb281-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contingencyTableBF</span>( crosstab_Problema, <span class="at">sampleType =</span> <span class="st">&quot;jointMulti&quot;</span> ) </span></code></pre></div>
<pre><code>## Bayes factor analysis
## --------------
## [1] Non-indep. (a=1) : 0.2811145 ±0%
## 
## Against denominator:
##   Null, independence, a = 1 
## ---
## Bayes factor type: BFcontingencyTable, joint multinomial</code></pre>
</div>
<div id="results-report---wip" class="section level3" number="10.2.3">
<h3><span class="header-section-number">10.2.3</span> Results report - WIP</h3>
<blockquote>
<p>TODO: Use an example where we have both a null a and a significant finding</p>
</blockquote>
<div id="frequentist---wip" class="section level4" number="10.2.3.1">
<h4><span class="header-section-number">10.2.3.1</span> Frequentist - WIP</h4>
<p>Pearson’s X<sup>2</sup> revealed a significant association between species and choice (X<sup>2</sup> = 10.7, p = .01): robots appeared to be more likely to say that they prefer flowers, but the humans were more likely to say they prefer data.</p>
</div>
<div id="bayesian" class="section level4" number="10.2.3.2">
<h4><span class="header-section-number">10.2.3.2</span> Bayesian</h4>
<p>We ran a Bayesian test of association (see Gunel &amp; Dickey, 1974) using version 0.9.12-2 of the BayesFactor package (Morey &amp; Rouder, 2015) using default priors and a joint multinomial sampling plan. The resulting Bayes factor of 3.65 to 1 in favour of the null hypothesis indicates that there is moderately strong evidence for the non-independence of Problem and accuracy.</p>
</div>
</div>
<div id="references" class="section level3" number="10.2.4">
<h3><span class="header-section-number">10.2.4</span> References</h3>

</div>
</div>
<div id="anova-repeated-measures" class="section level2" number="10.3">
<h2><span class="header-section-number">10.3</span> ANOVA repeated measures</h2>
<p>Perform a repeated measures ANOVA and get posthocs</p>
<p><strong>Libraries</strong></p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="Estadistica-inferencial.html#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&#39;yarrr&#39;</span>)) <span class="fu">install.packages</span>(<span class="st">&#39;yarrr&#39;</span>); <span class="fu">library</span>(<span class="st">&#39;yarrr&#39;</span>)</span>
<span id="cb283-2"><a href="Estadistica-inferencial.html#cb283-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&#39;readr&#39;</span>)) <span class="fu">install.packages</span>(<span class="st">&#39;readr&#39;</span>); <span class="fu">library</span>(<span class="st">&#39;readr&#39;</span>)</span>
<span id="cb283-3"><a href="Estadistica-inferencial.html#cb283-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&#39;dplyr&#39;</span>)) <span class="fu">install.packages</span>(<span class="st">&#39;dplyr&#39;</span>); <span class="fu">library</span>(<span class="st">&#39;dplyr&#39;</span>)</span>
<span id="cb283-4"><a href="Estadistica-inferencial.html#cb283-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&#39;ggplot2&#39;</span>)) <span class="fu">install.packages</span>(<span class="st">&#39;ggplot2&#39;</span>); <span class="fu">library</span>(<span class="st">&#39;ggplot2&#39;</span>)</span>
<span id="cb283-5"><a href="Estadistica-inferencial.html#cb283-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&#39;readxl&#39;</span>)) <span class="fu">install.packages</span>(<span class="st">&#39;readxl&#39;</span>); <span class="fu">library</span>(<span class="st">&#39;readxl&#39;</span>)</span>
<span id="cb283-6"><a href="Estadistica-inferencial.html#cb283-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&#39;stringr&#39;</span>)) <span class="fu">install.packages</span>(<span class="st">&#39;stringr&#39;</span>); <span class="fu">library</span>(<span class="st">&#39;stringr&#39;</span>)</span>
<span id="cb283-7"><a href="Estadistica-inferencial.html#cb283-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&#39;afex&#39;</span>)) <span class="fu">install.packages</span>(<span class="st">&#39;afex&#39;</span>); <span class="fu">library</span>(<span class="st">&#39;afex&#39;</span>)</span>
<span id="cb283-8"><a href="Estadistica-inferencial.html#cb283-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&#39;emmeans&#39;</span>)) <span class="fu">install.packages</span>(<span class="st">&#39;emmeans&#39;</span>); <span class="fu">library</span>(<span class="st">&#39;emmeans&#39;</span>)</span></code></pre></div>
<p><strong>Import data</strong><br />
We use the following <a href="Data/08-Data_analysis/ANOVA_repeated_measures.xlsx">dataset</a>.</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="Estadistica-inferencial.html#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Import to variable &quot;datos&quot;</span></span>
<span id="cb284-2"><a href="Estadistica-inferencial.html#cb284-2" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">=</span> <span class="fu">read_excel</span>(<span class="st">&quot;Data/08-Data_analysis/ANOVA_repeated_measures.xlsx&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb284-3"><a href="Estadistica-inferencial.html#cb284-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">ID =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>())</span>
<span id="cb284-4"><a href="Estadistica-inferencial.html#cb284-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-5"><a href="Estadistica-inferencial.html#cb284-5" aria-hidden="true" tabindex="-1"></a>datos</span></code></pre></div>
<pre><code>## # A tibble: 29 x 9
##      ENDObch   ENDOacm    ENDObcm   ENDOach    EXObch    EXOacm      EXObcm    EXOach    ID
##        &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt; &lt;int&gt;
##  1 -0.0135    0.00796  -0.00172    0.000124  0.00333  -0.000877  0.00320    -0.00277      1
##  2 -0.000757  0.000135  0.0109    -0.00440   0.0225   -0.0255    0.00522    -0.00668      2
##  3 -0.00216   0.00189   0.00140    0.000244 -0.000969 -0.000520 -0.00143     0.00189      3
##  4 -0.00213   0.00170   0.00795   -0.000956  0.00196   0.000104 -0.00345     0.000901     4
##  5 -0.00141  -0.000902  0.00116   -0.000691 -0.000855 -0.00173  -0.0136      0.00631      5
##  6  0.00317  -0.00163   0.00140   -0.00354  -0.00176  -0.00150  -0.00000849  0.00357      6
##  7 -0.00344  -0.000572 -0.00702    0.00340   0.0109   -0.00572   0.00924    -0.00199      7
##  8 -0.00381   0.00549   0.000432  -0.00336   0.00984  -0.0110   -0.00483     0.00447      8
##  9 -0.000304 -0.000464 -0.0107     0.00758  -0.00467   0.00479  -0.00555     0.00364      9
## 10 -0.00160   0.000849  0.0000695  0.000265  0.00428  -0.00372   0.00597     0.00157     10
## # … with 19 more rows</code></pre>
<hr />
<p><strong>EXPERIMENT DESIGN</strong><br />
2 x 2 x 2 - Repeated measures</p>
<ul>
<li>VI1 = ENDO / EXO</li>
<li>VI2 = Temporal windows (bc - before change vs ac - after change)</li>
<li>VI3 = Percepts (h - horse vs m - morse)</li>
</ul>
<hr />
<p><strong>Prepare data</strong></p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="Estadistica-inferencial.html#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wide to Long</span></span>
<span id="cb286-2"><a href="Estadistica-inferencial.html#cb286-2" aria-hidden="true" tabindex="-1"></a>datos_long <span class="ot">=</span> datos <span class="sc">%&gt;%</span> <span class="fu">gather</span>(Condicion, VD, <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>)</span>
<span id="cb286-3"><a href="Estadistica-inferencial.html#cb286-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-4"><a href="Estadistica-inferencial.html#cb286-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-5"><a href="Estadistica-inferencial.html#cb286-5" aria-hidden="true" tabindex="-1"></a><span class="co"># We extract conditions from Condicion column. Convert char variables to factor</span></span>
<span id="cb286-6"><a href="Estadistica-inferencial.html#cb286-6" aria-hidden="true" tabindex="-1"></a>datos_long <span class="ot">=</span> datos_long <span class="sc">%&gt;%</span></span>
<span id="cb286-7"><a href="Estadistica-inferencial.html#cb286-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">VI1 =</span> <span class="fu">str_sub</span>(datos_long<span class="sc">$</span>Condicion, <span class="dv">1</span>,<span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb286-8"><a href="Estadistica-inferencial.html#cb286-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">VI2 =</span> </span>
<span id="cb286-9"><a href="Estadistica-inferencial.html#cb286-9" aria-hidden="true" tabindex="-1"></a>           <span class="fu">ifelse</span>(VI1 <span class="sc">==</span> <span class="st">&quot;END&quot;</span>, </span>
<span id="cb286-10"><a href="Estadistica-inferencial.html#cb286-10" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">str_sub</span>(datos_long<span class="sc">$</span>Condicion, <span class="dv">5</span>,<span class="dv">6</span>), </span>
<span id="cb286-11"><a href="Estadistica-inferencial.html#cb286-11" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">str_sub</span>(datos_long<span class="sc">$</span>Condicion, <span class="dv">4</span>,<span class="dv">5</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb286-12"><a href="Estadistica-inferencial.html#cb286-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">VI3 =</span> </span>
<span id="cb286-13"><a href="Estadistica-inferencial.html#cb286-13" aria-hidden="true" tabindex="-1"></a>           <span class="fu">ifelse</span>(VI1 <span class="sc">==</span> <span class="st">&quot;END&quot;</span>, </span>
<span id="cb286-14"><a href="Estadistica-inferencial.html#cb286-14" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">str_sub</span>(datos_long<span class="sc">$</span>Condicion, <span class="dv">7</span>,<span class="dv">7</span>), </span>
<span id="cb286-15"><a href="Estadistica-inferencial.html#cb286-15" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">str_sub</span>(datos_long<span class="sc">$</span>Condicion, <span class="dv">6</span>,<span class="dv">6</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb286-16"><a href="Estadistica-inferencial.html#cb286-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">VI1 =</span> <span class="fu">as.factor</span>(VI1)) <span class="sc">%&gt;%</span></span>
<span id="cb286-17"><a href="Estadistica-inferencial.html#cb286-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">VI2 =</span> <span class="fu">as.factor</span>(VI2)) <span class="sc">%&gt;%</span></span>
<span id="cb286-18"><a href="Estadistica-inferencial.html#cb286-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">VI3 =</span> <span class="fu">as.factor</span>(VI3)) <span class="sc">%&gt;%</span></span>
<span id="cb286-19"><a href="Estadistica-inferencial.html#cb286-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Condicion =</span> <span class="fu">as.factor</span>(Condicion))</span>
<span id="cb286-20"><a href="Estadistica-inferencial.html#cb286-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-21"><a href="Estadistica-inferencial.html#cb286-21" aria-hidden="true" tabindex="-1"></a>datos_long</span></code></pre></div>
<pre><code>## # A tibble: 232 x 6
##       ID Condicion        VD VI1   VI2   VI3  
##    &lt;int&gt; &lt;fct&gt;         &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;
##  1     1 ENDObch   -0.0135   END   bc    h    
##  2     2 ENDObch   -0.000757 END   bc    h    
##  3     3 ENDObch   -0.00216  END   bc    h    
##  4     4 ENDObch   -0.00213  END   bc    h    
##  5     5 ENDObch   -0.00141  END   bc    h    
##  6     6 ENDObch    0.00317  END   bc    h    
##  7     7 ENDObch   -0.00344  END   bc    h    
##  8     8 ENDObch   -0.00381  END   bc    h    
##  9     9 ENDObch   -0.000304 END   bc    h    
## 10    10 ENDObch   -0.00160  END   bc    h    
## # … with 222 more rows</code></pre>
<p>Repeated measures ANOVA</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="Estadistica-inferencial.html#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AFEX PACKAGE</span></span>
<span id="cb288-2"><a href="Estadistica-inferencial.html#cb288-2" aria-hidden="true" tabindex="-1"></a><span class="co"># https://cran.r-project.org/web/packages/afex/afex.pdf</span></span>
<span id="cb288-3"><a href="Estadistica-inferencial.html#cb288-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-4"><a href="Estadistica-inferencial.html#cb288-4" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">aov_ez</span>(<span class="st">&quot;ID&quot;</span>, <span class="st">&quot;VD&quot;</span>, datos_long,</span>
<span id="cb288-5"><a href="Estadistica-inferencial.html#cb288-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">within =</span> <span class="fu">c</span>(<span class="st">&quot;VI1&quot;</span>, <span class="st">&quot;VI2&quot;</span>, <span class="st">&quot;VI3&quot;</span>))</span>
<span id="cb288-6"><a href="Estadistica-inferencial.html#cb288-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-7"><a href="Estadistica-inferencial.html#cb288-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Show results</span></span>
<span id="cb288-8"><a href="Estadistica-inferencial.html#cb288-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(a)</span></code></pre></div>
<pre><code>## 
## Univariate Type III Repeated-Measures ANOVA Assuming Sphericity
## 
##                 Sum Sq num Df   Error SS den Df F value   Pr(&gt;F)   
## (Intercept) 0.00000013      1 0.00014494     28  0.0251 0.875310   
## VI1         0.00001238      1 0.00022796     28  1.5210 0.227715   
## VI2         0.00001502      1 0.00147081     28  0.2859 0.597112   
## VI3         0.00004282      1 0.00089968     28  1.3327 0.258083   
## VI1:VI2     0.00045494      1 0.00125821     28 10.1241 0.003565 **
## VI1:VI3     0.00028700      1 0.00113938     28  7.0531 0.012911 * 
## VI2:VI3     0.00000883      1 0.00010388     28  2.3811 0.134039   
## VI1:VI2:VI3 0.00000323      1 0.00015865     28  0.5709 0.456198   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="Estadistica-inferencial.html#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot results</span></span>
<span id="cb290-2"><a href="Estadistica-inferencial.html#cb290-2" aria-hidden="true" tabindex="-1"></a>emmeans<span class="sc">::</span><span class="fu">lsmip</span>(a, VI1 <span class="sc">~</span> VI2 <span class="sc">*</span> VI3)</span></code></pre></div>
<p><img src="_main_images/anova_afex_repeated_measures-1.png" width="672" /></p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="Estadistica-inferencial.html#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pirateplot</span>(VD <span class="sc">~</span> VI1 <span class="sc">*</span> VI2 <span class="sc">*</span> VI3, datos_long)</span></code></pre></div>
<p><img src="_main_images/anova_afex_repeated_measures-2.png" width="672" /></p>
<p>Post-hocs</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="Estadistica-inferencial.html#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lsmeans</span>(a, <span class="fu">c</span>(<span class="st">&quot;VI1&quot;</span>, <span class="st">&quot;VI2&quot;</span>, <span class="st">&quot;VI3&quot;</span>), <span class="at">contr =</span> <span class="st">&quot;pairwise&quot;</span>)</span></code></pre></div>
<pre><code>## $lsmeans
##  VI1 VI2 VI3    lsmean       SE  df  lower.CL  upper.CL
##  END ac  h    1.71e-04 0.000912 137 -0.001632  0.001975
##  EXO ac  h   -1.79e-04 0.000912 137 -0.001982  0.001625
##  END bc  h   -3.76e-03 0.000912 137 -0.005568 -0.001961
##  EXO bc  h    1.96e-03 0.000912 137  0.000155  0.003762
##  END ac  m    2.63e-03 0.000912 137  0.000825  0.004432
##  EXO ac  m   -1.70e-03 0.000912 137 -0.003502  0.000105
##  END bc  m   -5.43e-05 0.000912 137 -0.001858  0.001749
##  EXO bc  m    7.48e-04 0.000912 137 -0.001056  0.002551
## 
## Warning: EMMs are biased unless design is perfectly balanced 
## Confidence level used: 0.95 
## 
## $contrasts
##  contrast             estimate      SE    df t.ratio p.value
##  END ac h - EXO ac h  0.000350 0.00131  73.4  0.268  1.0000 
##  END ac h - END bc h  0.003936 0.00136  66.2  2.900  0.0890 
##  END ac h - EXO bc h -0.001787 0.00135  68.8 -1.328  0.8850 
##  END ac h - END ac m -0.002457 0.00119  69.2 -2.064  0.4479 
##  END ac h - EXO ac m  0.001870 0.00124  70.7  1.510  0.7996 
##  END ac h - END bc m  0.000226 0.00171 108.7  0.132  1.0000 
##  END ac h - EXO bc m -0.000576 0.00130  69.8 -0.442  0.9998 
##  EXO ac h - END bc h  0.003586 0.00135  68.8  2.664  0.1517 
##  EXO ac h - EXO bc h -0.002138 0.00136  66.2 -1.575  0.7631 
##  EXO ac h - END ac m -0.002808 0.00124  70.7 -2.268  0.3259 
##  EXO ac h - EXO ac m  0.001519 0.00119  69.2  1.276  0.9045 
##  EXO ac h - END bc m -0.000125 0.00130  69.8 -0.096  1.0000 
##  EXO ac h - EXO bc m -0.000927 0.00171 108.7 -0.541  0.9994 
##  END bc h - EXO bc h -0.005723 0.00131  73.4 -4.371  0.0010 
##  END bc h - END ac m -0.006393 0.00171 108.7 -3.731  0.0071 
##  END bc h - EXO ac m -0.002066 0.00130  69.8 -1.586  0.7570 
##  END bc h - END bc m -0.003710 0.00119  69.2 -3.117  0.0512 
##  END bc h - EXO bc m -0.004512 0.00124  70.7 -3.644  0.0113 
##  EXO bc h - END ac m -0.000670 0.00130  69.8 -0.514  0.9996 
##  EXO bc h - EXO ac m  0.003657 0.00171 108.7  2.134  0.4000 
##  EXO bc h - END bc m  0.002013 0.00124  70.7  1.626  0.7332 
##  EXO bc h - EXO bc m  0.001211 0.00119  69.2  1.017  0.9703 
##  END ac m - EXO ac m  0.004327 0.00131  73.4  3.305  0.0302 
##  END ac m - END bc m  0.002683 0.00136  66.2  1.977  0.5049 
##  END ac m - EXO bc m  0.001881 0.00135  68.8  1.397  0.8553 
##  EXO ac m - END bc m -0.001644 0.00135  68.8 -1.221  0.9228 
##  EXO ac m - EXO bc m -0.002446 0.00136  66.2 -1.802  0.6209 
##  END bc m - EXO bc m -0.000802 0.00131  73.4 -0.613  0.9986 
## 
## P value adjustment: tukey method for comparing a family of 8 estimates</code></pre>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="Estadistica-inferencial.html#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lsmeans</span>(a, <span class="st">&quot;VI1&quot;</span>, <span class="at">contr =</span> <span class="st">&quot;pairwise&quot;</span>)</span></code></pre></div>
<pre><code>## NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre><code>## $lsmeans
##  VI1    lsmean      SE   df  lower.CL upper.CL
##  END -0.000255 0.00024 53.4 -0.000735 0.000226
##  EXO  0.000207 0.00024 53.4 -0.000273 0.000688
## 
## Results are averaged over the levels of: VI2, VI3 
## Warning: EMMs are biased unless design is perfectly balanced 
## Confidence level used: 0.95 
## 
## $contrasts
##  contrast   estimate       SE df t.ratio p.value
##  END - EXO -0.000462 0.000375 28 -1.233  0.2277 
## 
## Results are averaged over the levels of: VI2, VI3</code></pre>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="Estadistica-inferencial.html#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lsmeans</span>(a, <span class="st">&quot;VI2&quot;</span>, <span class="at">contr =</span> <span class="st">&quot;pairwise&quot;</span>)</span></code></pre></div>
<pre><code>## NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre><code>## $lsmeans
##  VI2    lsmean       SE   df  lower.CL upper.CL
##  ac   0.000231 0.000499 33.5 -0.000783 0.001245
##  bc  -0.000278 0.000499 33.5 -0.001292 0.000736
## 
## Results are averaged over the levels of: VI1, VI3 
## Warning: EMMs are biased unless design is perfectly balanced 
## Confidence level used: 0.95 
## 
## $contrasts
##  contrast estimate       SE df t.ratio p.value
##  ac - bc  0.000509 0.000952 28 0.535   0.5971 
## 
## Results are averaged over the levels of: VI1, VI3</code></pre>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="Estadistica-inferencial.html#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lsmeans</span>(a, <span class="st">&quot;VI3&quot;</span>, <span class="at">contr =</span> <span class="st">&quot;pairwise&quot;</span>)</span></code></pre></div>
<pre><code>## NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre><code>## $lsmeans
##  VI3    lsmean       SE   df  lower.CL upper.CL
##  h   -0.000453 0.000401 36.8 -0.001266 0.000359
##  m    0.000406 0.000401 36.8 -0.000407 0.001219
## 
## Results are averaged over the levels of: VI1, VI2 
## Warning: EMMs are biased unless design is perfectly balanced 
## Confidence level used: 0.95 
## 
## $contrasts
##  contrast  estimate       SE df t.ratio p.value
##  h - m    -0.000859 0.000744 28 -1.154  0.2581 
## 
## Results are averaged over the levels of: VI1, VI2</code></pre>

</div>
<div id="mixed-models" class="section level2" number="10.4">
<h2><span class="header-section-number">10.4</span> Mixed Models</h2>
<p>VER NOTAS EN: “R_Statistics_Manual/NOT_FOR_GITHUB/Specific tests/lme4/GLMER Notes.md”</p>
<p>Ejemplo analisis en: /<a href="mailto:home/emrys/gorkang@gmail.com/RESEARCH/PROYECTOS/A1-1_WRITING/Lorena" class="email">home/emrys/gorkang@gmail.com/RESEARCH/PROYECTOS/A1-1_WRITING/Lorena</a> - David - Gorka/Analisis de datos - Lorena - PAPER 2/dev/analisis-finales_DEV.R</p>
<div id="reading-list" class="section level3" number="10.4.1">
<h3><span class="header-section-number">10.4.1</span> Reading list</h3>
<p><a href="https://ademos.people.uic.edu/Chapter17.html" class="uri">https://ademos.people.uic.edu/Chapter17.html</a></p>
<p>Contrast coding:</p>
<ul>
<li><a href="https://stats.idre.ucla.edu/r/library/r-library-contrast-coding-systems-for-categorical-variables/" class="uri">https://stats.idre.ucla.edu/r/library/r-library-contrast-coding-systems-for-categorical-variables/</a></li>
<li><strong><u>Dummy coding vs contrast coding</u>: <a href="http://www.lrdc.pitt.edu/maplelab/slides/Simple_Main_Effects_Fraundorf.pdf" class="uri">http://www.lrdc.pitt.edu/maplelab/slides/Simple_Main_Effects_Fraundorf.pdf</a></strong></li>
<li><a href="https://pagepiccinini.com/2016/03/18/contrast-coding-with-three-level-variables/" class="uri">https://pagepiccinini.com/2016/03/18/contrast-coding-with-three-level-variables/</a></li>
</ul>
<p><strong>General</strong>:</p>
<ul>
<li><a href="https://bbolker.github.io/mixedmodels-misc/glmmFAQ.html" class="uri">https://bbolker.github.io/mixedmodels-misc/glmmFAQ.html</a></li>
<li><a href="https://github.com/lme4/lme4/issues" class="uri">https://github.com/lme4/lme4/issues</a></li>
</ul>
<p>Other</p>
<ul>
<li><a href="http://mfviz.com/hierarchical-models/" class="uri">http://mfviz.com/hierarchical-models/</a></li>
</ul>

</div>
</div>
<div id="meta-analysis" class="section level2" number="10.5">
<h2><span class="header-section-number">10.5</span> Meta analysis</h2>
<p>Code adapted from an example sent by Miro on 20170509</p>
<hr />
<p>Meta-analysis of Brase, G. L., &amp; Hill, W. T. (2017). Adding up to good Bayesian reasoning: Problem format manipulations and individual skill differences. Journal of Experimental Psychology: General, 146(4), 577–591. <a href="http://doi.org/10.1037/xge0000280" class="uri">http://doi.org/10.1037/xge0000280</a></p>
<hr />
<p><strong>Factorial 2x2 design (aggreagted data from Experiment1 &amp; Experiment2)</strong></p>
<p>IV1: Representation format (Natural Frequencies x Probabilities)<br />
IV2: Pictorial aid (No pictorial aid x Pictorial aid)</p>
<p>Experiment1
<img src="Images/Data_analysis/Meta_analysis/Brase_Experiment_1.png" /></p>
<p>Experiment2
<img src="Images/Data_analysis/Meta_analysis/Brase_Experiment_2.png" /></p>
<p><strong>Libraries</strong></p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="Estadistica-inferencial.html#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&#39;metafor&#39;</span>)) <span class="fu">install.packages</span>(<span class="st">&#39;metafor&#39;</span>); <span class="fu">library</span>(<span class="st">&#39;metafor&#39;</span>)</span></code></pre></div>
<div id="natural-frequencies-effect" class="section level3" number="10.5.1">
<h3><span class="header-section-number">10.5.1</span> Natural Frequencies Effect</h3>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="Estadistica-inferencial.html#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="co"># input of the data from the two experiments, each is featuring two comparison (note: ai to di are corresponding to the 2x2 table, n1i and n2i are row sums)</span></span>
<span id="cb304-2"><a href="Estadistica-inferencial.html#cb304-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-3"><a href="Estadistica-inferencial.html#cb304-3" aria-hidden="true" tabindex="-1"></a>Contrast <span class="ot">=</span> <span class="st">&quot;NF - Perc&quot;</span></span>
<span id="cb304-4"><a href="Estadistica-inferencial.html#cb304-4" aria-hidden="true" tabindex="-1"></a>Comparisons <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Exp 1a No Picture&quot;</span>, <span class="st">&quot;Exp 1b Picture&quot;</span>, <span class="st">&quot;Exp 2a No Picture&quot;</span>,<span class="st">&quot;Exp 2b Picture&quot;</span>)</span>
<span id="cb304-5"><a href="Estadistica-inferencial.html#cb304-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-6"><a href="Estadistica-inferencial.html#cb304-6" aria-hidden="true" tabindex="-1"></a><span class="co"># NF with and without pictures</span></span>
<span id="cb304-7"><a href="Estadistica-inferencial.html#cb304-7" aria-hidden="true" tabindex="-1"></a><span class="co"># E1_NF, E1_NF+Pic, E2_NF, E2_NF+Pic</span></span>
<span id="cb304-8"><a href="Estadistica-inferencial.html#cb304-8" aria-hidden="true" tabindex="-1"></a><span class="co"># (84*.373, 85*.416, 172*.419, 186*.484)</span></span>
<span id="cb304-9"><a href="Estadistica-inferencial.html#cb304-9" aria-hidden="true" tabindex="-1"></a>ai <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="dv">31</span>, <span class="dv">35</span>, <span class="dv">72</span>, <span class="dv">90</span>)</span>
<span id="cb304-10"><a href="Estadistica-inferencial.html#cb304-10" aria-hidden="true" tabindex="-1"></a>n1i <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">84</span>, <span class="dv">85</span>, <span class="dv">172</span>, <span class="dv">186</span>)</span>
<span id="cb304-11"><a href="Estadistica-inferencial.html#cb304-11" aria-hidden="true" tabindex="-1"></a>bi <span class="ot">&lt;-</span> n1i<span class="sc">-</span> ai <span class="co"># c(53, 50, 100, 96)</span></span>
<span id="cb304-12"><a href="Estadistica-inferencial.html#cb304-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-13"><a href="Estadistica-inferencial.html#cb304-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Prob with and without pictures</span></span>
<span id="cb304-14"><a href="Estadistica-inferencial.html#cb304-14" aria-hidden="true" tabindex="-1"></a><span class="co"># E1_Perc, E1_Perc+Pic, E2_Perc, E2_Perc+Pic</span></span>
<span id="cb304-15"><a href="Estadistica-inferencial.html#cb304-15" aria-hidden="true" tabindex="-1"></a><span class="co"># (83*.049, 84*.194, 172*.087, 181*.265)</span></span>
<span id="cb304-16"><a href="Estadistica-inferencial.html#cb304-16" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">16</span>, <span class="dv">15</span>, <span class="dv">48</span>)</span>
<span id="cb304-17"><a href="Estadistica-inferencial.html#cb304-17" aria-hidden="true" tabindex="-1"></a>n2i <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">83</span>, <span class="dv">84</span>, <span class="dv">172</span>, <span class="dv">181</span>)</span>
<span id="cb304-18"><a href="Estadistica-inferencial.html#cb304-18" aria-hidden="true" tabindex="-1"></a>di <span class="ot">&lt;-</span> n2i <span class="sc">-</span> ci <span class="co"># di &lt;- c(79, 68, 157, 133)</span></span>
<span id="cb304-19"><a href="Estadistica-inferencial.html#cb304-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-20"><a href="Estadistica-inferencial.html#cb304-20" aria-hidden="true" tabindex="-1"></a><span class="co"># mod &lt;- c(0, 1, 0, 1)</span></span>
<span id="cb304-21"><a href="Estadistica-inferencial.html#cb304-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-22"><a href="Estadistica-inferencial.html#cb304-22" aria-hidden="true" tabindex="-1"></a><span class="co"># fit the fixed model and return its value for OR</span></span>
<span id="cb304-23"><a href="Estadistica-inferencial.html#cb304-23" aria-hidden="true" tabindex="-1"></a>rma.overallOR <span class="ot">&lt;-</span> <span class="fu">rma.uni</span>(<span class="at">ai=</span>ai, <span class="at">bi=</span>bi, <span class="at">ci=</span>ci, <span class="at">di=</span>di, <span class="at">n1i=</span>n1i, <span class="at">n2i=</span>n2i, <span class="at">measure=</span><span class="st">&quot;OR&quot;</span>, </span>
<span id="cb304-24"><a href="Estadistica-inferencial.html#cb304-24" aria-hidden="true" tabindex="-1"></a>                         <span class="at">method=</span><span class="st">&quot;REML&quot;</span>, <span class="at">weighted=</span><span class="cn">TRUE</span>,</span>
<span id="cb304-25"><a href="Estadistica-inferencial.html#cb304-25" aria-hidden="true" tabindex="-1"></a>                         <span class="at">level=</span><span class="dv">95</span>, <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb304-26"><a href="Estadistica-inferencial.html#cb304-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-27"><a href="Estadistica-inferencial.html#cb304-27" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rma.overallOR)</span></code></pre></div>
<pre><code>## 
## Random-Effects Model (k = 4; tau^2 estimator: REML)
## 
##   logLik  deviance       AIC       BIC      AICc 
##   -3.205     6.410    10.410     8.607    22.410   
## 
## tau^2 (estimated amount of total heterogeneity): 0.339 (SE = 0.382)
## tau (square root of estimated tau^2 value):      0.583
## I^2 (total heterogeneity / total variability):   75.66%
## H^2 (total variability / sampling variability):  4.11
## 
## Test for Heterogeneity:
## Q(df = 3) = 12.128, p-val = 0.007
## 
## Model Results:
## 
## estimate     se   zval   pval  ci.lb  ci.ub 
##    1.542  0.342  4.507  &lt;.001  0.871  2.213  *** 
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="Estadistica-inferencial.html#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rma.overallOR</span></span>
<span id="cb306-2"><a href="Estadistica-inferencial.html#cb306-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-3"><a href="Estadistica-inferencial.html#cb306-3" aria-hidden="true" tabindex="-1"></a><span class="fu">forest</span>(rma.overallOR, </span>
<span id="cb306-4"><a href="Estadistica-inferencial.html#cb306-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">showweight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb306-5"><a href="Estadistica-inferencial.html#cb306-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">slab=</span>Comparisons, </span>
<span id="cb306-6"><a href="Estadistica-inferencial.html#cb306-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab=</span><span class="st">&quot;Log Odds Ratio&quot;</span>, <span class="at">mlab=</span><span class="st">&quot;FE Model for All Comparisons&quot;</span>, <span class="at">main =</span> Contrast )</span></code></pre></div>
<p><img src="_main_images/08-10-Meta_analysis-2-1.png" width="672" /></p>
</div>
<div id="pictures-effect" class="section level3" number="10.5.2">
<h3><span class="header-section-number">10.5.2</span> Pictures Effect</h3>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="Estadistica-inferencial.html#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="co"># input of the data from the two experiments, each is featuring two comparison (note: ai to di are corresponding to the 2x2 table, n1i and n2i are row sums)</span></span>
<span id="cb307-2"><a href="Estadistica-inferencial.html#cb307-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Here we use the parameter mod to assess moderation (???)</span></span>
<span id="cb307-3"><a href="Estadistica-inferencial.html#cb307-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-4"><a href="Estadistica-inferencial.html#cb307-4" aria-hidden="true" tabindex="-1"></a>Contrast <span class="ot">=</span> <span class="st">&quot;Pictures - No pictures&quot;</span></span>
<span id="cb307-5"><a href="Estadistica-inferencial.html#cb307-5" aria-hidden="true" tabindex="-1"></a>Comparisons <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Exp 1a Perc&quot;</span>, <span class="st">&quot;Exp 1b NF&quot;</span>, <span class="st">&quot;Exp 2a Perc&quot;</span>,<span class="st">&quot;Exp 2b NF&quot;</span>)</span>
<span id="cb307-6"><a href="Estadistica-inferencial.html#cb307-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-7"><a href="Estadistica-inferencial.html#cb307-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-8"><a href="Estadistica-inferencial.html#cb307-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Prob and  NF with Pictures</span></span>
<span id="cb307-9"><a href="Estadistica-inferencial.html#cb307-9" aria-hidden="true" tabindex="-1"></a><span class="co"># E1_Perc+Pic, E1_NF+Pic, E2_Perc+Pic, E2_NF+Pic</span></span>
<span id="cb307-10"><a href="Estadistica-inferencial.html#cb307-10" aria-hidden="true" tabindex="-1"></a><span class="co"># (84*.194,   85*.416,  181*.265, 186*.484)</span></span>
<span id="cb307-11"><a href="Estadistica-inferencial.html#cb307-11" aria-hidden="true" tabindex="-1"></a>ai <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">35</span>, <span class="dv">48</span>, <span class="dv">90</span>)</span>
<span id="cb307-12"><a href="Estadistica-inferencial.html#cb307-12" aria-hidden="true" tabindex="-1"></a>n1i <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">84</span>, <span class="dv">85</span>, <span class="dv">181</span>, <span class="dv">186</span>)</span>
<span id="cb307-13"><a href="Estadistica-inferencial.html#cb307-13" aria-hidden="true" tabindex="-1"></a>bi <span class="ot">&lt;-</span> n1i<span class="sc">-</span> ai <span class="co"># bi &lt;- c(68, 50, 133, 96)</span></span>
<span id="cb307-14"><a href="Estadistica-inferencial.html#cb307-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-15"><a href="Estadistica-inferencial.html#cb307-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Prob and  NF without Pictures</span></span>
<span id="cb307-16"><a href="Estadistica-inferencial.html#cb307-16" aria-hidden="true" tabindex="-1"></a><span class="co"># E1_Perc, E1_NF, E2_Perc , E2_NF</span></span>
<span id="cb307-17"><a href="Estadistica-inferencial.html#cb307-17" aria-hidden="true" tabindex="-1"></a><span class="co"># (83*.049,   84*.373,  172*.087, 172*.419)</span></span>
<span id="cb307-18"><a href="Estadistica-inferencial.html#cb307-18" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">31</span>, <span class="dv">15</span>, <span class="dv">72</span>)</span>
<span id="cb307-19"><a href="Estadistica-inferencial.html#cb307-19" aria-hidden="true" tabindex="-1"></a>n2i <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">83</span>, <span class="dv">84</span>, <span class="dv">172</span>, <span class="dv">172</span>)</span>
<span id="cb307-20"><a href="Estadistica-inferencial.html#cb307-20" aria-hidden="true" tabindex="-1"></a>di <span class="ot">&lt;-</span> n2i <span class="sc">-</span> ci <span class="co"># di &lt;- c(79, 53, 157, 100)</span></span>
<span id="cb307-21"><a href="Estadistica-inferencial.html#cb307-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-22"><a href="Estadistica-inferencial.html#cb307-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-23"><a href="Estadistica-inferencial.html#cb307-23" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb307-24"><a href="Estadistica-inferencial.html#cb307-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-25"><a href="Estadistica-inferencial.html#cb307-25" aria-hidden="true" tabindex="-1"></a><span class="co"># fit the fixed model and return its value for OR</span></span>
<span id="cb307-26"><a href="Estadistica-inferencial.html#cb307-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Here we use the moderator mod</span></span>
<span id="cb307-27"><a href="Estadistica-inferencial.html#cb307-27" aria-hidden="true" tabindex="-1"></a>rma.overallOR <span class="ot">&lt;-</span> <span class="fu">rma.uni</span>(<span class="at">ai=</span>ai, <span class="at">bi=</span>bi, <span class="at">ci=</span>ci, <span class="at">di=</span>di, <span class="at">n1i=</span>n1i, <span class="at">n2i=</span>n2i, <span class="at">mod=</span>mod, <span class="at">measure=</span><span class="st">&quot;OR&quot;</span>, </span>
<span id="cb307-28"><a href="Estadistica-inferencial.html#cb307-28" aria-hidden="true" tabindex="-1"></a>                         <span class="at">method=</span><span class="st">&quot;REML&quot;</span>, <span class="at">weighted=</span>T,</span>
<span id="cb307-29"><a href="Estadistica-inferencial.html#cb307-29" aria-hidden="true" tabindex="-1"></a>                         <span class="at">level=</span><span class="dv">95</span>, <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb307-30"><a href="Estadistica-inferencial.html#cb307-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-31"><a href="Estadistica-inferencial.html#cb307-31" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rma.overallOR)</span></code></pre></div>
<pre><code>## 
## Mixed-Effects Model (k = 4; tau^2 estimator: REML)
## 
##   logLik  deviance       AIC       BIC      AICc 
##    0.156    -0.313     5.687     1.767    29.687   
## 
## tau^2 (estimated amount of residual heterogeneity):     0 (SE = 0.097)
## tau (square root of estimated tau^2 value):             0
## I^2 (residual heterogeneity / unaccounted variability): 0.00%
## H^2 (unaccounted variability / sampling variability):   1.00
## R^2 (amount of heterogeneity accounted for):            100.00%
## 
## Test for Residual Heterogeneity:
## QE(df = 2) = 0.146, p-val = 0.929
## 
## Test of Moderators (coefficient 2):
## QM(df = 1) = 11.872, p-val &lt; .001
## 
## Model Results:
## 
##          estimate     se    zval   pval   ci.lb   ci.ub 
## intrcpt     1.377  0.279   4.926  &lt;.001   0.829   1.924  *** 
## mods       -1.139  0.331  -3.446  &lt;.001  -1.787  -0.491  *** 
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="Estadistica-inferencial.html#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rma.overallOR</span></span>
<span id="cb309-2"><a href="Estadistica-inferencial.html#cb309-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb309-3"><a href="Estadistica-inferencial.html#cb309-3" aria-hidden="true" tabindex="-1"></a><span class="fu">forest</span>(rma.overallOR, </span>
<span id="cb309-4"><a href="Estadistica-inferencial.html#cb309-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">showweight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb309-5"><a href="Estadistica-inferencial.html#cb309-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">slab=</span> Comparisons, </span>
<span id="cb309-6"><a href="Estadistica-inferencial.html#cb309-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab=</span><span class="st">&quot;Log Odds Ratio&quot;</span>, <span class="at">mlab=</span><span class="st">&quot;REML Model for All Comparisons&quot;</span>, <span class="at">main =</span> Contrast)</span></code></pre></div>
<p><img src="_main_images/08-10-Meta_analysis-3-1.png" width="672" /></p>
</div>
<div id="notes-on-meta-analysis" class="section level3" number="10.5.3">
<h3><span class="header-section-number">10.5.3</span> Notes on Meta-analysis</h3>
<p><a href="http://www.nicebread.de/meta-showdown-1/" class="uri">http://www.nicebread.de/meta-showdown-1/</a></p>

</div>
</div>
<div id="roc-curves" class="section level2" number="10.6">
<h2><span class="header-section-number">10.6</span> ROC Curves</h2>
<p>Code from <a href="https://github.com/dariyasydykova/tidyroc" class="uri">https://github.com/dariyasydykova/tidyroc</a> README</p>
<p>tidyroc won’t be developed further. It seems <a href="https://github.com/tidymodels/yardstick" class="uri">https://github.com/tidymodels/yardstick</a> does everything tidyroc does and more?</p>
<p>Intro about what ROC curves measure: <a href="https://twitter.com/cecilejanssens/status/1104134423673479169?s=03" class="uri">https://twitter.com/cecilejanssens/status/1104134423673479169?s=03</a></p>
<p>Why ROC curves are misleading: <a href="http://www.fharrell.com/post/mlconfusion/" class="uri">http://www.fharrell.com/post/mlconfusion/</a> (Not useful for prediction. PPV/NPV better).</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="Estadistica-inferencial.html#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&#39;tidyroc&#39;</span>)) remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;dariyasydykova/tidyroc&quot;</span>); <span class="fu">library</span>(<span class="st">&#39;tidyroc&#39;</span>)</span>
<span id="cb310-2"><a href="Estadistica-inferencial.html#cb310-2" aria-hidden="true" tabindex="-1"></a><span class="co"># remotes::install_github(&quot;dariyasydykova/tidyroc&quot;)</span></span>
<span id="cb310-3"><a href="Estadistica-inferencial.html#cb310-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb310-4"><a href="Estadistica-inferencial.html#cb310-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(dplyr)</span>
<span id="cb310-5"><a href="Estadistica-inferencial.html#cb310-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggplot2)</span>
<span id="cb310-6"><a href="Estadistica-inferencial.html#cb310-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(broom)</span>
<span id="cb310-7"><a href="Estadistica-inferencial.html#cb310-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(tidyroc)</span>
<span id="cb310-8"><a href="Estadistica-inferencial.html#cb310-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb310-9"><a href="Estadistica-inferencial.html#cb310-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(am <span class="sc">~</span> disp,</span>
<span id="cb310-10"><a href="Estadistica-inferencial.html#cb310-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> binomial,</span>
<span id="cb310-11"><a href="Estadistica-inferencial.html#cb310-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> mtcars</span>
<span id="cb310-12"><a href="Estadistica-inferencial.html#cb310-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb310-13"><a href="Estadistica-inferencial.html#cb310-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">augment</span>() <span class="sc">%&gt;%</span></span>
<span id="cb310-14"><a href="Estadistica-inferencial.html#cb310-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">make_roc</span>(<span class="at">predictor =</span> .fitted, <span class="at">known_class =</span> am) <span class="sc">%&gt;%</span></span>
<span id="cb310-15"><a href="Estadistica-inferencial.html#cb310-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> fpr, <span class="at">y =</span> tpr)) <span class="sc">+</span></span>
<span id="cb310-16"><a href="Estadistica-inferencial.html#cb310-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb310-17"><a href="Estadistica-inferencial.html#cb310-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span></code></pre></div>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="Estadistica-inferencial.html#cb311-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># load tidyverse packages</span></span>
<span id="cb311-2"><a href="Estadistica-inferencial.html#cb311-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(dplyr)</span>
<span id="cb311-3"><a href="Estadistica-inferencial.html#cb311-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggplot2)</span>
<span id="cb311-4"><a href="Estadistica-inferencial.html#cb311-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(broom)</span>
<span id="cb311-5"><a href="Estadistica-inferencial.html#cb311-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-6"><a href="Estadistica-inferencial.html#cb311-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># load cowplot to change plot theme</span></span>
<span id="cb311-7"><a href="Estadistica-inferencial.html#cb311-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(cowplot)</span>
<span id="cb311-8"><a href="Estadistica-inferencial.html#cb311-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-9"><a href="Estadistica-inferencial.html#cb311-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># load tidyroc</span></span>
<span id="cb311-10"><a href="Estadistica-inferencial.html#cb311-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(tidyroc)</span>
<span id="cb311-11"><a href="Estadistica-inferencial.html#cb311-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-12"><a href="Estadistica-inferencial.html#cb311-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-13"><a href="Estadistica-inferencial.html#cb311-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get `biopsy` dataset from `MASS`</span></span>
<span id="cb311-14"><a href="Estadistica-inferencial.html#cb311-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data</span>(biopsy, <span class="at">package =</span> <span class="st">&quot;MASS&quot;</span>)</span>
<span id="cb311-15"><a href="Estadistica-inferencial.html#cb311-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-16"><a href="Estadistica-inferencial.html#cb311-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># change column names from `V1`, `V2`, etc. to informative variable names</span></span>
<span id="cb311-17"><a href="Estadistica-inferencial.html#cb311-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(biopsy) <span class="ot">&lt;-</span></span>
<span id="cb311-18"><a href="Estadistica-inferencial.html#cb311-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;ID&quot;</span>,</span>
<span id="cb311-19"><a href="Estadistica-inferencial.html#cb311-19" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;clump_thickness&quot;</span>,</span>
<span id="cb311-20"><a href="Estadistica-inferencial.html#cb311-20" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;uniform_cell_size&quot;</span>,</span>
<span id="cb311-21"><a href="Estadistica-inferencial.html#cb311-21" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;uniform_cell_shape&quot;</span>,</span>
<span id="cb311-22"><a href="Estadistica-inferencial.html#cb311-22" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;marg_adhesion&quot;</span>,</span>
<span id="cb311-23"><a href="Estadistica-inferencial.html#cb311-23" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;epithelial_cell_size&quot;</span>,</span>
<span id="cb311-24"><a href="Estadistica-inferencial.html#cb311-24" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;bare_nuclei&quot;</span>,</span>
<span id="cb311-25"><a href="Estadistica-inferencial.html#cb311-25" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;bland_chromatin&quot;</span>,</span>
<span id="cb311-26"><a href="Estadistica-inferencial.html#cb311-26" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;normal_nucleoli&quot;</span>,</span>
<span id="cb311-27"><a href="Estadistica-inferencial.html#cb311-27" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;mitoses&quot;</span>,</span>
<span id="cb311-28"><a href="Estadistica-inferencial.html#cb311-28" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;outcome&quot;</span>)</span>
<span id="cb311-29"><a href="Estadistica-inferencial.html#cb311-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-30"><a href="Estadistica-inferencial.html#cb311-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fit a logistic regression model to predict tumor types</span></span>
<span id="cb311-31"><a href="Estadistica-inferencial.html#cb311-31" aria-hidden="true" tabindex="-1"></a>  glm_out1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb311-32"><a href="Estadistica-inferencial.html#cb311-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> outcome <span class="sc">~</span> clump_thickness <span class="sc">+</span> uniform_cell_shape <span class="sc">+</span> marg_adhesion <span class="sc">+</span> bare_nuclei <span class="sc">+</span> bland_chromatin <span class="sc">+</span> normal_nucleoli,</span>
<span id="cb311-33"><a href="Estadistica-inferencial.html#cb311-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> binomial,</span>
<span id="cb311-34"><a href="Estadistica-inferencial.html#cb311-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> biopsy</span>
<span id="cb311-35"><a href="Estadistica-inferencial.html#cb311-35" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb311-36"><a href="Estadistica-inferencial.html#cb311-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">augment</span>() <span class="sc">%&gt;%</span></span>
<span id="cb311-37"><a href="Estadistica-inferencial.html#cb311-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;m1&quot;</span>) <span class="co"># name the model</span></span>
<span id="cb311-38"><a href="Estadistica-inferencial.html#cb311-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-39"><a href="Estadistica-inferencial.html#cb311-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fit a different logistic regression model to predict tumor types</span></span>
<span id="cb311-40"><a href="Estadistica-inferencial.html#cb311-40" aria-hidden="true" tabindex="-1"></a>  glm_out2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(outcome <span class="sc">~</span> clump_thickness,</span>
<span id="cb311-41"><a href="Estadistica-inferencial.html#cb311-41" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> binomial,</span>
<span id="cb311-42"><a href="Estadistica-inferencial.html#cb311-42" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> biopsy</span>
<span id="cb311-43"><a href="Estadistica-inferencial.html#cb311-43" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb311-44"><a href="Estadistica-inferencial.html#cb311-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">augment</span>() <span class="sc">%&gt;%</span></span>
<span id="cb311-45"><a href="Estadistica-inferencial.html#cb311-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;m2&quot;</span>) <span class="co"># name the model</span></span>
<span id="cb311-46"><a href="Estadistica-inferencial.html#cb311-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-47"><a href="Estadistica-inferencial.html#cb311-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># combine the two datasets to make an ROC curve for each model</span></span>
<span id="cb311-48"><a href="Estadistica-inferencial.html#cb311-48" aria-hidden="true" tabindex="-1"></a>  glm_out <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(glm_out1, glm_out2)</span>
<span id="cb311-49"><a href="Estadistica-inferencial.html#cb311-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-50"><a href="Estadistica-inferencial.html#cb311-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot the distribution of fitted values to see both models&#39; outcomes</span></span>
<span id="cb311-51"><a href="Estadistica-inferencial.html#cb311-51" aria-hidden="true" tabindex="-1"></a>  glm_out <span class="sc">%&gt;%</span></span>
<span id="cb311-52"><a href="Estadistica-inferencial.html#cb311-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">fill =</span> outcome)) <span class="sc">+</span></span>
<span id="cb311-53"><a href="Estadistica-inferencial.html#cb311-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb311-54"><a href="Estadistica-inferencial.html#cb311-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#F08A5D&quot;</span>, <span class="st">&quot;#B83B5E&quot;</span>)) <span class="sc">+</span></span>
<span id="cb311-55"><a href="Estadistica-inferencial.html#cb311-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> model)</span>
<span id="cb311-56"><a href="Estadistica-inferencial.html#cb311-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-57"><a href="Estadistica-inferencial.html#cb311-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-58"><a href="Estadistica-inferencial.html#cb311-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot ROC curves</span></span>
<span id="cb311-59"><a href="Estadistica-inferencial.html#cb311-59" aria-hidden="true" tabindex="-1"></a>  glm_out <span class="sc">%&gt;%</span></span>
<span id="cb311-60"><a href="Estadistica-inferencial.html#cb311-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span> <span class="co"># group to get individual ROC curve for each model</span></span>
<span id="cb311-61"><a href="Estadistica-inferencial.html#cb311-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">make_roc</span>(<span class="at">predictor =</span> .fitted, <span class="at">known_class =</span> outcome) <span class="sc">%&gt;%</span> <span class="co"># get values to plot an ROC curve</span></span>
<span id="cb311-62"><a href="Estadistica-inferencial.html#cb311-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> fpr, <span class="at">y =</span> tpr, <span class="at">color =</span> model)) <span class="sc">+</span></span>
<span id="cb311-63"><a href="Estadistica-inferencial.html#cb311-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb311-64"><a href="Estadistica-inferencial.html#cb311-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb311-65"><a href="Estadistica-inferencial.html#cb311-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#48466D&quot;</span>, <span class="st">&quot;#3D84A8&quot;</span>)) <span class="sc">+</span></span>
<span id="cb311-66"><a href="Estadistica-inferencial.html#cb311-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_cowplot</span>()</span>
<span id="cb311-67"><a href="Estadistica-inferencial.html#cb311-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-68"><a href="Estadistica-inferencial.html#cb311-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-69"><a href="Estadistica-inferencial.html#cb311-69" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot precision-recall curves using the data-frame we generated in the previous example</span></span>
<span id="cb311-70"><a href="Estadistica-inferencial.html#cb311-70" aria-hidden="true" tabindex="-1"></a>  glm_out <span class="sc">%&gt;%</span></span>
<span id="cb311-71"><a href="Estadistica-inferencial.html#cb311-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span> <span class="co"># group to get individual precision-recall curve for each model</span></span>
<span id="cb311-72"><a href="Estadistica-inferencial.html#cb311-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">make_pr</span>(<span class="at">predictor =</span> .fitted, <span class="at">known_class =</span> outcome) <span class="sc">%&gt;%</span> <span class="co"># get values to plot a precision-recall curve</span></span>
<span id="cb311-73"><a href="Estadistica-inferencial.html#cb311-73" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> recall, <span class="at">y =</span> precision, <span class="at">color =</span> model)) <span class="sc">+</span></span>
<span id="cb311-74"><a href="Estadistica-inferencial.html#cb311-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb311-75"><a href="Estadistica-inferencial.html#cb311-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb311-76"><a href="Estadistica-inferencial.html#cb311-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#48466D&quot;</span>, <span class="st">&quot;#3D84A8&quot;</span>)) <span class="sc">+</span></span>
<span id="cb311-77"><a href="Estadistica-inferencial.html#cb311-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_cowplot</span>()</span>
<span id="cb311-78"><a href="Estadistica-inferencial.html#cb311-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-79"><a href="Estadistica-inferencial.html#cb311-79" aria-hidden="true" tabindex="-1"></a>  glm_out <span class="sc">%&gt;%</span></span>
<span id="cb311-80"><a href="Estadistica-inferencial.html#cb311-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span> <span class="co"># group to get individual AUC values for each ROC curve</span></span>
<span id="cb311-81"><a href="Estadistica-inferencial.html#cb311-81" aria-hidden="true" tabindex="-1"></a>    <span class="fu">make_roc</span>(<span class="at">predictor =</span> .fitted, <span class="at">known_class =</span> outcome) <span class="sc">%&gt;%</span></span>
<span id="cb311-82"><a href="Estadistica-inferencial.html#cb311-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">auc =</span> <span class="fu">calc_auc</span>(<span class="at">x =</span> fpr, <span class="at">y =</span> tpr))</span>
<span id="cb311-83"><a href="Estadistica-inferencial.html#cb311-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-84"><a href="Estadistica-inferencial.html#cb311-84" aria-hidden="true" tabindex="-1"></a>  <span class="do">## # A tibble: 2 x 2</span></span>
<span id="cb311-85"><a href="Estadistica-inferencial.html#cb311-85" aria-hidden="true" tabindex="-1"></a>  <span class="do">##   model   auc</span></span>
<span id="cb311-86"><a href="Estadistica-inferencial.html#cb311-86" aria-hidden="true" tabindex="-1"></a>  <span class="do">##   &lt;chr&gt; &lt;dbl&gt;</span></span>
<span id="cb311-87"><a href="Estadistica-inferencial.html#cb311-87" aria-hidden="true" tabindex="-1"></a>  <span class="do">## 1 m1    0.996</span></span>
<span id="cb311-88"><a href="Estadistica-inferencial.html#cb311-88" aria-hidden="true" tabindex="-1"></a>  <span class="do">## 2 m2    0.910</span></span>
<span id="cb311-89"><a href="Estadistica-inferencial.html#cb311-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-90"><a href="Estadistica-inferencial.html#cb311-90" aria-hidden="true" tabindex="-1"></a>  glm_out <span class="sc">%&gt;%</span></span>
<span id="cb311-91"><a href="Estadistica-inferencial.html#cb311-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span> <span class="co"># group to get individual AUC values for each precision-recall curve</span></span>
<span id="cb311-92"><a href="Estadistica-inferencial.html#cb311-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">make_pr</span>(<span class="at">predictor =</span> .fitted, <span class="at">known_class =</span> outcome) <span class="sc">%&gt;%</span></span>
<span id="cb311-93"><a href="Estadistica-inferencial.html#cb311-93" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">auc =</span> <span class="fu">calc_auc</span>(<span class="at">x =</span> recall, <span class="at">y =</span> precision))</span>
<span id="cb311-94"><a href="Estadistica-inferencial.html#cb311-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-95"><a href="Estadistica-inferencial.html#cb311-95" aria-hidden="true" tabindex="-1"></a>  <span class="do">## # A tibble: 2 x 2</span></span>
<span id="cb311-96"><a href="Estadistica-inferencial.html#cb311-96" aria-hidden="true" tabindex="-1"></a>  <span class="do">##   model   auc</span></span>
<span id="cb311-97"><a href="Estadistica-inferencial.html#cb311-97" aria-hidden="true" tabindex="-1"></a>  <span class="do">##   &lt;chr&gt; &lt;dbl&gt;</span></span>
<span id="cb311-98"><a href="Estadistica-inferencial.html#cb311-98" aria-hidden="true" tabindex="-1"></a>  <span class="do">## 1 m1    0.991</span></span>
<span id="cb311-99"><a href="Estadistica-inferencial.html#cb311-99" aria-hidden="true" tabindex="-1"></a>  <span class="do">## 2 m2    0.951</span></span></code></pre></div>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>Leys, C., Ley, C., Klein, O., Bernard, P. &amp; Licata, L. Detecting outliers: Do not use standard deviation around the mean, use absolute deviation around the median. J. Exp. Soc. Psychol. 49, 764–766 (2013).<a href="Estadistica-inferencial.html#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p><a href="https://www.researchgate.net/post/For_decision_times_do_you_first_take_the_logarithm_and_then_exclude_extreme_outliers_or_the_other_way_around_And_how_do_you_define_outliers">See <strong>Serban C. Musca</strong> post</a><a href="Estadistica-inferencial.html#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Estadistica-descriptiva.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Funciones.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
