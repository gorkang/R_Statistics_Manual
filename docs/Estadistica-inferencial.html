<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>10 Estadistica inferencial | R - Statistics Manual</title>
  <meta name="description" content="Statistics manual from CSCN." />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="10 Estadistica inferencial | R - Statistics Manual" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Statistics manual from CSCN." />
  <meta name="github-repo" content="gorkang/R_Statistics_Manual" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="10 Estadistica inferencial | R - Statistics Manual" />
  
  <meta name="twitter:description" content="Statistics manual from CSCN." />
  

<meta name="author" content="Center for Social and Cognitive Neuroscience - cscn.uai.cl" />


<meta name="date" content="2019-05-31" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Estadistica-descriptiva.html">
<link rel="next" href="Funciones.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/str_view-0.1.0/str_view.css" rel="stylesheet" />
<script src="libs/str_view-binding-1.4.0/str_view.js"></script>
<script src="libs/datatables-binding-0.2.10/datatables.js"></script>
<link href="libs/dt-core-1.10.12/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.12/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.12/js/jquery.dataTables.min.js"></script>
<script src="libs/d3-4.5.0/d3.min.js"></script>
<script src="libs/sankey-1/sankey.js"></script>
<script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#for-users"><i class="fa fa-check"></i><b>1.1</b> For USERS</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#for-developers-and-statisticians"><i class="fa fa-check"></i><b>1.2</b> For Developers and Statisticians</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#contributors"><i class="fa fa-check"></i><b>1.3</b> Contributors</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#todo"><i class="fa fa-check"></i><b>1.4</b> TODO</a><ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#inferential-analysis"><i class="fa fa-check"></i><b>1.4.1</b> Inferential analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Empezando.html"><a href="Empezando.html"><i class="fa fa-check"></i><b>2</b> Empezando en A-B-C</a><ul>
<li class="chapter" data-level="2.1" data-path="Empezando.html"><a href="Empezando.html#a-instalar-r."><i class="fa fa-check"></i><b>2.1</b> <strong>(A)</strong> Instalar R.</a></li>
<li class="chapter" data-level="2.2" data-path="Empezando.html"><a href="Empezando.html#b-instalar-rstudio."><i class="fa fa-check"></i><b>2.2</b> <strong>(B)</strong> Instalar RStudio.</a></li>
<li class="chapter" data-level="2.3" data-path="Empezando.html"><a href="Empezando.html#instalar-packages"><i class="fa fa-check"></i><b>2.3</b> Instalar Packages</a></li>
<li class="chapter" data-level="2.4" data-path="Empezando.html"><a href="Empezando.html#cargar-packages"><i class="fa fa-check"></i><b>2.4</b> Cargar Packages</a></li>
<li class="chapter" data-level="2.5" data-path="Empezando.html"><a href="Empezando.html#todo-en-uno"><i class="fa fa-check"></i><b>2.5</b> Todo en uno</a></li>
<li class="chapter" data-level="2.6" data-path="Empezando.html"><a href="Empezando.html#c-librerias-para-el-workshop"><i class="fa fa-check"></i><b>2.6</b> <strong>(C)</strong> Librerias para el workshop</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="Mi-primer-script.html"><a href="Mi-primer-script.html"><i class="fa fa-check"></i><b>3</b> Mi primer script</a><ul>
<li class="chapter" data-level="3.1" data-path="Mi-primer-script.html"><a href="Mi-primer-script.html#paso-a-paso"><i class="fa fa-check"></i><b>3.1</b> Paso a paso</a></li>
<li class="chapter" data-level="3.2" data-path="Mi-primer-script.html"><a href="Mi-primer-script.html#establecer-nuestro-directorio-de-trabajo"><i class="fa fa-check"></i><b>3.2</b> Establecer nuestro directorio de trabajo</a></li>
<li class="chapter" data-level="3.3" data-path="Mi-primer-script.html"><a href="Mi-primer-script.html#nuestro-primer-script"><i class="fa fa-check"></i><b>3.3</b> Nuestro primer script</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="Conseguir-ayuda.html"><a href="Conseguir-ayuda.html"><i class="fa fa-check"></i><b>4</b> Conseguir ayuda y aprender más</a><ul>
<li class="chapter" data-level="4.1" data-path="Conseguir-ayuda.html"><a href="Conseguir-ayuda.html#cuando-sabemos-que-funcion-usar-pero-dudamos-de-la-sintaxis"><i class="fa fa-check"></i><b>4.1</b> Cuando sabemos que función usar, pero dudamos de la sintaxis:</a></li>
<li class="chapter" data-level="4.2" data-path="Conseguir-ayuda.html"><a href="Conseguir-ayuda.html#cuando-sabemos-lo-que-queremos-hacer-pero-no-la-funcion-que-debemos-usar"><i class="fa fa-check"></i><b>4.2</b> Cuando sabemos lo que queremos hacer pero no la función que debemos usar:</a></li>
<li class="chapter" data-level="4.3" data-path="Conseguir-ayuda.html"><a href="Conseguir-ayuda.html#libros-y-web-recomendados"><i class="fa fa-check"></i><b>4.3</b> Libros y Web recomendados</a><ul>
<li class="chapter" data-level="4.3.1" data-path="Conseguir-ayuda.html"><a href="Conseguir-ayuda.html#hadley-wickhams-books"><i class="fa fa-check"></i><b>4.3.1</b> Hadley Wickham’s books</a></li>
<li class="chapter" data-level="4.3.2" data-path="Conseguir-ayuda.html"><a href="Conseguir-ayuda.html#learning-statistics-with-r"><i class="fa fa-check"></i><b>4.3.2</b> Learning statistics with R</a></li>
<li class="chapter" data-level="4.3.3" data-path="Conseguir-ayuda.html"><a href="Conseguir-ayuda.html#pirate-guide-to-r"><i class="fa fa-check"></i><b>4.3.3</b> Pirate guide to R</a></li>
<li class="chapter" data-level="4.3.4" data-path="Conseguir-ayuda.html"><a href="Conseguir-ayuda.html#plots"><i class="fa fa-check"></i><b>4.3.4</b> Plots</a></li>
<li class="chapter" data-level="4.3.5" data-path="Conseguir-ayuda.html"><a href="Conseguir-ayuda.html#other-references"><i class="fa fa-check"></i><b>4.3.5</b> Other references</a></li>
<li class="chapter" data-level="4.3.6" data-path="Conseguir-ayuda.html"><a href="Conseguir-ayuda.html#twitter"><i class="fa fa-check"></i><b>4.3.6</b> Twitter</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="basics-data-types-import-and-export-data.html"><a href="basics-data-types-import-and-export-data.html"><i class="fa fa-check"></i><b>5</b> Basics - Data types, import and export data</a><ul>
<li class="chapter" data-level="5.1" data-path="basics-data-types-import-and-export-data.html"><a href="basics-data-types-import-and-export-data.html#data-types"><i class="fa fa-check"></i><b>5.1</b> Data types</a><ul>
<li class="chapter" data-level="5.1.1" data-path="basics-data-types-import-and-export-data.html"><a href="basics-data-types-import-and-export-data.html#data-frames"><i class="fa fa-check"></i><b>5.1.1</b> Data Frames</a></li>
<li class="chapter" data-level="5.1.2" data-path="basics-data-types-import-and-export-data.html"><a href="basics-data-types-import-and-export-data.html#matrices"><i class="fa fa-check"></i><b>5.1.2</b> Matrices</a></li>
<li class="chapter" data-level="5.1.3" data-path="basics-data-types-import-and-export-data.html"><a href="basics-data-types-import-and-export-data.html#listas"><i class="fa fa-check"></i><b>5.1.3</b> Listas</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="basics-data-types-import-and-export-data.html"><a href="basics-data-types-import-and-export-data.html#import-data"><i class="fa fa-check"></i><b>5.2</b> Import data</a><ul>
<li class="chapter" data-level="5.2.1" data-path="basics-data-types-import-and-export-data.html"><a href="basics-data-types-import-and-export-data.html#from-csv-file"><i class="fa fa-check"></i><b>5.2.1</b> From CSV file</a></li>
<li class="chapter" data-level="5.2.2" data-path="basics-data-types-import-and-export-data.html"><a href="basics-data-types-import-and-export-data.html#from-xls-file-excel"><i class="fa fa-check"></i><b>5.2.2</b> From XLS’ file (Excel)</a></li>
<li class="chapter" data-level="5.2.3" data-path="basics-data-types-import-and-export-data.html"><a href="basics-data-types-import-and-export-data.html#from-sav-file-spss"><i class="fa fa-check"></i><b>5.2.3</b> From SAV file (SPSS)</a></li>
<li class="chapter" data-level="5.2.4" data-path="basics-data-types-import-and-export-data.html"><a href="basics-data-types-import-and-export-data.html#import-all-files-from-a-folder"><i class="fa fa-check"></i><b>5.2.4</b> Import all files from a folder</a></li>
<li class="chapter" data-level="5.2.5" data-path="basics-data-types-import-and-export-data.html"><a href="basics-data-types-import-and-export-data.html#import-files-using-rstudio"><i class="fa fa-check"></i><b>5.2.5</b> Import files using RStudio</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="basics-data-types-import-and-export-data.html"><a href="basics-data-types-import-and-export-data.html#export-data"><i class="fa fa-check"></i><b>5.3</b> Export data</a><ul>
<li class="chapter" data-level="5.3.1" data-path="basics-data-types-import-and-export-data.html"><a href="basics-data-types-import-and-export-data.html#export-data-to-csv-file"><i class="fa fa-check"></i><b>5.3.1</b> Export data to CSV file</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="Manipular-datos.html"><a href="Manipular-datos.html"><i class="fa fa-check"></i><b>6</b> Manipular datos</a><ul>
<li class="chapter" data-level="6.1" data-path="Manipular-datos.html"><a href="Manipular-datos.html#leer-y-guardar-datos"><i class="fa fa-check"></i><b>6.1</b> Leer y guardar datos</a><ul>
<li class="chapter" data-level="6.1.1" data-path="Manipular-datos.html"><a href="Manipular-datos.html#leer-datos"><i class="fa fa-check"></i><b>6.1.1</b> Leer datos</a></li>
<li class="chapter" data-level="6.1.2" data-path="Manipular-datos.html"><a href="Manipular-datos.html#guardar-db-a-archivo"><i class="fa fa-check"></i><b>6.1.2</b> Guardar DB a archivo</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="Manipular-datos.html"><a href="Manipular-datos.html#ver-output-vs-asignar-output"><i class="fa fa-check"></i><b>6.2</b> Ver output vs asignar output</a></li>
<li class="chapter" data-level="6.3" data-path="Manipular-datos.html"><a href="Manipular-datos.html#verbos-de-dplyr"><i class="fa fa-check"></i><b>6.3</b> Verbos de dplyr</a><ul>
<li class="chapter" data-level="6.3.1" data-path="Manipular-datos.html"><a href="Manipular-datos.html#filtrar-datos"><i class="fa fa-check"></i><b>6.3.1</b> Filtrar datos</a></li>
<li class="chapter" data-level="6.3.2" data-path="Manipular-datos.html"><a href="Manipular-datos.html#ordenar-db"><i class="fa fa-check"></i><b>6.3.2</b> Ordenar DB</a></li>
<li class="chapter" data-level="6.3.3" data-path="Manipular-datos.html"><a href="Manipular-datos.html#seleccionar-variables"><i class="fa fa-check"></i><b>6.3.3</b> Seleccionar variables</a></li>
<li class="chapter" data-level="6.3.4" data-path="Manipular-datos.html"><a href="Manipular-datos.html#renombrar-variables"><i class="fa fa-check"></i><b>6.3.4</b> Renombrar variables</a></li>
<li class="chapter" data-level="6.3.5" data-path="Manipular-datos.html"><a href="Manipular-datos.html#separate-contents-of-a-single-variable"><i class="fa fa-check"></i><b>6.3.5</b> Separate contents of a single variable</a></li>
<li class="chapter" data-level="6.3.6" data-path="Manipular-datos.html"><a href="Manipular-datos.html#wide-to-long-format"><i class="fa fa-check"></i><b>6.3.6</b> Wide to Long format</a></li>
<li class="chapter" data-level="6.3.7" data-path="Manipular-datos.html"><a href="Manipular-datos.html#long-to-wide"><i class="fa fa-check"></i><b>6.3.7</b> Long to wide</a></li>
<li class="chapter" data-level="6.3.8" data-path="Manipular-datos.html"><a href="Manipular-datos.html#omitir-nas"><i class="fa fa-check"></i><b>6.3.8</b> Omitir NAs</a></li>
<li class="chapter" data-level="6.3.9" data-path="Manipular-datos.html"><a href="Manipular-datos.html#eliminar-variables"><i class="fa fa-check"></i><b>6.3.9</b> Eliminar variables</a></li>
<li class="chapter" data-level="6.3.10" data-path="Manipular-datos.html"><a href="Manipular-datos.html#crear-nuevas-variables"><i class="fa fa-check"></i><b>6.3.10</b> Crear nuevas variables:</a></li>
<li class="chapter" data-level="6.3.11" data-path="Manipular-datos.html"><a href="Manipular-datos.html#recodificamos-datos"><i class="fa fa-check"></i><b>6.3.11</b> Recodificamos datos</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="Manipular-datos.html"><a href="Manipular-datos.html#combinar-bases-de-datos"><i class="fa fa-check"></i><b>6.4</b> Combinar bases de datos</a></li>
<li class="chapter" data-level="6.5" data-path="Manipular-datos.html"><a href="Manipular-datos.html#verbos-avanzados"><i class="fa fa-check"></i><b>6.5</b> Verbos avanzados</a><ul>
<li class="chapter" data-level="6.5.1" data-path="Manipular-datos.html"><a href="Manipular-datos.html#cambiar-multiples-columnas-de-un-tipo-a-otro"><i class="fa fa-check"></i><b>6.5.1</b> Cambiar multiples columnas de un tipo a otro</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="Manipular-datos.html"><a href="Manipular-datos.html#regular-expressions"><i class="fa fa-check"></i><b>6.6</b> Regular expressions</a></li>
<li class="chapter" data-level="6.7" data-path="Manipular-datos.html"><a href="Manipular-datos.html#trabajando-con-fechas"><i class="fa fa-check"></i><b>6.7</b> Trabajando con fechas</a></li>
<li class="chapter" data-level="6.8" data-path="Manipular-datos.html"><a href="Manipular-datos.html#tutoriales-externos"><i class="fa fa-check"></i><b>6.8</b> Tutoriales externos</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html"><i class="fa fa-check"></i><b>7</b> Visualizar datos</a><ul>
<li class="chapter" data-level="7.1" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html#other-resources"><i class="fa fa-check"></i><b>7.1</b> Other resources</a></li>
<li class="chapter" data-level="7.2" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html#que-grafica-puedo-usar-wip"><i class="fa fa-check"></i><b>7.2</b> Que gráfica puedo usar (WIP)</a></li>
<li class="chapter" data-level="7.3" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html#tipos-de-graficas"><i class="fa fa-check"></i><b>7.3</b> Tipos de gráficas</a><ul>
<li class="chapter" data-level="7.3.1" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html#histogramas"><i class="fa fa-check"></i><b>7.3.1</b> Histogramas</a></li>
<li class="chapter" data-level="7.3.2" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html#Pirate-Plot"><i class="fa fa-check"></i><b>7.3.2</b> Pirate plot</a></li>
<li class="chapter" data-level="7.3.3" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html#barplots-with-individual-responses"><i class="fa fa-check"></i><b>7.3.3</b> Barplots with individual responses</a></li>
<li class="chapter" data-level="7.3.4" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html#diagrama-de-caja-y-bigotes"><i class="fa fa-check"></i><b>7.3.4</b> Diagrama de caja y bigotes</a></li>
<li class="chapter" data-level="7.3.5" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html#correlation-plot"><i class="fa fa-check"></i><b>7.3.5</b> Correlation plot</a></li>
<li class="chapter" data-level="7.3.6" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html#beanplot"><i class="fa fa-check"></i><b>7.3.6</b> Beanplot</a></li>
<li class="chapter" data-level="7.3.7" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html#scatterplot"><i class="fa fa-check"></i><b>7.3.7</b> Scatterplot</a></li>
<li class="chapter" data-level="7.3.8" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html#scatterplot-con-3-variables"><i class="fa fa-check"></i><b>7.3.8</b> Scatterplot con 3 variables</a></li>
<li class="chapter" data-level="7.3.9" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html#density-plots"><i class="fa fa-check"></i><b>7.3.9</b> Density plots</a></li>
<li class="chapter" data-level="7.3.10" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html#density-ridges-plots-ggjoy"><i class="fa fa-check"></i><b>7.3.10</b> Density Ridges Plots (ggjoy)</a></li>
<li class="chapter" data-level="7.3.11" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html#pp-plots"><i class="fa fa-check"></i><b>7.3.11</b> PP plots</a></li>
<li class="chapter" data-level="7.3.12" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html#shaded-geom-area"><i class="fa fa-check"></i><b>7.3.12</b> Shaded geom area</a></li>
<li class="chapter" data-level="7.3.13" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html#multiple-scatterplots"><i class="fa fa-check"></i><b>7.3.13</b> Multiple Scatterplots</a></li>
<li class="chapter" data-level="7.3.14" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html#background-data"><i class="fa fa-check"></i><b>7.3.14</b> Background data</a></li>
<li class="chapter" data-level="7.3.15" data-path="Visualizar-datos.html"><a href="Visualizar-datos.html#flip-plots"><i class="fa fa-check"></i><b>7.3.15</b> Flip plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="Visualizar-riesgo.html"><a href="Visualizar-riesgo.html"><i class="fa fa-check"></i><b>8</b> Visualizar riesgo</a><ul>
<li class="chapter" data-level="8.1" data-path="Visualizar-riesgo.html"><a href="Visualizar-riesgo.html#riskr"><i class="fa fa-check"></i><b>8.1</b> Riskr</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="Estadistica-descriptiva.html"><a href="Estadistica-descriptiva.html"><i class="fa fa-check"></i><b>9</b> Estadistica descriptiva</a><ul>
<li class="chapter" data-level="9.1" data-path="Estadistica-descriptiva.html"><a href="Estadistica-descriptiva.html#summary-de-datos"><i class="fa fa-check"></i><b>9.1</b> Summary de datos</a><ul>
<li class="chapter" data-level="9.1.1" data-path="Estadistica-descriptiva.html"><a href="Estadistica-descriptiva.html#agrupamos-por-sujeto"><i class="fa fa-check"></i><b>9.1.1</b> Agrupamos por sujeto</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="Estadistica-descriptiva.html"><a href="Estadistica-descriptiva.html#descriptive-tables-latex"><i class="fa fa-check"></i><b>9.2</b> Descriptive tables latex</a></li>
<li class="chapter" data-level="9.3" data-path="Estadistica-descriptiva.html"><a href="Estadistica-descriptiva.html#visualize-missing-values"><i class="fa fa-check"></i><b>9.3</b> Visualize missing values</a></li>
<li class="chapter" data-level="9.4" data-path="Estadistica-descriptiva.html"><a href="Estadistica-descriptiva.html#tutorial-externo"><i class="fa fa-check"></i><b>9.4</b> Tutorial externo</a></li>
<li class="chapter" data-level="9.5" data-path="Estadistica-descriptiva.html"><a href="Estadistica-descriptiva.html#findviews"><i class="fa fa-check"></i><b>9.5</b> Findviews</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="Estadistica-inferencial.html"><a href="Estadistica-inferencial.html"><i class="fa fa-check"></i><b>10</b> Estadistica inferencial</a><ul>
<li class="chapter" data-level="10.1" data-path="Estadistica-inferencial.html"><a href="Estadistica-inferencial.html#referencias-y-fuentes"><i class="fa fa-check"></i><b>10.1</b> Referencias y Fuentes</a></li>
<li class="chapter" data-level="10.2" data-path="Estadistica-inferencial.html"><a href="Estadistica-inferencial.html#association-test"><i class="fa fa-check"></i><b>10.2</b> Association test</a><ul>
<li class="chapter" data-level="10.2.1" data-path="Estadistica-inferencial.html"><a href="Estadistica-inferencial.html#frequentist-1"><i class="fa fa-check"></i><b>10.2.1</b> Frequentist</a></li>
<li class="chapter" data-level="10.2.2" data-path="Estadistica-inferencial.html"><a href="Estadistica-inferencial.html#bayesian-2"><i class="fa fa-check"></i><b>10.2.2</b> Bayesian</a></li>
<li class="chapter" data-level="10.2.3" data-path="Estadistica-inferencial.html"><a href="Estadistica-inferencial.html#results-report---wip"><i class="fa fa-check"></i><b>10.2.3</b> Results report - WIP</a></li>
<li class="chapter" data-level="10.2.4" data-path="Estadistica-inferencial.html"><a href="Estadistica-inferencial.html#references"><i class="fa fa-check"></i><b>10.2.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="Estadistica-inferencial.html"><a href="Estadistica-inferencial.html#anova-repeated-measures"><i class="fa fa-check"></i><b>10.3</b> ANOVA repeated measures</a></li>
<li class="chapter" data-level="10.4" data-path="Estadistica-inferencial.html"><a href="Estadistica-inferencial.html#mixed-models"><i class="fa fa-check"></i><b>10.4</b> Mixed Models</a></li>
<li class="chapter" data-level="10.5" data-path="Estadistica-inferencial.html"><a href="Estadistica-inferencial.html#meta-analysis"><i class="fa fa-check"></i><b>10.5</b> Meta analysis</a><ul>
<li class="chapter" data-level="10.5.1" data-path="Estadistica-inferencial.html"><a href="Estadistica-inferencial.html#natural-frequencies-effect"><i class="fa fa-check"></i><b>10.5.1</b> Natural Frequencies Effect</a></li>
<li class="chapter" data-level="10.5.2" data-path="Estadistica-inferencial.html"><a href="Estadistica-inferencial.html#pictures-effect"><i class="fa fa-check"></i><b>10.5.2</b> Pictures Effect</a></li>
<li class="chapter" data-level="10.5.3" data-path="Estadistica-inferencial.html"><a href="Estadistica-inferencial.html#notes-on-meta-analysis"><i class="fa fa-check"></i><b>10.5.3</b> Notes on Meta-analysis</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="Estadistica-inferencial.html"><a href="Estadistica-inferencial.html#roc-curves"><i class="fa fa-check"></i><b>10.6</b> ROC Curves</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="Funciones.html"><a href="Funciones.html"><i class="fa fa-check"></i><b>11</b> Funciones</a><ul>
<li class="chapter" data-level="11.1" data-path="Funciones.html"><a href="Funciones.html#creando-mi-primera-funcion"><i class="fa fa-check"></i><b>11.1</b> Creando mi primera función</a><ul>
<li class="chapter" data-level="11.1.1" data-path="Funciones.html"><a href="Funciones.html#pirate-plot-original"><i class="fa fa-check"></i><b>11.1.1</b> Pirate plot original</a></li>
<li class="chapter" data-level="11.1.2" data-path="Funciones.html"><a href="Funciones.html#nuestra-funcion"><i class="fa fa-check"></i><b>11.1.2</b> Nuestra función</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="pre-processing.html"><a href="pre-processing.html"><i class="fa fa-check"></i><b>12</b> Pre-processing</a><ul>
<li class="chapter" data-level="12.1" data-path="pre-processing.html"><a href="pre-processing.html#rt-filtering"><i class="fa fa-check"></i><b>12.1</b> RT filtering</a><ul>
<li class="chapter" data-level="12.1.1" data-path="pre-processing.html"><a href="pre-processing.html#function-to-filter-by-rt"><i class="fa fa-check"></i><b>12.1.1</b> Function to filter by RT</a></li>
<li class="chapter" data-level="12.1.2" data-path="pre-processing.html"><a href="pre-processing.html#n-sd-from-the-median-mad-1"><i class="fa fa-check"></i><b>12.1.2</b> n SD from the median (MAD)</a></li>
<li class="chapter" data-level="12.1.3" data-path="pre-processing.html"><a href="pre-processing.html#gamma-law-regression-analyses-2"><i class="fa fa-check"></i><b>12.1.3</b> Gamma law regression analyses</a></li>
<li class="chapter" data-level="12.1.4" data-path="pre-processing.html"><a href="pre-processing.html#logarithms"><i class="fa fa-check"></i><b>12.1.4</b> Logarithms</a></li>
<li class="chapter" data-level="12.1.5" data-path="pre-processing.html"><a href="pre-processing.html#references-1"><i class="fa fa-check"></i><b>12.1.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="pre-processing.html"><a href="pre-processing.html#reliability"><i class="fa fa-check"></i><b>12.2</b> Reliability</a><ul>
<li class="chapter" data-level="12.2.1" data-path="pre-processing.html"><a href="pre-processing.html#cronbachs-alpha"><i class="fa fa-check"></i><b>12.2.1</b> Cronbach’s Alpha</a></li>
<li class="chapter" data-level="12.2.2" data-path="pre-processing.html"><a href="pre-processing.html#omega"><i class="fa fa-check"></i><b>12.2.2</b> Omega</a></li>
<li class="chapter" data-level="12.2.3" data-path="pre-processing.html"><a href="pre-processing.html#references-2"><i class="fa fa-check"></i><b>12.2.3</b> References</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="pre-processing.html"><a href="pre-processing.html#impute-missing-data"><i class="fa fa-check"></i><b>12.3</b> Impute missing data</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="experimental-design.html"><a href="experimental-design.html"><i class="fa fa-check"></i><b>13</b> Experimental design</a><ul>
<li class="chapter" data-level="13.1" data-path="experimental-design.html"><a href="experimental-design.html#tamano-de-muestra-y-efecto-detectado"><i class="fa fa-check"></i><b>13.1</b> Tamaño de muestra y efecto detectado</a></li>
<li class="chapter" data-level="13.2" data-path="experimental-design.html"><a href="experimental-design.html#power-analysis"><i class="fa fa-check"></i><b>13.2</b> Power analysis</a><ul>
<li class="chapter" data-level="13.2.1" data-path="experimental-design.html"><a href="experimental-design.html#longitudinal-designs"><i class="fa fa-check"></i><b>13.2.1</b> Longitudinal designs</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="experimental-design.html"><a href="experimental-design.html#anonimizar-participantes---encriptar-ids"><i class="fa fa-check"></i><b>13.3</b> Anonimizar participantes - Encriptar IDs</a><ul>
<li class="chapter" data-level="13.3.1" data-path="experimental-design.html"><a href="experimental-design.html#encriptando-y-desencriptando-un-elemento"><i class="fa fa-check"></i><b>13.3.1</b> Encriptando y desencriptando un elemento</a></li>
<li class="chapter" data-level="13.3.2" data-path="experimental-design.html"><a href="experimental-design.html#encriptando-y-desencriptando-la-columna-rut-de-una-db-completa."><i class="fa fa-check"></i><b>13.3.2</b> Encriptando y desencriptando la columna RUT de una DB completa.</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="experimental-design.html"><a href="experimental-design.html#match-participants"><i class="fa fa-check"></i><b>13.4</b> Match participants</a></li>
<li class="chapter" data-level="13.5" data-path="experimental-design.html"><a href="experimental-design.html#determine-distribution"><i class="fa fa-check"></i><b>13.5</b> Determine distribution</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="classification.html"><a href="classification.html"><i class="fa fa-check"></i><b>14</b> Classification</a><ul>
<li class="chapter" data-level="14.1" data-path="classification.html"><a href="classification.html#fast-and-frugal-trees"><i class="fa fa-check"></i><b>14.1</b> Fast and frugal trees</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="other-stuff.html"><a href="other-stuff.html"><i class="fa fa-check"></i><b>15</b> Other stuff</a><ul>
<li class="chapter" data-level="15.1" data-path="other-stuff.html"><a href="other-stuff.html#maps---generate-and-locate-cities-in-a-world-map"><i class="fa fa-check"></i><b>15.1</b> Maps - Generate and locate cities in a world map</a></li>
<li class="chapter" data-level="15.2" data-path="other-stuff.html"><a href="other-stuff.html#extract-tables-from-the-internet"><i class="fa fa-check"></i><b>15.2</b> Extract tables from the internet</a></li>
<li class="chapter" data-level="15.3" data-path="other-stuff.html"><a href="other-stuff.html#extract-tables-from-the-internet-1"><i class="fa fa-check"></i><b>15.3</b> Extract tables from the internet</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="ejercicios-y-soluciones.html"><a href="ejercicios-y-soluciones.html"><i class="fa fa-check"></i><b>16</b> Ejercicios y soluciones</a><ul>
<li class="chapter" data-level="16.1" data-path="ejercicios-y-soluciones.html"><a href="ejercicios-y-soluciones.html#Ejercicios1"><i class="fa fa-check"></i><b>16.1</b> Ejercicios 1</a></li>
<li class="chapter" data-level="16.2" data-path="ejercicios-y-soluciones.html"><a href="ejercicios-y-soluciones.html#Ejercicios2"><i class="fa fa-check"></i><b>16.2</b> Ejercicios 2</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="bibliography-and-interesting-resources.html"><a href="bibliography-and-interesting-resources.html"><i class="fa fa-check"></i><b>17</b> Bibliography and interesting resources</a><ul>
<li class="chapter" data-level="17.1" data-path="bibliography-and-interesting-resources.html"><a href="bibliography-and-interesting-resources.html#bibliography"><i class="fa fa-check"></i><b>17.1</b> Bibliography</a></li>
<li class="chapter" data-level="17.2" data-path="bibliography-and-interesting-resources.html"><a href="bibliography-and-interesting-resources.html#interesting-resources---potentially"><i class="fa fa-check"></i><b>17.2</b> Interesting resources - potentially</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="todo-curso-basico-r-2016.html"><a href="todo-curso-basico-r-2016.html"><i class="fa fa-check"></i><b>18</b> TODO - Curso Basico R - 2016</a><ul>
<li class="chapter" data-level="18.1" data-path="todo-curso-basico-r-2016.html"><a href="todo-curso-basico-r-2016.html#en-ejercicios"><i class="fa fa-check"></i><b>18.1</b> EN EJERCICIOS:</a></li>
<li class="chapter" data-level="18.2" data-path="todo-curso-basico-r-2016.html"><a href="todo-curso-basico-r-2016.html#todo---limpieza-general"><i class="fa fa-check"></i><b>18.2</b> TODO - Limpieza general</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="todo-1.html"><a href="todo-1.html"><i class="fa fa-check"></i><b>19</b> TODO</a><ul>
<li class="chapter" data-level="19.1" data-path="todo-1.html"><a href="todo-1.html#urgent-stuff"><i class="fa fa-check"></i><b>19.1</b> Urgent stuff</a></li>
<li class="chapter" data-level="19.2" data-path="todo-1.html"><a href="todo-1.html#important"><i class="fa fa-check"></i><b>19.2</b> Important</a></li>
<li class="chapter" data-level="19.3" data-path="todo-1.html"><a href="todo-1.html#various"><i class="fa fa-check"></i><b>19.3</b> Various</a></li>
<li class="chapter" data-level="19.4" data-path="todo-1.html"><a href="todo-1.html#index-proposal"><i class="fa fa-check"></i><b>19.4</b> <strong>INDEX PROPOSAL</strong></a></li>
<li class="chapter" data-level="19.5" data-path="todo-1.html"><a href="todo-1.html#style-guide"><i class="fa fa-check"></i><b>19.5</b> Style guide</a><ul>
<li class="chapter" data-level="19.5.1" data-path="todo-1.html"><a href="todo-1.html#sections"><i class="fa fa-check"></i><b>19.5.1</b> Sections</a></li>
<li class="chapter" data-level="19.5.2" data-path="todo-1.html"><a href="todo-1.html#general"><i class="fa fa-check"></i><b>19.5.2</b> General</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="todo-1.html"><a href="todo-1.html#notas---remember"><i class="fa fa-check"></i><b>19.6</b> NOTAS - REMEMBER</a><ul>
<li class="chapter" data-level="19.6.1" data-path="todo-1.html"><a href="todo-1.html#refs"><i class="fa fa-check"></i><b>19.6.1</b> REFS</a></li>
<li class="chapter" data-level="19.6.2" data-path="todo-1.html"><a href="todo-1.html#notas"><i class="fa fa-check"></i><b>19.6.2</b> NOTAS</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R - Statistics Manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Estadistica_inferencial" class="section level1">
<h1><span class="header-section-number">10</span> Estadistica inferencial</h1>
<!-- # REVISAR -->
<!-- http://www.cookbook-r.com/Statistical_analysis/ANOVA/ -->
<!-- # REVISAR -->
<!-- # Para generar tablas APA de descriptivos y ANOVAS -->
<!-- https://cran.rstudio.com/web/packages/apaTables/vignettes/apaTables.html -->
<hr />
<p><strong>WIP: REVISAR PAQUETE AFEX</strong></p>
<ul>
<li>Permite definir variables intra y entre… y sacar posthocs!<br />
<a href="https://cran.r-project.org/web/packages/afex/afex.pdf" class="uri">https://cran.r-project.org/web/packages/afex/afex.pdf</a></li>
</ul>
<p>a = aov_ez(“ID”, “VD”, datos_long, within = c(“VI1”, “VI2”, “VI3”))</p>
<p>lsmip(a, VI1 ~ VI2 * VI3)</p>
<p>lsmeans(a, “VI1”, contr = “pairwise”) lsmeans(a, “VI2”, contr = “pairwise”) lsmeans(a, “VI3”, contr = “pairwise”)</p>
<p>lsmeans(a, c(“VI1”, “VI2”, “VI3”), contr = “pairwise”)</p>
<p>Why Psychologists Should Always Report the W-test Instead of the F-Test ANOVA
<a href="https://psyarxiv.com/wnezg" class="uri">https://psyarxiv.com/wnezg</a></p>
<p><strong>WIP: REVISAR</strong></p>
<ul>
<li><a href="http://www.quantide.com/raccoon-ch-2-4-3-way-anova/" class="uri">http://www.quantide.com/raccoon-ch-2-4-3-way-anova/</a></li>
</ul>
<hr />
<p>Luego de tener algo parecido a una base de datos ordenada, y haber examinado y vizualizado nuestros datos, es posible que quieras analizarlos.</p>
<p>Para esto aprenderemos algo sobre la lógica de contrucción de modelos y formulas con los cuales podremos armar varias de las pruebas estadísticas clásicas y facilitara la comprensión de otras funciones más complejas como las relacionadas a Modelos re regresión más complejos y Modelos de Ecuaciones Estructurales.</p>
<p>##Algo sobre Modelos y Fórmulas
En terminos sencillos, un modelo es una conjetura sobre que tipo de relación tienen las variables en juego.</p>
<p>Por ejemplo yo podria suponer que a medida que aumenta el consumo de alcohol, nuestra percepción de belleza decae.</p>
<p>R tiene sencillas fórmulas para representar este tipo de relaciones.</p>
<p>Si nosotros pensamos que el consumo <code>Alcohol</code> predice el <code>Atractivo</code> de la persona con la que filteamos, podemos formularlo como un modelo de la forma:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#fórmula básica</span>
formula =<span class="st"> &quot;Atractivo ~ Alcohol&quot;</span></code></pre>
<p>Si además pensamos que el <code>Sexo</code> tambien puede ser un predictor, modificamos el modelo inicial:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#añadir variables predictoras</span>
formula =<span class="st"> &quot;Atractivo ~ Alcohol + Sexo&quot;</span></code></pre>
<p>En el caso de que 2 variables, <code>Alcohol</code> y <code>Sexo</code> sean predictores, es posible pensar que estas pueden interaccionas. Podemos agregar la interación de varias formas:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#versión extendida</span>
formula =<span class="st"> &quot;Atractivo ~ Alcohol + Sexo + Alcohol*Sexo&quot;</span>

<span class="co">#versión corta</span>
formula =<span class="st"> &quot;Atractivo ~ Alcohol*Sexo&quot;</span></code></pre>
<p>En resumen, todo lo que esta a la derecha del simbolo <code>~</code> es considerado un predictor o variable independiente, y todo lo que esta a la izquierda es una variable de resultado o una variable dependiente. No utilizamos el simbolo <code>=</code>, <code>&lt;-</code> o <code>==</code> ya que no estamos ni asignando ni haciendo una equivalencia lógica, y podriamos confundir a R.</p>
<p>Existen casos (por ejemplo, correlación o chi-cuadrado) en donde no hay una predicción propiamente tal. En estos casos se elimina del modelo la variable de resultado:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#fórmula para modelo sin predictor o asociativo</span>
formula =<span class="st"> &quot;~ Atractivo + Alcohol&quot;</span></code></pre>
<p>##Preparación de datos y packages</p>
<p>Para muchos de los análisis que vienen a continuación hemos creado una base de datos, la cual puedes descargar <a href="Data/08-Data_analysis/ANOVA_1.csv">Aquí</a>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Packages</span>
<span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">&#39;readr&#39;</span>)) <span class="kw">install.packages</span>(<span class="st">&#39;readr&#39;</span>); <span class="kw">library</span>(<span class="st">&#39;readr&#39;</span>)
<span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">&#39;dplyr&#39;</span>)) <span class="kw">install.packages</span>(<span class="st">&#39;dplyr&#39;</span>); <span class="kw">library</span>(<span class="st">&#39;dplyr&#39;</span>)
<span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">&#39;yarrr&#39;</span>)) <span class="kw">install.packages</span>(<span class="st">&#39;yarrr&#39;</span>); <span class="kw">library</span>(<span class="st">&#39;yarrr&#39;</span>)
<span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">&#39;car&#39;</span>)) <span class="kw">install.packages</span>(<span class="st">&#39;car&#39;</span>); <span class="kw">library</span>(<span class="st">&#39;car&#39;</span>)


<span class="co">#Importar dataframe</span>
df =<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;Data/08-Data_analysis/ANOVA_1.csv&quot;</span>)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   Id = col_double(),
##   AccuracyIz = col_double(),
##   Moral = col_double(),
##   Tom = col_double(),
##   Empatia = col_double(),
##   Sexo = col_double(),
##   Edad = col_double(),
##   AccuracyDer = col_double(),
##   AdapSoc = col_double(),
##   FunEjec = col_double()
## )</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Muestra las primeras 10 observaciones</span>
df</code></pre>
<pre><code>## # A tibble: 237 x 10
##       Id AccuracyIz Moral   Tom Empatia  Sexo  Edad AccuracyDer AdapSoc
##    &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt;
##  1     1         34     1    29      63     0    62          13      40
##  2     2         13    NA    23      55     0    53           8      43
##  3     3         20     1    26      27     0    18          14      38
##  4     4         24     1    21      33     0    40          14      48
##  5     5         20     1    18      35     1    65          15      48
##  6     6          2     0    23      38    NA    NA          12      35
##  7     7         13     1    19      38     0    56           5      16
##  8     8         27     1    15      42     1    70           8      41
##  9     9         37     1    23      36     0    43          23      38
## 10    10         27     0    20      51     1    52           9      24
## # … with 227 more rows, and 1 more variable: FunEjec &lt;dbl&gt;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Recodificar variable sexo de numérico a factor con etiquetas</span>
df =<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">Sexo =</span> <span class="kw">ifelse</span>(Sexo <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="st">&quot;mujer&quot;</span>, <span class="st">&quot;hombre&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">Sexo =</span> <span class="kw">as.factor</span>(Sexo))</code></pre>
<p>##Prueba t para muestras independientes</p>
<p>###Contando la historia…
Evaluación de diferencias por <code>Sexo</code> en una prueba de Teoría de la mente <code>Tom</code></p>
<p>###Test</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#En primer lugar comprobamos el supuesto de homogeneidad de varianzas</span>

<span class="co">#levene test {car} para homogeneidad de las varianzas</span>
<span class="kw">leveneTest</span>(df<span class="op">$</span>Tom <span class="op">~</span><span class="st"> </span>df<span class="op">$</span>Sexo)</code></pre>
<pre><code>## Levene&#39;s Test for Homogeneity of Variance (center = median)
##        Df F value Pr(&gt;F)
## group   1  0.7558 0.3856
##       228</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Ingresamos nuestro modelo en la función t.test()</span>
<span class="kw">t.test</span>(Tom <span class="op">~</span><span class="st"> </span>Sexo, df,  <span class="dt">var.equal =</span> T, <span class="dt">paired =</span> F)</code></pre>
<pre><code>## 
##  Two Sample t-test
## 
## data:  Tom by Sexo
## t = -2.4618, df = 228, p-value = 0.01456
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -2.6763463 -0.2967329
## sample estimates:
## mean in group hombre  mean in group mujer 
##             21.28070             22.76724</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Reporte descriptivo y Vizualización</span>
df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">na.omit</span>(Tom) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(Sexo) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(Tom), <span class="dt">sd =</span> <span class="kw">sd</span>(Tom))</code></pre>
<pre><code>##       mean       sd
## 1 22.11574 4.495014</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pirateplot</span>(Tom <span class="op">~</span><span class="st"> </span>Sexo, 
           <span class="dt">data =</span> df, 
           <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">40</span>), 
           <span class="dt">xlab =</span> <span class="st">&quot;Metodo&quot;</span>, 
           <span class="dt">ylab =</span> <span class="st">&quot;Nota&quot;</span>, 
           <span class="dt">main =</span> <span class="st">&quot;t test Pirateplot&quot;</span>, 
           <span class="dt">point.pch =</span> <span class="dv">16</span>, 
           <span class="dt">pal =</span> <span class="st">&quot;basel&quot;</span>)</code></pre>
<p><img src="_main_files/figure-html/data-analysis-t-test-1.png" width="672" /></p>
<p>##Prueba t para muestras dependientes</p>
<p>###Contando la historia…
En una tarea de disparo a objetivos, queremos evaluar si existen diferencias en la precisión de los sujetos a objetivos que aparecen a la Izquierda (<code>AccuracyIz</code>) o a la Derecha (<code>AccuracyDer</code>) del monitor.</p>
<p>###Test</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Ingresamos nuestro modelo en la función t.test()</span>
<span class="kw">t.test</span>(df<span class="op">$</span>AccuracyIz, df<span class="op">$</span>AccuracyDer, <span class="dt">paired =</span> T)</code></pre>
<pre><code>## 
##  Paired t-test
## 
## data:  df$AccuracyIz and df$AccuracyDer
## t = 22.904, df = 233, p-value &lt; 2.2e-16
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  10.05377 11.94623
## sample estimates:
## mean of the differences 
##                      11</code></pre>
<p>##Correlación de Pearson</p>
<p>###Contando la historia…
Se desea evaluar si existe alguna relación entre Teoria de la Mente (<code>Tom</code>) y el grado de Empatía de los sujetos (<code>Empatia</code>).</p>
<p>###Test</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Correlación de Pearson</span>
<span class="kw">cor.test</span>(<span class="op">~</span><span class="st"> </span>Tom <span class="op">+</span><span class="st"> </span>Empatia, <span class="dt">data =</span> df)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  Tom and Empatia
## t = 1.9789, df = 229, p-value = 0.04903
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.0005956093 0.2544818239
## sample estimates:
##       cor 
## 0.1296633</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Visualizar Diagrama de Dispersión</span>
<span class="kw">ggplot</span>(df, <span class="kw">aes</span>(Tom, Empatia)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="kw">transparent</span>(<span class="st">&quot;red&quot;</span>, <span class="fl">.4</span>))</code></pre>
<pre><code>## Warning: Removed 6 rows containing missing values (geom_point).</code></pre>
<p><img src="_main_files/figure-html/data-analysis-correlation-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Selecione un subconjunto de variables para la correlación multiple</span>
cordata =<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>Id,<span class="op">-</span>Moral,<span class="op">-</span>Sexo,<span class="op">-</span>AccuracyIz,<span class="op">-</span>AccuracyDer,<span class="op">-</span>Edad)

<span class="co">#carga libreria Hmisc</span>
<span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">&#39;Hmisc&#39;</span>)) <span class="kw">install.packages</span>(<span class="st">&#39;Hmisc&#39;</span>); <span class="kw">library</span>(<span class="st">&#39;Hmisc&#39;</span>)

<span class="co">#correlación multiple</span>
<span class="kw">rcorr</span>(<span class="kw">as.matrix</span>(cordata), <span class="dt">type =</span> <span class="st">&quot;pearson&quot;</span>)</code></pre>
<pre><code>##          Tom Empatia AdapSoc FunEjec
## Tom     1.00    0.13    0.16    0.10
## Empatia 0.13    1.00    0.25    0.06
## AdapSoc 0.16    0.25    1.00    0.15
## FunEjec 0.10    0.06    0.15    1.00
## 
## n
##         Tom Empatia AdapSoc FunEjec
## Tom     232     231     226     231
## Empatia 231     235     229     234
## AdapSoc 226     229     231     230
## FunEjec 231     234     230     236
## 
## P
##         Tom    Empatia AdapSoc FunEjec
## Tom            0.0490  0.0130  0.1331 
## Empatia 0.0490         0.0001  0.3760 
## AdapSoc 0.0130 0.0001          0.0204 
## FunEjec 0.1331 0.3760  0.0204</code></pre>
<p>##Regresión Simple</p>
<p>###Contando la historia…</p>
<p>Evaluaremos como las Funciones ejecutivas (<code>FunEjec</code>) pueden predecir la Precisión a objetivos en una tarea atencional (<code>Accuracy</code>).</p>
<p>Para esto primero añadiremos una nueva variable <code>Accuracy</code> la cual será el promedio de precisión para los objetivos Derechos (<code>AccuracyDer</code>) e Izquierdos (<code>AccuracyIz</code>). Lo realizaremos con la función <code>mutate</code> antes revisada en el apartado de manipulación de datos.</p>
<p>Además filtraremos a los sujetos con puntajes bajos (menos de 50 puntos).</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Creamos nueva variable &quot;Accuracy&quot; con la función mutate() {dplyr}</span>
df =<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">Accuracy =</span> (AccuracyIz <span class="op">+</span><span class="st"> </span>AccuracyDer)<span class="op">/</span><span class="dv">2</span>)

<span class="co">#Utilizar observaciones con puntajes de Funcion ejecutiva sobre 50 puntos.</span>
df =<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(FunEjec <span class="op">&gt;</span><span class="st"> </span><span class="dv">50</span>)</code></pre>
<p>###Test</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Insertamos nuestra fórmula al Modelo de Regresión Simple</span>
fit =<span class="st"> </span><span class="kw">lm</span>(Accuracy <span class="op">~</span><span class="st"> </span>FunEjec, df)

<span class="co">#Resumen de Coeficientes y Parametros del modelo</span>
<span class="kw">summary</span>(fit)</code></pre>
<pre><code>## 
## Call:
## lm(formula = Accuracy ~ FunEjec, data = df)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -11.587  -3.087   0.413   2.163  10.038 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  5.76939    2.83753   2.033   0.0457 *  
## FunEjec      0.06252    0.01457   4.292 5.36e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.729 on 73 degrees of freedom
##   (2 observations deleted due to missingness)
## Multiple R-squared:  0.2015, Adjusted R-squared:  0.1905 
## F-statistic: 18.42 on 1 and 73 DF,  p-value: 5.363e-05</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Intevalos de Confianza de los parámetros del modelo</span>
<span class="kw">confint</span>(fit, <span class="dt">level =</span> <span class="fl">0.95</span>)</code></pre>
<pre><code>##                  2.5 %      97.5 %
## (Intercept) 0.11419463 11.42458615
## FunEjec     0.03349037  0.09155961</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Visualizar Diagrama de Dispersión para Regresión</span>
<span class="kw">ggplot</span>(df, <span class="kw">aes</span>(FunEjec, Accuracy)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="kw">transparent</span>(<span class="st">&quot;black&quot;</span>, <span class="fl">.4</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> lm , <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">se =</span> T)</code></pre>
<pre><code>## Warning: Removed 2 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
<p><img src="_main_files/figure-html/data-analysis-regression2-1.png" width="672" /></p>
<p>##Análsis de la Varianza (1 Factor)
Esta vez trabajaremos con otra base de datos, la cual puedes descargar <a href="Data/08-Data_analysis/ANOVA_2.csv">Aquí</a>.
Se recomienda en esta oportunidad limpiar nuestro espacio de trabajo. Para esto podemos presionar <code>Ctrl + Shift + F10</code> o utilizar la función:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</code></pre>
<p>###Preparación de datos y packages</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Packages</span>
<span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">&#39;readr&#39;</span>)) <span class="kw">install.packages</span>(<span class="st">&#39;readr&#39;</span>); <span class="kw">library</span>(<span class="st">&#39;readr&#39;</span>)
<span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">&#39;dplyr&#39;</span>)) <span class="kw">install.packages</span>(<span class="st">&#39;dplyr&#39;</span>); <span class="kw">library</span>(<span class="st">&#39;dplyr&#39;</span>)
<span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">&#39;stats&#39;</span>)) <span class="kw">install.packages</span>(<span class="st">&#39;stats&#39;</span>); <span class="kw">library</span>(<span class="st">&#39;stats&#39;</span>)
<span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">&#39;car&#39;</span>)) <span class="kw">install.packages</span>(<span class="st">&#39;car&#39;</span>); <span class="kw">library</span>(<span class="st">&#39;car&#39;</span>)
<span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">&#39;apaTables&#39;</span>)) <span class="kw">install.packages</span>(<span class="st">&#39;apaTables&#39;</span>); <span class="kw">library</span>(<span class="st">&#39;apaTables&#39;</span>)


<span class="co">#Importar dataframe</span>
df =<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;Data/08-Data_analysis/ANOVA_2.csv&quot;</span>)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   Metodo = col_double(),
##   Nota = col_double()
## )</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Muestra las primeras 10 observaciones</span>
df</code></pre>
<pre><code>## # A tibble: 30 x 2
##    Metodo  Nota
##     &lt;dbl&gt; &lt;dbl&gt;
##  1      1    50
##  2      1    45
##  3      1    48
##  4      1    47
##  5      1    45
##  6      1    49
##  7      1    50
##  8      1    54
##  9      1    57
## 10      1    55
## # … with 20 more rows</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Recodificar variable Metodo de numérico a factor con etiquetas</span>
df =<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">Metodo =</span> <span class="kw">ifelse</span>(Metodo <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;Electroshock&quot;</span>, <span class="kw">ifelse</span>(Metodo <span class="op">==</span><span class="st"> </span><span class="dv">2</span>, <span class="st">&quot;Indiferencia&quot;</span>, <span class="st">&quot;Buen trabajo&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">Metodo =</span> <span class="kw">as.factor</span>(Metodo))</code></pre>
<p>###Contando la historia…
Se desea evaluar que métodos pueden contribuir (o no) al aprendizaje de estadísticas en R. Para esto tenemos las variables <code>Metodo</code> (si se uso Electroshock, la fria Indiferencia o un “Buen trabajo!”) y la <code>Nota</code> nota que se obtuvo en el curso.</p>
<p>###Test</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Introducimos la formula al Modelo con la función de ANOVA aov()</span>
fit =<span class="st"> </span><span class="kw">aov</span>(Nota <span class="op">~</span><span class="st"> </span>Metodo, df)

<span class="co">#Summario de Parámetros y Coeficientes</span>
<span class="kw">summary</span>(fit)</code></pre>
<pre><code>##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## Metodo       2 1205.1   602.5   21.01 3.15e-06 ***
## Residuals   27  774.4    28.7                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#levene test {car} para homogeneidad de las varianzas</span>
<span class="kw">leveneTest</span>(df<span class="op">$</span>Nota <span class="op">~</span><span class="st"> </span>df<span class="op">$</span>Metodo)</code></pre>
<pre><code>## Levene&#39;s Test for Homogeneity of Variance (center = median)
##       Df F value Pr(&gt;F)
## group  2  1.7343 0.1956
##       27</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Comparaciones Multiples mediante función TukeyHSD() {stats}</span>
<span class="kw">TukeyHSD</span>(fit)</code></pre>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = Nota ~ Metodo, data = df)
## 
## $Metodo
##                            diff          lwr       upr     p adj
## Electroshock-Buen trabajo -15.4 -21.33834579 -9.461654 0.0000020
## Indiferencia-Buen trabajo  -9.4 -15.33834579 -3.461654 0.0015175
## Indiferencia-Electroshock   6.0   0.06165421 11.938346 0.0472996</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Reporte descriptivo y Vizualización</span>
df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(Metodo) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(Nota), <span class="dt">sd =</span> <span class="kw">sd</span>(Nota))</code></pre>
<pre><code>##       mean       sd
## 1 57.13333 8.261808</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pirateplot</span>(Nota <span class="op">~</span><span class="st"> </span>Metodo, 
           <span class="dt">data =</span> df, 
           <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), 
           <span class="dt">xlab =</span> <span class="st">&quot;Metodo&quot;</span>, 
           <span class="dt">ylab =</span> <span class="st">&quot;Nota&quot;</span>, 
           <span class="dt">main =</span> <span class="st">&quot;ANOVA Pirateplot&quot;</span>, 
           <span class="dt">point.pch =</span> <span class="dv">16</span>, 
           <span class="dt">pal =</span> <span class="st">&quot;basel&quot;</span>)</code></pre>
<p><img src="_main_files/figure-html/data-analysis-aov3-1.png" width="672" /></p>
<p>###Tablas</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">apa.1way.table</span>(<span class="dt">iv =</span> Metodo, <span class="dt">dv =</span> Nota, <span class="dt">data =</span> df, <span class="dt">filename =</span> <span class="st">&quot;Resultados/Figure1_APA.doc&quot;</span>, <span class="dt">table.number =</span> <span class="dv">1</span>)</code></pre>
<pre><code>## 
## 
## Table 1 
## 
## Descriptive statistics for Nota as a function of Metodo.  
## 
##        Metodo     M   SD
##  Buen trabajo 65.40 4.30
##  Electroshock 50.00 4.14
##  Indiferencia 56.00 7.10
## 
## Note. M and SD represent mean and standard deviation, respectively.
## </code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">apa.aov.table</span>(fit, <span class="dt">filename =</span> <span class="st">&quot;Resultados/Figure2_APA.doc&quot;</span>,<span class="dt">table.number =</span> <span class="dv">2</span>)</code></pre>
<pre><code>## 
## 
## Table 2 
## 
## ANOVA results using Nota as the dependent variable
##  
## 
##    Predictor       SS df       MS       F    p partial_eta2
##  (Intercept) 42771.60  1 42771.60 1491.26 .000             
##       Metodo  1205.07  2   602.53   21.01 .000          .61
##        Error   774.40 27    28.68                          
##  CI_90_partial_eta2
##                    
##          [.36, .71]
##                    
## 
## Note: Values in square brackets indicate the bounds of the 90% confidence interval for partial eta-squared</code></pre>
<p>##Análsis de la Varianza (2 Factores)</p>
<p>###Descarga</p>
<p>Esta vez nuevamente trabajaremos con otra base de datos, la cual puedes descargar <a href="Data/08-Data_analysis/ANOVA_3.csv">Aquí</a>.
Se recomienda nuevamente limpiar nuestro espacio de trabajo. Para esto podemos presionar <code>Ctrl + Shift + F10</code> o utilizar la función:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</code></pre>
<p>###Preparación de datos y packages</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Packages</span>
<span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">&#39;readr&#39;</span>)) <span class="kw">install.packages</span>(<span class="st">&#39;readr&#39;</span>); <span class="kw">library</span>(<span class="st">&#39;readr&#39;</span>)
<span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">&#39;dplyr&#39;</span>)) <span class="kw">install.packages</span>(<span class="st">&#39;dplyr&#39;</span>); <span class="kw">library</span>(<span class="st">&#39;dplyr&#39;</span>)
<span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">&#39;stats&#39;</span>)) <span class="kw">install.packages</span>(<span class="st">&#39;stats&#39;</span>); <span class="kw">library</span>(<span class="st">&#39;stats&#39;</span>)
<span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">&#39;car&#39;</span>)) <span class="kw">install.packages</span>(<span class="st">&#39;car&#39;</span>); <span class="kw">library</span>(<span class="st">&#39;car&#39;</span>)



<span class="co">#Importar dataframe</span>
df =<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;Data/08-Data_analysis/ANOVA_3.csv&quot;</span>)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   Sexo = col_double(),
##   Alcohol = col_double(),
##   Atractivo = col_double()
## )</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Muestra las primeras 10 observaciones</span>
df</code></pre>
<pre><code>## # A tibble: 32 x 3
##     Sexo Alcohol Atractivo
##    &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;
##  1     1       0        65
##  2     1       0        70
##  3     1       0        60
##  4     1       0        60
##  5     1       0        60
##  6     1       0        55
##  7     1       0        60
##  8     1       0        55
##  9     1       1        55
## 10     1       1        65
## # … with 22 more rows</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Recodificar variable Sexo y Alcohol de numérico a factor con etiquetas</span>
df =<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">Sexo =</span> <span class="kw">ifelse</span>(Sexo <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="st">&quot;mujer&quot;</span>, <span class="st">&quot;hombre&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">Sexo =</span> <span class="kw">as.factor</span>(Sexo))
df =<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">Alcohol =</span> <span class="kw">ifelse</span>(Alcohol <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="st">&quot;No consume&quot;</span>, <span class="st">&quot;Tres Shop&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">Alcohol =</span> <span class="kw">as.factor</span>(Alcohol))</code></pre>
<p>###Contando la historia…
A veces cuando bebemos bebidas espirituosas, podemos sobreestimar el atractivo de otras personas. Esto en psicología lo conocemos como “Beer Glass Effect”.
Deseamos ver este efecto, pero además ver si el Sexo influye también.</p>
<p>Para esto tenemos las variables <code>Alcohol</code> (Si ha bebido o no), el <code>Sexo</code> del bebedor y la puntuación de <code>Atractivo</code> de la persona con la que flirtea aquella noche.</p>
<p>###Test</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Ajustamos el modelo con la funcion de ANOVA aov()</span>
fit =<span class="st"> </span><span class="kw">aov</span>(Atractivo <span class="op">~</span><span class="st"> </span>Sexo <span class="op">*</span><span class="st"> </span>Alcohol, df)

<span class="co">#Summario de Parámetros y Coeficientes</span>
<span class="kw">summary</span>(fit)</code></pre>
<pre><code>##              Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## Sexo          1  488.3   488.3    6.54   0.0163 *  
## Alcohol       1 2363.3  2363.3   31.65 5.03e-06 ***
## Sexo:Alcohol  1 1582.0  1582.0   21.19 8.20e-05 ***
## Residuals    28 2090.6    74.7                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Comparaciones Multiples mediante función TukeyHSD() {stats}</span>
<span class="kw">TukeyHSD</span>(fit)</code></pre>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = Atractivo ~ Sexo * Alcohol, data = df)
## 
## $Sexo
##                 diff       lwr       upr     p adj
## mujer-hombre -7.8125 -14.07042 -1.554575 0.0162548
## 
## $Alcohol
##                          diff       lwr       upr p adj
## Tres Shop-No consume -17.1875 -23.44542 -10.92958 5e-06
## 
## $`Sexo:Alcohol`
##                                       diff        lwr        upr     p adj
## mujer:No consume-hombre:No consume   6.250  -5.546177  18.046177 0.4820693
## hombre:Tres Shop-hombre:No consume  -3.125 -14.921177   8.671177 0.8869596
## mujer:Tres Shop-hombre:No consume  -25.000 -36.796177 -13.203823 0.0000186
## hombre:Tres Shop-mujer:No consume   -9.375 -21.171177   2.421177 0.1564908
## mujer:Tres Shop-mujer:No consume   -31.250 -43.046177 -19.453823 0.0000004
## mujer:Tres Shop-hombre:Tres Shop   -21.875 -33.671177 -10.078823 0.0001309</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Reporte descriptivo y Vizualización</span>
df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(Alcohol,Sexo) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(Atractivo), <span class="dt">sd =</span> <span class="kw">sd</span>(Atractivo))</code></pre>
<pre><code>##       mean       sd
## 1 55.15625 14.50719</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(Alcohol) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(Atractivo), <span class="dt">sd =</span> <span class="kw">sd</span>(Atractivo))</code></pre>
<pre><code>##       mean       sd
## 1 55.15625 14.50719</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(Sexo) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(Atractivo), <span class="dt">sd =</span> <span class="kw">sd</span>(Atractivo))</code></pre>
<pre><code>##       mean       sd
## 1 55.15625 14.50719</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pirateplot</span>(Atractivo <span class="op">~</span><span class="st"> </span>Sexo <span class="op">+</span><span class="st"> </span>Alcohol, 
           <span class="dt">data =</span> df, 
           <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), 
           <span class="dt">xlab =</span> <span class="st">&quot;Sex*Alcohol&quot;</span>, 
           <span class="dt">ylab =</span> <span class="st">&quot;Attractiveness Score&quot;</span>, 
           <span class="dt">main =</span> <span class="st">&quot;ANOVA Pirateplot&quot;</span>, 
           <span class="dt">point.pch =</span> <span class="dv">16</span>, 
           <span class="dt">pal =</span> <span class="st">&quot;basel&quot;</span>)</code></pre>
<p><img src="_main_files/figure-html/data-analysis-aov-2-fact3-1.png" width="672" /></p>
<p>###Tablas</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">apa.2way.table</span>(<span class="dt">iv1 =</span> Sexo, <span class="dt">iv2 =</span> Alcohol, <span class="dt">dv =</span> Atractivo, <span class="dt">data =</span> df, <span class="dt">filename =</span> <span class="st">&quot;Resultados/Figure3_APA.doc&quot;</span>, <span class="dt">table.number =</span> <span class="dv">3</span>)</code></pre>
<pre><code>## 
## 
## Table 3 
## 
## Means and standard deviations for Atractivo as a function of a 2(Sexo) X 2(Alcohol) design 
## 
##            Alcohol                      
##         No consume       Tres Shop      
##    Sexo          M    SD         M    SD
##  hombre      60.62  4.96     57.50  7.07
##   mujer      66.88 10.33     35.62 10.84
## 
## Note. M and SD represent mean and standard deviation, respectively.</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">apa.aov.table</span>(fit, <span class="dt">filename =</span> <span class="st">&quot;Resultados/Figure4_APA.doc&quot;</span>,<span class="dt">table.number =</span> <span class="dv">4</span>)</code></pre>
<pre><code>## 
## 
## Table 4 
## 
## ANOVA results using Atractivo as the dependent variable
##  
## 
##       Predictor       SS df       MS      F    p partial_eta2
##     (Intercept) 29403.12  1 29403.12 393.80 .000             
##            Sexo   156.25  1   156.25   2.09 .159          .07
##         Alcohol    39.06  1    39.06   0.52 .475          .02
##  Sexo x Alcohol  1582.03  1  1582.03  21.19 .000          .43
##           Error  2090.62 28    74.66                         
##  CI_90_partial_eta2
##                    
##          [.00, .24]
##          [.00, .16]
##          [.19, .58]
##                    
## 
## Note: Values in square brackets indicate the bounds of the 90% confidence interval for partial eta-squared</code></pre>
<div id="referencias-y-fuentes" class="section level2">
<h2><span class="header-section-number">10.1</span> Referencias y Fuentes</h2>
<ul>
<li><p><a href="https://uk.sagepub.com/en-gb/eur/discovering-statistics-using-r/book236067">Field, A. (2012). Discovering statistics using R.</a></p></li>
<li><p><a href="https://www.manning.com/books/r-in-action">Kabacoff, R. (2015). R in action: data analysis and graphics with R.</a></p></li>
</ul>

</div>
<div id="association-test" class="section level2">
<h2><span class="header-section-number">10.2</span> Association test</h2>
<p>A.K.A. X square test of independence</p>
<p><strong>WIP - Alternatives</strong></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Con datos de estudio Merlin</span>
<span class="co"># prop.test(table(DB_all$Ahorro_Dico, DB_all$Futuro_d))</span>
<span class="co"># chisq.test(table(DB_all$Ahorro_Dico, DB_all$Futuro_d))</span>

<span class="co"># # More powerful</span>
<span class="co"># Exact::exact.test(table(DB_all$Ahorro_Dico, DB_all$Futuro_d))</span>
<span class="co"># BayesFactor::contingencyTableBF(table(DB_all$Ahorro_Dico, DB_all$Futuro_d), sampleType = &quot;indepMulti&quot;, fixedMargin = &quot;rows&quot;)</span></code></pre>
<p><strong>Libraries</strong></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">&#39;BayesFactor&#39;</span>)) <span class="kw">install.packages</span>(<span class="st">&#39;BayesFactor&#39;</span>); <span class="kw">library</span>(<span class="st">&#39;BayesFactor&#39;</span>)
<span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">&#39;lsr&#39;</span>)) <span class="kw">install.packages</span>(<span class="st">&#39;lsr&#39;</span>); <span class="kw">library</span>(<span class="st">&#39;lsr&#39;</span>)</code></pre>
<p><strong>Import data - WIP</strong>
We use the following <a href="Data/08-Data_analysis/Association_test.csv">dataset</a>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Import to variable &quot;dataset&quot;</span>
dataset =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Data/08-Data_analysis/Association_test.csv&quot;</span>)

<span class="co">#Show first 5 rows</span>
<span class="kw">head</span>(dataset)</code></pre>
<pre><code>##    X    ID Dem_Gender Dem_Age Dem_Education       SET    answer   Time
## 1  4 71827          2      34             4 Resp_SET1 0.3333333 12.905
## 2  5  1946          1      29             6 Resp_SET1 0.3333333 38.895
## 3  6 83294          2      25             6 Resp_SET1 0.3333333 42.473
## 4  8 34065          1      29             6 Resp_SET1 0.6666667 16.438
## 5  9 39707          1      30             5 Resp_SET1 0.3333333 60.794
## 6 10 69772          2      28             2 Resp_SET1 0.5000000 26.169
##   Formato Problema Accuracy      Error Accuracy_factor Formato_factor
## 1      FN   DECIMA        1  0.0000000               1             FN
## 2      FN   DECIMA        1  0.0000000               1             FN
## 3      FN   UNIDAD        1  0.0000000               1             FN
## 4      PR   UNIDAD        0 -0.3333333               0             PR
## 5      PR   DECIMA        1  0.0000000               1             PR
## 6      PR   UNIDAD        0 -0.1666667               0             PR
##   Problema_factor Time_set1
## 1          DECIMA    12.905
## 2          DECIMA    38.895
## 3          UNIDAD    42.473
## 4          UNIDAD    16.438
## 5          DECIMA    60.794
## 6          UNIDAD    26.169</code></pre>
<p><strong>Prepare data</strong></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Convert to factors</span>
dataset<span class="op">$</span>Accuracy_factor =<span class="st"> </span><span class="kw">as.factor</span>(dataset<span class="op">$</span>Accuracy)
dataset<span class="op">$</span>Formato_factor =<span class="st"> </span><span class="kw">as.factor</span>(dataset<span class="op">$</span>Formato)
dataset<span class="op">$</span>Problema_factor =<span class="st"> </span><span class="kw">as.factor</span>(dataset<span class="op">$</span>Problema)</code></pre>
<div id="frequentist-1" class="section level3">
<h3><span class="header-section-number">10.2.1</span> Frequentist<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Accuracy_factor + Formato_factor</span>
crosstab_Formato &lt;-<span class="st"> </span><span class="kw">xtabs</span>(<span class="op">~</span><span class="st"> </span>Accuracy_factor <span class="op">+</span><span class="st"> </span>Formato_factor, dataset); crosstab_Formato</code></pre>
<pre><code>##                Formato_factor
## Accuracy_factor FN PR
##               0 18 24
##               1 66 57</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">associationTest</span>(<span class="dt">formula =</span> <span class="op">~</span><span class="st"> </span>Accuracy_factor <span class="op">+</span><span class="st"> </span>Formato_factor, <span class="dt">data =</span> dataset )</code></pre>
<pre><code>## 
##      Chi-square test of categorical association
## 
## Variables:   Accuracy_factor, Formato_factor 
## 
## Hypotheses: 
##    null:        variables are independent of one another
##    alternative: some contingency exists between variables
## 
## Observed contingency table:
##                Formato_factor
## Accuracy_factor FN PR
##               0 18 24
##               1 66 57
## 
## Expected contingency table under the null hypothesis:
##                Formato_factor
## Accuracy_factor   FN   PR
##               0 21.4 20.6
##               1 62.6 60.4
## 
## Test results: 
##    X-squared statistic:  1.061 
##    degrees of freedom:  1 
##    p-value:  0.303 
## 
## Other information: 
##    estimated effect size (Cramer&#39;s v):  0.08 
##    Yates&#39; continuity correction has been applied</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Accuracy_factor + Problema_factor</span>
crosstab_Problema &lt;-<span class="st"> </span><span class="kw">xtabs</span>(<span class="op">~</span><span class="st"> </span>Accuracy_factor <span class="op">+</span><span class="st"> </span>Problema_factor, dataset); crosstab_Problema</code></pre>
<pre><code>##                Problema_factor
## Accuracy_factor DECIMA UNIDAD
##               0     19     23
##               1     61     62</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">associationTest</span>(<span class="dt">formula =</span> <span class="op">~</span><span class="st"> </span>Accuracy_factor <span class="op">+</span><span class="st"> </span>Problema_factor, <span class="dt">data =</span> dataset )</code></pre>
<pre><code>## 
##      Chi-square test of categorical association
## 
## Variables:   Accuracy_factor, Problema_factor 
## 
## Hypotheses: 
##    null:        variables are independent of one another
##    alternative: some contingency exists between variables
## 
## Observed contingency table:
##                Problema_factor
## Accuracy_factor DECIMA UNIDAD
##               0     19     23
##               1     61     62
## 
## Expected contingency table under the null hypothesis:
##                Problema_factor
## Accuracy_factor DECIMA UNIDAD
##               0   20.4   21.6
##               1   59.6   63.4
## 
## Test results: 
##    X-squared statistic:  0.095 
##    degrees of freedom:  1 
##    p-value:  0.757 
## 
## Other information: 
##    estimated effect size (Cramer&#39;s v):  0.024 
##    Yates&#39; continuity correction has been applied</code></pre>
</div>
<div id="bayesian-2" class="section level3">
<h3><span class="header-section-number">10.2.2</span> Bayesian<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Accuracy_factor + Formato_factor</span>
<span class="kw">contingencyTableBF</span>( crosstab_Formato, <span class="dt">sampleType =</span> <span class="st">&quot;jointMulti&quot;</span> ) </code></pre>
<pre><code>## Bayes factor analysis
## --------------
## [1] Non-indep. (a=1) : 0.5146257 ±0%
## 
## Against denominator:
##   Null, independence, a = 1 
## ---
## Bayes factor type: BFcontingencyTable, joint multinomial</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Accuracy_factor + Problema_factor</span>
<span class="kw">contingencyTableBF</span>( crosstab_Problema, <span class="dt">sampleType =</span> <span class="st">&quot;jointMulti&quot;</span> ) </code></pre>
<pre><code>## Bayes factor analysis
## --------------
## [1] Non-indep. (a=1) : 0.2811145 ±0%
## 
## Against denominator:
##   Null, independence, a = 1 
## ---
## Bayes factor type: BFcontingencyTable, joint multinomial</code></pre>
</div>
<div id="results-report---wip" class="section level3">
<h3><span class="header-section-number">10.2.3</span> Results report - WIP</h3>
<blockquote>
<p>TODO: Use an example where we have both a null a and a significant finding</p>
</blockquote>
<div id="frequentist---wip" class="section level4">
<h4><span class="header-section-number">10.2.3.1</span> Frequentist - WIP</h4>
<p>Pearson’s X<sup>2</sup> revealed a significant association between species and choice (X<sup>2</sup> = 10.7, p = .01): robots appeared to be more likely to say that they prefer flowers, but the humans were more likely to say they prefer data.</p>
</div>
<div id="bayesian" class="section level4">
<h4><span class="header-section-number">10.2.3.2</span> Bayesian</h4>
<p>We ran a Bayesian test of association (see Gunel &amp; Dickey, 1974) using version 0.9.12-2 of the BayesFactor package (Morey &amp; Rouder, 2015) using default priors and a joint multinomial sampling plan. The resulting Bayes factor of 3.65 to 1 in favour of the null hypothesis indicates that there is moderately strong evidence for the non-independence of Problem and accuracy.</p>
</div>
</div>
<div id="references" class="section level3">
<h3><span class="header-section-number">10.2.4</span> References</h3>

</div>
</div>
<div id="anova-repeated-measures" class="section level2">
<h2><span class="header-section-number">10.3</span> ANOVA repeated measures</h2>
<p>Perform a repeated measures ANOVA and get posthocs</p>
<p><strong>Libraries</strong></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">&#39;yarrr&#39;</span>)) <span class="kw">install.packages</span>(<span class="st">&#39;yarrr&#39;</span>); <span class="kw">library</span>(<span class="st">&#39;yarrr&#39;</span>)
<span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">&#39;readr&#39;</span>)) <span class="kw">install.packages</span>(<span class="st">&#39;readr&#39;</span>); <span class="kw">library</span>(<span class="st">&#39;readr&#39;</span>)
<span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">&#39;dplyr&#39;</span>)) <span class="kw">install.packages</span>(<span class="st">&#39;dplyr&#39;</span>); <span class="kw">library</span>(<span class="st">&#39;dplyr&#39;</span>)
<span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">&#39;ggplot2&#39;</span>)) <span class="kw">install.packages</span>(<span class="st">&#39;ggplot2&#39;</span>); <span class="kw">library</span>(<span class="st">&#39;ggplot2&#39;</span>)
<span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">&#39;readxl&#39;</span>)) <span class="kw">install.packages</span>(<span class="st">&#39;readxl&#39;</span>); <span class="kw">library</span>(<span class="st">&#39;readxl&#39;</span>)
<span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">&#39;stringr&#39;</span>)) <span class="kw">install.packages</span>(<span class="st">&#39;stringr&#39;</span>); <span class="kw">library</span>(<span class="st">&#39;stringr&#39;</span>)
<span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">&#39;afex&#39;</span>)) <span class="kw">install.packages</span>(<span class="st">&#39;afex&#39;</span>); <span class="kw">library</span>(<span class="st">&#39;afex&#39;</span>)
<span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">&#39;emmeans&#39;</span>)) <span class="kw">install.packages</span>(<span class="st">&#39;emmeans&#39;</span>); <span class="kw">library</span>(<span class="st">&#39;emmeans&#39;</span>)</code></pre>
<p><strong>Import data</strong><br />
We use the following <a href="Data/08-Data_analysis/ANOVA_repeated_measures.xlsx">dataset</a>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Import to variable &quot;datos&quot;</span>
datos =<span class="st"> </span><span class="kw">read_excel</span>(<span class="st">&quot;Data/08-Data_analysis/ANOVA_repeated_measures.xlsx&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">ID =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">n</span>())

datos</code></pre>
<pre><code>## # A tibble: 29 x 9
##     ENDObch  ENDOacm  ENDObcm  ENDOach   EXObch   EXOacm   EXObcm   EXOach
##       &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
##  1 -1.35e-2  7.96e-3 -1.72e-3  1.24e-4  3.33e-3 -8.77e-4  3.20e-3 -2.77e-3
##  2 -7.57e-4  1.35e-4  1.09e-2 -4.40e-3  2.25e-2 -2.55e-2  5.22e-3 -6.68e-3
##  3 -2.16e-3  1.89e-3  1.40e-3  2.44e-4 -9.69e-4 -5.20e-4 -1.43e-3  1.89e-3
##  4 -2.13e-3  1.70e-3  7.95e-3 -9.56e-4  1.96e-3  1.04e-4 -3.45e-3  9.01e-4
##  5 -1.41e-3 -9.02e-4  1.16e-3 -6.91e-4 -8.55e-4 -1.73e-3 -1.36e-2  6.31e-3
##  6  3.17e-3 -1.63e-3  1.40e-3 -3.54e-3 -1.76e-3 -1.50e-3 -8.49e-6  3.57e-3
##  7 -3.44e-3 -5.72e-4 -7.02e-3  3.40e-3  1.09e-2 -5.72e-3  9.24e-3 -1.99e-3
##  8 -3.81e-3  5.49e-3  4.32e-4 -3.36e-3  9.84e-3 -1.10e-2 -4.83e-3  4.47e-3
##  9 -3.04e-4 -4.64e-4 -1.07e-2  7.58e-3 -4.67e-3  4.79e-3 -5.55e-3  3.64e-3
## 10 -1.60e-3  8.49e-4  6.95e-5  2.65e-4  4.28e-3 -3.72e-3  5.97e-3  1.57e-3
## # … with 19 more rows, and 1 more variable: ID &lt;int&gt;</code></pre>
<hr />
<p><strong>EXPERIMENT DESIGN</strong><br />
2 x 2 x 2 - Repeated measures</p>
<ul>
<li>VI1 = ENDO / EXO</li>
<li>VI2 = Temporal windows (bc - before change vs ac - after change)</li>
<li>VI3 = Percepts (h - horse vs m - morse)</li>
</ul>
<hr />
<p><strong>Prepare data</strong></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Wide to Long</span>
datos_long =<span class="st"> </span>datos <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gather</span>(Condicion, VD, <span class="dv">1</span><span class="op">:</span><span class="dv">8</span>)


<span class="co"># We extract conditions from Condicion column. Convert char variables to factor</span>
datos_long =<span class="st"> </span>datos_long <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">VI1 =</span> <span class="kw">str_sub</span>(datos_long<span class="op">$</span>Condicion, <span class="dv">1</span>,<span class="dv">3</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">VI2 =</span> 
           <span class="kw">ifelse</span>(VI1 <span class="op">==</span><span class="st"> &quot;END&quot;</span>, 
                  <span class="kw">str_sub</span>(datos_long<span class="op">$</span>Condicion, <span class="dv">5</span>,<span class="dv">6</span>), 
                  <span class="kw">str_sub</span>(datos_long<span class="op">$</span>Condicion, <span class="dv">4</span>,<span class="dv">5</span>))) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">VI3 =</span> 
           <span class="kw">ifelse</span>(VI1 <span class="op">==</span><span class="st"> &quot;END&quot;</span>, 
                  <span class="kw">str_sub</span>(datos_long<span class="op">$</span>Condicion, <span class="dv">7</span>,<span class="dv">7</span>), 
                  <span class="kw">str_sub</span>(datos_long<span class="op">$</span>Condicion, <span class="dv">6</span>,<span class="dv">6</span>))) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">VI1 =</span> <span class="kw">as.factor</span>(VI1)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">VI2 =</span> <span class="kw">as.factor</span>(VI2)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">VI3 =</span> <span class="kw">as.factor</span>(VI3)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Condicion =</span> <span class="kw">as.factor</span>(Condicion))

datos_long</code></pre>
<pre><code>## # A tibble: 232 x 6
##       ID Condicion        VD VI1   VI2   VI3  
##    &lt;int&gt; &lt;fct&gt;         &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;
##  1     1 ENDObch   -0.0135   END   bc    h    
##  2     2 ENDObch   -0.000757 END   bc    h    
##  3     3 ENDObch   -0.00216  END   bc    h    
##  4     4 ENDObch   -0.00213  END   bc    h    
##  5     5 ENDObch   -0.00141  END   bc    h    
##  6     6 ENDObch    0.00317  END   bc    h    
##  7     7 ENDObch   -0.00344  END   bc    h    
##  8     8 ENDObch   -0.00381  END   bc    h    
##  9     9 ENDObch   -0.000304 END   bc    h    
## 10    10 ENDObch   -0.00160  END   bc    h    
## # … with 222 more rows</code></pre>
<p>Repeated measures ANOVA</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># AFEX PACKAGE</span>
<span class="co"># https://cran.r-project.org/web/packages/afex/afex.pdf</span>

a =<span class="st"> </span><span class="kw">aov_ez</span>(<span class="st">&quot;ID&quot;</span>, <span class="st">&quot;VD&quot;</span>, datos_long,
           <span class="dt">within =</span> <span class="kw">c</span>(<span class="st">&quot;VI1&quot;</span>, <span class="st">&quot;VI2&quot;</span>, <span class="st">&quot;VI3&quot;</span>))

<span class="co"># Show results</span>
<span class="kw">summary</span>(a)</code></pre>
<pre><code>## 
## Univariate Type III Repeated-Measures ANOVA Assuming Sphericity
## 
##                 Sum Sq num Df   Error SS den Df F value   Pr(&gt;F)   
## (Intercept) 0.00000013      1 0.00014494     28  0.0251 0.875310   
## VI1         0.00001238      1 0.00022796     28  1.5210 0.227715   
## VI2         0.00001502      1 0.00147081     28  0.2859 0.597112   
## VI3         0.00004282      1 0.00089968     28  1.3327 0.258083   
## VI1:VI2     0.00045494      1 0.00125821     28 10.1241 0.003565 **
## VI1:VI3     0.00028700      1 0.00113938     28  7.0531 0.012911 * 
## VI2:VI3     0.00000883      1 0.00010388     28  2.3811 0.134039   
## VI1:VI2:VI3 0.00000323      1 0.00015865     28  0.5709 0.456198   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Plot results</span>
emmeans<span class="op">::</span><span class="kw">lsmip</span>(a, VI1 <span class="op">~</span><span class="st"> </span>VI2 <span class="op">*</span><span class="st"> </span>VI3)</code></pre>
<p><img src="_main_files/figure-html/anova_afex_repeated_measures-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pirateplot</span>(VD <span class="op">~</span><span class="st"> </span>VI1 <span class="op">*</span><span class="st"> </span>VI2 <span class="op">*</span><span class="st"> </span>VI3, datos_long)</code></pre>
<p><img src="_main_files/figure-html/anova_afex_repeated_measures-2.png" width="672" /></p>
<p>Post-hocs</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lsmeans</span>(a, <span class="kw">c</span>(<span class="st">&quot;VI1&quot;</span>, <span class="st">&quot;VI2&quot;</span>, <span class="st">&quot;VI3&quot;</span>), <span class="dt">contr =</span> <span class="st">&quot;pairwise&quot;</span>)</code></pre>
<pre><code>## $lsmeans
##  VI1 VI2 VI3    lsmean       SE  df  lower.CL  upper.CL
##  END ac  h    1.71e-04 0.000912 137 -0.001632  0.001975
##  EXO ac  h   -1.79e-04 0.000912 137 -0.001982  0.001625
##  END bc  h   -3.76e-03 0.000912 137 -0.005568 -0.001961
##  EXO bc  h    1.96e-03 0.000912 137  0.000155  0.003762
##  END ac  m    2.63e-03 0.000912 137  0.000825  0.004432
##  EXO ac  m   -1.70e-03 0.000912 137 -0.003502  0.000105
##  END bc  m   -5.43e-05 0.000912 137 -0.001858  0.001749
##  EXO bc  m    7.48e-04 0.000912 137 -0.001056  0.002551
## 
## Warning: EMMs are biased unless design is perfectly balanced 
## Confidence level used: 0.95 
## 
## $contrasts
##  contrast             estimate      SE    df t.ratio p.value
##  END,ac,h - EXO,ac,h  0.000350 0.00131  73.4  0.268  1.0000 
##  END,ac,h - END,bc,h  0.003936 0.00136  66.2  2.900  0.0890 
##  END,ac,h - EXO,bc,h -0.001787 0.00135  68.8 -1.328  0.8850 
##  END,ac,h - END,ac,m -0.002457 0.00119  69.2 -2.064  0.4479 
##  END,ac,h - EXO,ac,m  0.001870 0.00124  70.7  1.510  0.7996 
##  END,ac,h - END,bc,m  0.000226 0.00171 108.7  0.132  1.0000 
##  END,ac,h - EXO,bc,m -0.000576 0.00130  69.8 -0.442  0.9998 
##  EXO,ac,h - END,bc,h  0.003586 0.00135  68.8  2.664  0.1517 
##  EXO,ac,h - EXO,bc,h -0.002138 0.00136  66.2 -1.575  0.7631 
##  EXO,ac,h - END,ac,m -0.002808 0.00124  70.7 -2.268  0.3259 
##  EXO,ac,h - EXO,ac,m  0.001519 0.00119  69.2  1.276  0.9045 
##  EXO,ac,h - END,bc,m -0.000125 0.00130  69.8 -0.096  1.0000 
##  EXO,ac,h - EXO,bc,m -0.000927 0.00171 108.7 -0.541  0.9994 
##  END,bc,h - EXO,bc,h -0.005723 0.00131  73.4 -4.371  0.0010 
##  END,bc,h - END,ac,m -0.006393 0.00171 108.7 -3.731  0.0071 
##  END,bc,h - EXO,ac,m -0.002066 0.00130  69.8 -1.586  0.7570 
##  END,bc,h - END,bc,m -0.003710 0.00119  69.2 -3.117  0.0512 
##  END,bc,h - EXO,bc,m -0.004512 0.00124  70.7 -3.644  0.0113 
##  EXO,bc,h - END,ac,m -0.000670 0.00130  69.8 -0.514  0.9996 
##  EXO,bc,h - EXO,ac,m  0.003657 0.00171 108.7  2.134  0.4000 
##  EXO,bc,h - END,bc,m  0.002013 0.00124  70.7  1.626  0.7332 
##  EXO,bc,h - EXO,bc,m  0.001211 0.00119  69.2  1.017  0.9703 
##  END,ac,m - EXO,ac,m  0.004327 0.00131  73.4  3.305  0.0302 
##  END,ac,m - END,bc,m  0.002683 0.00136  66.2  1.977  0.5049 
##  END,ac,m - EXO,bc,m  0.001881 0.00135  68.8  1.397  0.8553 
##  EXO,ac,m - END,bc,m -0.001644 0.00135  68.8 -1.221  0.9228 
##  EXO,ac,m - EXO,bc,m -0.002446 0.00136  66.2 -1.802  0.6209 
##  END,bc,m - EXO,bc,m -0.000802 0.00131  73.4 -0.613  0.9986 
## 
## P value adjustment: tukey method for comparing a family of 8 estimates</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lsmeans</span>(a, <span class="st">&quot;VI1&quot;</span>, <span class="dt">contr =</span> <span class="st">&quot;pairwise&quot;</span>)</code></pre>
<pre><code>## NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre><code>## $lsmeans
##  VI1    lsmean      SE   df  lower.CL upper.CL
##  END -0.000255 0.00024 53.4 -0.000735 0.000226
##  EXO  0.000207 0.00024 53.4 -0.000273 0.000688
## 
## Results are averaged over the levels of: VI2, VI3 
## Warning: EMMs are biased unless design is perfectly balanced 
## Confidence level used: 0.95 
## 
## $contrasts
##  contrast   estimate       SE df t.ratio p.value
##  END - EXO -0.000462 0.000375 28 -1.233  0.2277 
## 
## Results are averaged over the levels of: VI2, VI3</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lsmeans</span>(a, <span class="st">&quot;VI2&quot;</span>, <span class="dt">contr =</span> <span class="st">&quot;pairwise&quot;</span>)</code></pre>
<pre><code>## NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre><code>## $lsmeans
##  VI2    lsmean       SE   df  lower.CL upper.CL
##  ac   0.000231 0.000499 33.5 -0.000783 0.001245
##  bc  -0.000278 0.000499 33.5 -0.001292 0.000736
## 
## Results are averaged over the levels of: VI1, VI3 
## Warning: EMMs are biased unless design is perfectly balanced 
## Confidence level used: 0.95 
## 
## $contrasts
##  contrast estimate       SE df t.ratio p.value
##  ac - bc  0.000509 0.000952 28 0.535   0.5971 
## 
## Results are averaged over the levels of: VI1, VI3</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lsmeans</span>(a, <span class="st">&quot;VI3&quot;</span>, <span class="dt">contr =</span> <span class="st">&quot;pairwise&quot;</span>)</code></pre>
<pre><code>## NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre><code>## $lsmeans
##  VI3    lsmean       SE   df  lower.CL upper.CL
##  h   -0.000453 0.000401 36.8 -0.001266 0.000359
##  m    0.000406 0.000401 36.8 -0.000407 0.001219
## 
## Results are averaged over the levels of: VI1, VI2 
## Warning: EMMs are biased unless design is perfectly balanced 
## Confidence level used: 0.95 
## 
## $contrasts
##  contrast  estimate       SE df t.ratio p.value
##  h - m    -0.000859 0.000744 28 -1.154  0.2581 
## 
## Results are averaged over the levels of: VI1, VI2</code></pre>

</div>
<div id="mixed-models" class="section level2">
<h2><span class="header-section-number">10.4</span> Mixed Models</h2>
<p><a href="http://mfviz.com/hierarchical-models/" class="uri">http://mfviz.com/hierarchical-models/</a></p>

</div>
<div id="meta-analysis" class="section level2">
<h2><span class="header-section-number">10.5</span> Meta analysis</h2>
<p>Code adapted from an example sent by Miro on 20170509</p>
<hr />
<p>Meta-analysis of Brase, G. L., &amp; Hill, W. T. (2017). Adding up to good Bayesian reasoning: Problem format manipulations and individual skill differences. Journal of Experimental Psychology: General, 146(4), 577–591. <a href="http://doi.org/10.1037/xge0000280" class="uri">http://doi.org/10.1037/xge0000280</a></p>
<hr />
<p><strong>Factorial 2x2 design (aggreagted data from Experiment1 &amp; Experiment2)</strong></p>
<p>IV1: Representation format (Natural Frequencies x Probabilities)<br />
IV2: Pictorial aid (No pictorial aid x Pictorial aid)</p>
<p>Experiment1
<img src="Images/Data_analysis/Meta_analysis/Brase_Experiment_1.png" /></p>
<p>Experiment2
<img src="Images/Data_analysis/Meta_analysis/Brase_Experiment_2.png" /></p>
<p><strong>Libraries</strong></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">&#39;metafor&#39;</span>)) <span class="kw">install.packages</span>(<span class="st">&#39;metafor&#39;</span>); <span class="kw">library</span>(<span class="st">&#39;metafor&#39;</span>)</code></pre>
<div id="natural-frequencies-effect" class="section level3">
<h3><span class="header-section-number">10.5.1</span> Natural Frequencies Effect</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># input of the data from the two experiments, each is featuring two comparison (note: ai to di are corresponding to the 2x2 table, n1i and n2i are row sums)</span>

Contrast =<span class="st"> &quot;NF - Perc&quot;</span>
Comparisons =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Exp 1a No Picture&quot;</span>, <span class="st">&quot;Exp 1b Picture&quot;</span>, <span class="st">&quot;Exp 2a No Picture&quot;</span>,<span class="st">&quot;Exp 2b Picture&quot;</span>)

<span class="co"># NF with and without pictures</span>
<span class="co"># E1_NF, E1_NF+Pic, E2_NF, E2_NF+Pic</span>
<span class="co"># (84*.373, 85*.416, 172*.419, 186*.484)</span>
ai &lt;-<span class="st">  </span><span class="kw">c</span>(<span class="dv">31</span>, <span class="dv">35</span>, <span class="dv">72</span>, <span class="dv">90</span>)
n1i &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">84</span>, <span class="dv">85</span>, <span class="dv">172</span>, <span class="dv">186</span>)
bi &lt;-<span class="st"> </span>n1i<span class="op">-</span><span class="st"> </span>ai <span class="co"># c(53, 50, 100, 96)</span>

<span class="co"># Prob with and without pictures</span>
<span class="co"># E1_Perc, E1_Perc+Pic, E2_Perc, E2_Perc+Pic</span>
<span class="co"># (83*.049, 84*.194, 172*.087, 181*.265)</span>
ci &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">16</span>, <span class="dv">15</span>, <span class="dv">48</span>)
n2i &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">83</span>, <span class="dv">84</span>, <span class="dv">172</span>, <span class="dv">181</span>)
di &lt;-<span class="st"> </span>n2i <span class="op">-</span><span class="st"> </span>ci <span class="co"># di &lt;- c(79, 68, 157, 133)</span>

<span class="co"># mod &lt;- c(0, 1, 0, 1)</span>

<span class="co"># fit the fixed model and return its value for OR</span>
rma.overallOR &lt;-<span class="st"> </span><span class="kw">rma.uni</span>(<span class="dt">ai=</span>ai, <span class="dt">bi=</span>bi, <span class="dt">ci=</span>ci, <span class="dt">di=</span>di, <span class="dt">n1i=</span>n1i, <span class="dt">n2i=</span>n2i, <span class="dt">measure=</span><span class="st">&quot;OR&quot;</span>, 
                         <span class="dt">method=</span><span class="st">&quot;REML&quot;</span>, <span class="dt">weighted=</span><span class="ot">TRUE</span>,
                         <span class="dt">level=</span><span class="dv">95</span>, <span class="dt">digits=</span><span class="dv">3</span>)

<span class="kw">summary</span>(rma.overallOR)</code></pre>
<pre><code>## 
## Random-Effects Model (k = 4; tau^2 estimator: REML)
## 
##   logLik  deviance       AIC       BIC      AICc 
##   -3.205     6.410    10.410     8.607    22.410   
## 
## tau^2 (estimated amount of total heterogeneity): 0.339 (SE = 0.382)
## tau (square root of estimated tau^2 value):      0.583
## I^2 (total heterogeneity / total variability):   75.66%
## H^2 (total variability / sampling variability):  4.11
## 
## Test for Heterogeneity:
## Q(df = 3) = 12.128, p-val = 0.007
## 
## Model Results:
## 
## estimate     se   zval   pval  ci.lb  ci.ub 
##    1.542  0.342  4.507  &lt;.001  0.871  2.213  *** 
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># rma.overallOR</span>

<span class="kw">forest</span>(rma.overallOR, 
       <span class="dt">showweight =</span> <span class="ot">TRUE</span>,
       <span class="dt">slab=</span>Comparisons, 
       <span class="dt">xlab=</span><span class="st">&quot;Log Odds Ratio&quot;</span>, <span class="dt">mlab=</span><span class="st">&quot;FE Model for All Comparisons&quot;</span>, <span class="dt">main =</span> Contrast )</code></pre>
<p><img src="_main_files/figure-html/08-10-Meta_analysis-2-1.png" width="672" /></p>
</div>
<div id="pictures-effect" class="section level3">
<h3><span class="header-section-number">10.5.2</span> Pictures Effect</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># input of the data from the two experiments, each is featuring two comparison (note: ai to di are corresponding to the 2x2 table, n1i and n2i are row sums)</span>
<span class="co"># Here we use the parameter mod to assess moderation (???)</span>

Contrast =<span class="st"> &quot;Pictures - No pictures&quot;</span>
Comparisons =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Exp 1a Perc&quot;</span>, <span class="st">&quot;Exp 1b NF&quot;</span>, <span class="st">&quot;Exp 2a Perc&quot;</span>,<span class="st">&quot;Exp 2b NF&quot;</span>)


<span class="co"># Prob and  NF with Pictures</span>
<span class="co"># E1_Perc+Pic, E1_NF+Pic, E2_Perc+Pic, E2_NF+Pic</span>
<span class="co"># (84*.194,   85*.416,  181*.265, 186*.484)</span>
ai &lt;-<span class="st">  </span><span class="kw">c</span>(<span class="dv">16</span>, <span class="dv">35</span>, <span class="dv">48</span>, <span class="dv">90</span>)
n1i &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">84</span>, <span class="dv">85</span>, <span class="dv">181</span>, <span class="dv">186</span>)
bi &lt;-<span class="st"> </span>n1i<span class="op">-</span><span class="st"> </span>ai <span class="co"># bi &lt;- c(68, 50, 133, 96)</span>

<span class="co"># Prob and  NF without Pictures</span>
<span class="co"># E1_Perc, E1_NF, E2_Perc , E2_NF</span>
<span class="co"># (83*.049,   84*.373,  172*.087, 172*.419)</span>
ci &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">31</span>, <span class="dv">15</span>, <span class="dv">72</span>)
n2i &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">83</span>, <span class="dv">84</span>, <span class="dv">172</span>, <span class="dv">172</span>)
di &lt;-<span class="st"> </span>n2i <span class="op">-</span><span class="st"> </span>ci <span class="co"># di &lt;- c(79, 53, 157, 100)</span>


mod &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)

<span class="co"># fit the fixed model and return its value for OR</span>
  <span class="co"># Here we use the moderator mod</span>
rma.overallOR &lt;-<span class="st"> </span><span class="kw">rma.uni</span>(<span class="dt">ai=</span>ai, <span class="dt">bi=</span>bi, <span class="dt">ci=</span>ci, <span class="dt">di=</span>di, <span class="dt">n1i=</span>n1i, <span class="dt">n2i=</span>n2i, <span class="dt">mod=</span>mod, <span class="dt">measure=</span><span class="st">&quot;OR&quot;</span>, 
                         <span class="dt">method=</span><span class="st">&quot;REML&quot;</span>, <span class="dt">weighted=</span>T,
                         <span class="dt">level=</span><span class="dv">95</span>, <span class="dt">digits=</span><span class="dv">3</span>)

<span class="kw">summary</span>(rma.overallOR)</code></pre>
<pre><code>## 
## Mixed-Effects Model (k = 4; tau^2 estimator: REML)
## 
##   logLik  deviance       AIC       BIC      AICc 
##    0.156    -0.313     5.687     1.767    29.687   
## 
## tau^2 (estimated amount of residual heterogeneity):     0 (SE = 0.097)
## tau (square root of estimated tau^2 value):             0
## I^2 (residual heterogeneity / unaccounted variability): 0.00%
## H^2 (unaccounted variability / sampling variability):   1.00
## R^2 (amount of heterogeneity accounted for):            100.00%
## 
## Test for Residual Heterogeneity:
## QE(df = 2) = 0.146, p-val = 0.929
## 
## Test of Moderators (coefficient 2):
## QM(df = 1) = 11.872, p-val &lt; .001
## 
## Model Results:
## 
##          estimate     se    zval   pval   ci.lb   ci.ub 
## intrcpt     1.377  0.279   4.926  &lt;.001   0.829   1.924  *** 
## mods       -1.139  0.331  -3.446  &lt;.001  -1.787  -0.491  *** 
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># rma.overallOR</span>

<span class="kw">forest</span>(rma.overallOR, 
       <span class="dt">showweight =</span> <span class="ot">TRUE</span>,
       <span class="dt">slab=</span> Comparisons, 
       <span class="dt">xlab=</span><span class="st">&quot;Log Odds Ratio&quot;</span>, <span class="dt">mlab=</span><span class="st">&quot;REML Model for All Comparisons&quot;</span>, <span class="dt">main =</span> Contrast)</code></pre>
<p><img src="_main_files/figure-html/08-10-Meta_analysis-3-1.png" width="672" /></p>
</div>
<div id="notes-on-meta-analysis" class="section level3">
<h3><span class="header-section-number">10.5.3</span> Notes on Meta-analysis</h3>
<p><a href="http://www.nicebread.de/meta-showdown-1/" class="uri">http://www.nicebread.de/meta-showdown-1/</a></p>

</div>
</div>
<div id="roc-curves" class="section level2">
<h2><span class="header-section-number">10.6</span> ROC Curves</h2>
<p>Code from <a href="https://github.com/dariyasydykova/tidyroc" class="uri">https://github.com/dariyasydykova/tidyroc</a> README</p>
<p>tidyroc won’t be developed further. It seems <a href="https://github.com/tidymodels/yardstick" class="uri">https://github.com/tidymodels/yardstick</a> does everything tidyroc does and more?</p>
<p>Intro about what ROC curves measure: <a href="https://twitter.com/cecilejanssens/status/1104134423673479169?s=03" class="uri">https://twitter.com/cecilejanssens/status/1104134423673479169?s=03</a></p>
<p>Why ROC curves are misleading: <a href="http://www.fharrell.com/post/mlconfusion/" class="uri">http://www.fharrell.com/post/mlconfusion/</a> (Not useful for prediction. PPV/NPV better).</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">&#39;tidyroc&#39;</span>)) remotes<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;dariyasydykova/tidyroc&quot;</span>); <span class="kw">library</span>(<span class="st">&#39;tidyroc&#39;</span>)
<span class="co"># remotes::install_github(&quot;dariyasydykova/tidyroc&quot;)</span>

  <span class="kw">library</span>(dplyr)
  <span class="kw">library</span>(ggplot2)
  <span class="kw">library</span>(broom)
  <span class="kw">library</span>(tidyroc)

  <span class="kw">glm</span>(am <span class="op">~</span><span class="st"> </span>disp,
      <span class="dt">family =</span> binomial,
      <span class="dt">data =</span> mtcars
  ) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">augment</span>() <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">make_roc</span>(<span class="dt">predictor =</span> .fitted, <span class="dt">known_class =</span> am) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> fpr, <span class="dt">y =</span> tpr)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">theme_minimal</span>()</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">  <span class="co"># load tidyverse packages</span>
  <span class="kw">library</span>(dplyr)
  <span class="kw">library</span>(ggplot2)
  <span class="kw">library</span>(broom)

  <span class="co"># load cowplot to change plot theme</span>
  <span class="kw">library</span>(cowplot)

  <span class="co"># load tidyroc</span>
  <span class="kw">library</span>(tidyroc)


  <span class="co"># get `biopsy` dataset from `MASS`</span>
  <span class="kw">data</span>(biopsy, <span class="dt">package =</span> <span class="st">&quot;MASS&quot;</span>)

  <span class="co"># change column names from `V1`, `V2`, etc. to informative variable names</span>
  <span class="kw">colnames</span>(biopsy) &lt;-
<span class="st">    </span><span class="kw">c</span>(<span class="st">&quot;ID&quot;</span>,
      <span class="st">&quot;clump_thickness&quot;</span>,
      <span class="st">&quot;uniform_cell_size&quot;</span>,
      <span class="st">&quot;uniform_cell_shape&quot;</span>,
      <span class="st">&quot;marg_adhesion&quot;</span>,
      <span class="st">&quot;epithelial_cell_size&quot;</span>,
      <span class="st">&quot;bare_nuclei&quot;</span>,
      <span class="st">&quot;bland_chromatin&quot;</span>,
      <span class="st">&quot;normal_nucleoli&quot;</span>,
      <span class="st">&quot;mitoses&quot;</span>,
      <span class="st">&quot;outcome&quot;</span>)

  <span class="co"># fit a logistic regression model to predict tumor types</span>
  glm_out1 &lt;-<span class="st"> </span><span class="kw">glm</span>(
    <span class="dt">formula =</span> outcome <span class="op">~</span><span class="st"> </span>clump_thickness <span class="op">+</span><span class="st"> </span>uniform_cell_shape <span class="op">+</span><span class="st"> </span>marg_adhesion <span class="op">+</span><span class="st"> </span>bare_nuclei <span class="op">+</span><span class="st"> </span>bland_chromatin <span class="op">+</span><span class="st"> </span>normal_nucleoli,
    <span class="dt">family =</span> binomial,
    <span class="dt">data =</span> biopsy
  ) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">augment</span>() <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">model =</span> <span class="st">&quot;m1&quot;</span>) <span class="co"># name the model</span>

  <span class="co"># fit a different logistic regression model to predict tumor types</span>
  glm_out2 &lt;-<span class="st"> </span><span class="kw">glm</span>(outcome <span class="op">~</span><span class="st"> </span>clump_thickness,
                  <span class="dt">family =</span> binomial,
                  <span class="dt">data =</span> biopsy
  ) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">augment</span>() <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">model =</span> <span class="st">&quot;m2&quot;</span>) <span class="co"># name the model</span>

  <span class="co"># combine the two datasets to make an ROC curve for each model</span>
  glm_out &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(glm_out1, glm_out2)

  <span class="co"># plot the distribution of fitted values to see both models&#39; outcomes</span>
  glm_out <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> .fitted, <span class="dt">fill =</span> outcome)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="fl">0.6</span>, <span class="dt">color =</span> <span class="ot">NA</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#F08A5D&quot;</span>, <span class="st">&quot;#B83B5E&quot;</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>model)


  <span class="co"># plot ROC curves</span>
  glm_out <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">group_by</span>(model) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># group to get individual ROC curve for each model</span>
<span class="st">    </span><span class="kw">make_roc</span>(<span class="dt">predictor =</span> .fitted, <span class="dt">known_class =</span> outcome) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># get values to plot an ROC curve</span>
<span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> fpr, <span class="dt">y =</span> tpr, <span class="dt">color =</span> model)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">1.1</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_abline</span>(<span class="dt">slope =</span> <span class="dv">1</span>, <span class="dt">intercept =</span> <span class="dv">0</span>, <span class="dt">size =</span> <span class="fl">0.4</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#48466D&quot;</span>, <span class="st">&quot;#3D84A8&quot;</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme_cowplot</span>()


  <span class="co"># plot precision-recall curves using the data-frame we generated in the previous example</span>
  glm_out <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">group_by</span>(model) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># group to get individual precision-recall curve for each model</span>
<span class="st">    </span><span class="kw">make_pr</span>(<span class="dt">predictor =</span> .fitted, <span class="dt">known_class =</span> outcome) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># get values to plot a precision-recall curve</span>
<span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> recall, <span class="dt">y =</span> precision, <span class="dt">color =</span> model)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">1.1</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#48466D&quot;</span>, <span class="st">&quot;#3D84A8&quot;</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme_cowplot</span>()

  glm_out <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">group_by</span>(model) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># group to get individual AUC values for each ROC curve</span>
<span class="st">    </span><span class="kw">make_roc</span>(<span class="dt">predictor =</span> .fitted, <span class="dt">known_class =</span> outcome) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">summarise</span>(<span class="dt">auc =</span> <span class="kw">calc_auc</span>(<span class="dt">x =</span> fpr, <span class="dt">y =</span> tpr))

  <span class="co">## # A tibble: 2 x 2</span>
  <span class="co">##   model   auc</span>
  <span class="co">##   &lt;chr&gt; &lt;dbl&gt;</span>
  <span class="co">## 1 m1    0.996</span>
  <span class="co">## 2 m2    0.910</span>

  glm_out <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">group_by</span>(model) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># group to get individual AUC values for each precision-recall curve</span>
<span class="st">    </span><span class="kw">make_pr</span>(<span class="dt">predictor =</span> .fitted, <span class="dt">known_class =</span> outcome) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">summarise</span>(<span class="dt">auc =</span> <span class="kw">calc_auc</span>(<span class="dt">x =</span> recall, <span class="dt">y =</span> precision))

  <span class="co">## # A tibble: 2 x 2</span>
  <span class="co">##   model   auc</span>
  <span class="co">##   &lt;chr&gt; &lt;dbl&gt;</span>
  <span class="co">## 1 m1    0.991</span>
  <span class="co">## 2 m2    0.951</span></code></pre>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>Leys, C., Ley, C., Klein, O., Bernard, P. &amp; Licata, L. Detecting outliers: Do not use standard deviation around the mean, use absolute deviation around the median. J. Exp. Soc. Psychol. 49, 764–766 (2013).<a href="Estadistica-inferencial.html#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p><a href="https://www.researchgate.net/post/For_decision_times_do_you_first_take_the_logarithm_and_then_exclude_extreme_outliers_or_the_other_way_around_And_how_do_you_define_outliers">See <strong>Serban C. Musca</strong> post</a><a href="Estadistica-inferencial.html#fnref2" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Estadistica-descriptiva.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Funciones.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
